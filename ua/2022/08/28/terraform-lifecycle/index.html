<!doctype html><html lang=ua><head><title>Terraform Lifecycle and Outputs :: Maksym Postument</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Sixth article in series about terraform. In this article i will show how to use lifecycle and outputs in terraform"><meta name=keywords content="VSCode,Devops,Terraform,HashiCorp,Beginner,EC2,LifeCycle,Depends,DependsOn,Outputs"><meta name=robots content="noodp"><link rel=canonical href=https://mpostument.com/ua/2022/08/28/terraform-lifecycle/><script async src="https://www.googletagmanager.com/gtag/js?id=G-SBRJXS94DC"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-SBRJXS94DC",{anonymize_ip:!1})}</script><link rel=stylesheet href=https://mpostument.com/assets/style.css><link rel=stylesheet href=https://mpostument.com/assets/blue.css><link rel=apple-touch-icon href=https://mpostument.com/img/apple-touch-icon-192x192.png><link rel="shortcut icon" href=https://mpostument.com/img/favicon/blue.png><meta name=twitter:card content="summary"><meta name=twitter:site content="mpostument.com"><meta name=twitter:creator content="Maks_Postument"><meta property="og:locale" content="ua"><meta property="og:type" content="article"><meta property="og:title" content="Terraform Lifecycle and Outputs"><meta property="og:description" content="Sixth article in series about terraform. In this article i will show how to use lifecycle and outputs in terraform"><meta property="og:url" content="https://mpostument.com/ua/2022/08/28/terraform-lifecycle/"><meta property="og:site_name" content="Maksym Postument"><meta property="og:image" content="https://i.imgur.com/a9XOL3j.jpg"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><meta property="article:section" content="Devops"><meta property="article:section" content="Terraform"><meta property="article:section" content="Beginner"><meta property="article:section" content="AWS"><meta property="article:published_time" content="2022-08-28 21:22:25 +0300 +0300"><p align=center style=background-color:#23b0ff>Sign up for my <a href=https://tinyletter.com/mpostument>email newsletter</a> or use this <a href=/index.xml>RSS feed</a> to get notified of new blog posts.</p></head><body class=blue><div class="container center headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/ua><div class=logo>mpostument.com</div></a></div><div class=menu-trigger>menu</div></div><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=/ua>Home</a></li><li><a href=/ua/categories/>Categories</a></li><li><a href=/ua/tags/>Tags</a></li><div class=spacer></div><ul class=language-selector><ul class=language-selector-current><li>Ukraine ▾</li></ul><ul class="language-selector__more hidden"><li><a href=https://mpostument.com/>English</a></li><li><a href=https://mpostument.com/ua/>Ukraine</a></li></ul></ul></ul><ul class="menu__inner menu__inner--mobile"><li><a href=/ua>Home</a></li><li><a href=/ua/categories/>Categories</a></li><li><a href=/ua/tags/>Tags</a></li><hr><li><a href=https://mpostument.com/>English</a></li><li><a href=https://mpostument.com/ua/>Ukraine</a></li></ul></nav></header><div class=content><div class=post><h1 class=post-title><a href=https://mpostument.com/ua/2022/08/28/terraform-lifecycle/>Terraform Lifecycle and Outputs</a></h1><div class=post-meta><span class=post-date>2022-08-28</span>
<span class=post-author>:: Maksym Postument</span>
<span class=post-reading-time>:: 8 min read (1625 words)</span></div><span class=post-tags>#<a href=https://mpostument.com/ua/tags/vscode/>VSCode</a>&nbsp;
#<a href=https://mpostument.com/ua/tags/devops/>Devops</a>&nbsp;
#<a href=https://mpostument.com/ua/tags/terraform/>Terraform</a>&nbsp;
#<a href=https://mpostument.com/ua/tags/tfenv/>tfenv</a>&nbsp;
#<a href=https://mpostument.com/ua/tags/hashicorp/>HashiCorp</a>&nbsp;
#<a href=https://mpostument.com/ua/tags/beginner/>Beginner</a>&nbsp;
#<a href=https://mpostument.com/ua/tags/aws/>AWS</a>&nbsp;</span>
<img src=https://i.imgur.com/a9XOL3j.jpg class=post-cover alt="Terraform Lifecycle and Outputs" title="Cover Image"><div class=post-content><div><p><a href=https://mpostument.com/ua/2022/07/26/terraform-install/ title="Part 1 - Terraform Install">Part 1 - Terraform Install</a><br><a href=https://mpostument.com/ua/2022/07/28/terraform-basics/ title="Part 2 - Terraform Basics">Part 2 - Terraform Basics</a><br><a href=https://mpostument.com/ua/2022/07/31/terraform-state/ title="Part 3 - Terraform State">Part 3 - Terraform State</a><br><a href=https://mpostument.com/ua/2022/08/11/terraform-template/ title="Part 4 - Terraform Template">Part 4 - Terraform Template</a><br><a href=https://mpostument.com/ua/2022/08/22/terraform-dynamic/ title="Part 5 - Terraform Dynamic">Part 5 - Terraform Dynamic</a></p><p>Привіт!</p><p>Сьогодні розкажу про lifecycle, depends_on та outputs в terraform.</p><h2 id=lifecycle>Lifecycle<a href=#lifecycle class=hanchor arialabel=Anchor>&#8983;</a></h2><h3 id=create_before_destroy>create_before_destroy<a href=#create_before_destroy class=hanchor arialabel=Anchor>&#8983;</a></h3><p>Lifecycle є мета параметром які підтримує більшість ресурсів. І за допомогою нього можна контролювати поведінку при створенні/видаленні ресурсів.<br>Візьму terraform код створення ec2 з одного з попередніх постів і додам в нього блок lifecycle. В середині вкажу <code>create_before_destroy = true</code>. Тепер при якщо я внесу зміни які вимагатимуть перестворення ec2 то спочатку terraform створить новий сервер і тільки після того видалить старий.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-terraform data-lang=terraform><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;aws_instance&#34;</span> <span style=color:#e6db74>&#34;foo&#34;</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>ami</span>                    = <span style=color:#e6db74>&#34;ami-0cff7528ff583bf9a&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>instance_type</span>          = <span style=color:#e6db74>&#34;t2.micro&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>subnet_id</span>              = <span style=color:#e6db74>&#34;subnet-222a93327f9a744ed&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>vpc_security_group_ids</span> = [<span style=color:#e6db74>&#34;sg-2220a119757753b6e&#34;</span>]
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>tags</span> = {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Env</span> = <span style=color:#e6db74>&#34;Dev&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>volume_tags</span> = {
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Env&#34;</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Dev&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>lifecycle</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>create_before_destroy</span> = <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>Plan: <span style=color:#ae81ff>1</span> to add, <span style=color:#ae81ff>0</span> to change, <span style=color:#ae81ff>1</span> to destroy.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Do you want to perform these actions?
</span></span><span style=display:flex><span>  Terraform will perform the actions described above.
</span></span><span style=display:flex><span>  Only <span style=color:#e6db74>&#39;yes&#39;</span> will be accepted to approve.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  Enter a value: yes
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>aws_instance.foo: Creating...
</span></span><span style=display:flex><span>aws_instance.foo: Still creating... <span style=color:#f92672>[</span>10s elapsed<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>aws_instance.foo: Still creating... <span style=color:#f92672>[</span>20s elapsed<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>aws_instance.foo: Still creating... <span style=color:#f92672>[</span>30s elapsed<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>aws_instance.foo: Creation complete after 34s <span style=color:#f92672>[</span>id<span style=color:#f92672>=</span>i-0c9601ce9bd144f5e<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>aws_instance.foo <span style=color:#f92672>(</span>deposed object aba959f0<span style=color:#f92672>)</span>: Destroying... <span style=color:#f92672>[</span>id<span style=color:#f92672>=</span>i-082a6b3816e202929<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>aws_instance.foo: Still destroying... <span style=color:#f92672>[</span>id<span style=color:#f92672>=</span>i-082a6b3816e202929, 10s elapsed<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>aws_instance.foo: Still destroying... <span style=color:#f92672>[</span>id<span style=color:#f92672>=</span>i-082a6b3816e202929, 20s elapsed<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>aws_instance.foo: Still destroying... <span style=color:#f92672>[</span>id<span style=color:#f92672>=</span>i-082a6b3816e202929, 30s elapsed<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>aws_instance.foo: Destruction complete after 31s
</span></span></code></pre></div><h3 id=prevent_destroy>prevent_destroy<a href=#prevent_destroy class=hanchor arialabel=Anchor>&#8983;</a></h3><p>Наступний параметр це <code>prevent_destroy</code>. Якщо він вказаний то terraform не зможе видалити ресурс в якому вказано prevent_<code>destroy = true</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-terraform data-lang=terraform><span style=display:flex><span>  <span style=color:#a6e22e>lifecycle</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>prevent_destroy</span> = <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>  }
</span></span></code></pre></div><p>Одразу отримаю помилку так як перестворити ресурс не можливо.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>terraform apply
</span></span><span style=display:flex><span>aws_instance.foo: Refreshing state... <span style=color:#f92672>[</span>id<span style=color:#f92672>=</span>i-0c9601ce9bd144f5e<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>╷
</span></span><span style=display:flex><span>│ Error: Instance cannot be destroyed
</span></span><span style=display:flex><span>│ 
</span></span><span style=display:flex><span>│   on main.tf line 1:
</span></span><span style=display:flex><span>│    1: resource <span style=color:#e6db74>&#34;aws_instance&#34;</span> <span style=color:#e6db74>&#34;foo&#34;</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>│ 
</span></span><span style=display:flex><span>│ Resource aws_instance.foo has lifecycle.prevent_destroy set, but the plan calls <span style=color:#66d9ef>for</span> this resource to be destroyed. To avoid this error and <span style=color:#66d9ef>continue</span> with the plan, either disable lifecycle.prevent_destroy or reduce the
</span></span><span style=display:flex><span>│ scope of the plan using the -target flag.
</span></span></code></pre></div><h2 id=ignore_changes>ignore_changes<a href=#ignore_changes class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Наступний параметр це <code>ignore_changes</code>. В нього передається список параметрів ресурса які terraform має проігнорувати. Наприклад вийшла нова версія AMI для EC2 але зараз для якогось сервера міняти її не потрібно оскільки змінна AMI вимагає перестворення сервера. В такому випадку я можу вказати щоб terraform ігнорував змінну AMI</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-terraform data-lang=terraform><span style=display:flex><span>  <span style=color:#a6e22e>lifecycle</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>ignore_changes</span> = [
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>ami</span>
</span></span><span style=display:flex><span>    ]
</span></span><span style=display:flex><span>  }
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>terraform plan
</span></span><span style=display:flex><span>aws_instance.foo: Refreshing state... <span style=color:#f92672>[</span>id<span style=color:#f92672>=</span>i-0c9601ce9bd144f5e<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>No changes. Your infrastructure matches the configuration.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Terraform has compared your real infrastructure against your configuration and found no differences, so no changes are needed.
</span></span></code></pre></div><h3 id=replace_triggered_by>replace_triggered_by<a href=#replace_triggered_by class=hanchor arialabel=Anchor>&#8983;</a></h3><p>Останній параметр це <code>replace_triggered_by</code>. Він перестворює ресурс у випадку якщо якийсь атрибут чи інший ресурс змінився (Added in terraform version 1.2)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-terraform data-lang=terraform><span style=display:flex><span>  <span style=color:#a6e22e>lifecycle</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>replace_triggered_by</span> = [
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>aws_instance</span>.<span style=color:#a6e22e>foo</span>
</span></span><span style=display:flex><span>    ]
</span></span><span style=display:flex><span>  }
</span></span></code></pre></div><p>Я добавлю новий ресурс який буде генерувати випадкову стрінгу і вкажу його як replace trigger.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>resource <span style=color:#e6db74>&#34;random_id&#34;</span> <span style=color:#e6db74>&#34;server&#34;</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>  keepers <span style=color:#f92672>=</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    ami_id <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;ami-0cff7528ff583bf9a&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>  byte_length <span style=color:#f92672>=</span> <span style=color:#ae81ff>12</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>resource <span style=color:#e6db74>&#34;aws_instance&#34;</span> <span style=color:#e6db74>&#34;foo&#34;</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>  ami                    <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;ami-0cff7528ff583bf9a&#34;</span>
</span></span><span style=display:flex><span>  instance_type          <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;t2.micro&#34;</span>
</span></span><span style=display:flex><span>  subnet_id              <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;subnet-db73f0ac&#34;</span>
</span></span><span style=display:flex><span>  vpc_security_group_ids <span style=color:#f92672>=</span> <span style=color:#f92672>[</span><span style=color:#e6db74>&#34;sg-b04b8cd4&#34;</span><span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>  tags <span style=color:#f92672>=</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    Env <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Dev222&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>  volume_tags <span style=color:#f92672>=</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Env&#34;</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Dev&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  lifecycle <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    replace_triggered_by <span style=color:#f92672>=</span> <span style=color:#f92672>[</span>
</span></span><span style=display:flex><span>      random_id.server
</span></span><span style=display:flex><span>    <span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><p>І як тільки зміниться згенерована стрінга сервер теж буде перестворено</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>terraform apply
</span></span><span style=display:flex><span>random_id.server: Refreshing state... <span style=color:#f92672>[</span>id<span style=color:#f92672>=</span>dS2PD5rErdg<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>aws_instance.foo: Refreshing state... <span style=color:#f92672>[</span>id<span style=color:#f92672>=</span>i-0747f2f517d71ae85<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Terraform used the selected providers to generate the following execution plan. Resource actions are indicated with the following symbols:
</span></span><span style=display:flex><span>-/+ destroy and <span style=color:#66d9ef>then</span> create replacement
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Terraform will perform the following actions:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e># aws_instance.foo will be replaced due to changes in replace_triggered_by</span>
</span></span><span style=display:flex><span>-/+ resource <span style=color:#e6db74>&#34;aws_instance&#34;</span> <span style=color:#e6db74>&#34;foo&#34;</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>      ~ arn                                  <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;arn:aws:ec2:us-east-1:241394805508:instance/i-0747f2f517d71ae85&#34;</span> -&gt; <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      ~ associate_public_ip_address          <span style=color:#f92672>=</span> true -&gt; <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      ~ availability_zone                    <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;us-east-1c&#34;</span> -&gt; <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      ~ cpu_core_count                       <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span> -&gt; <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      ~ cpu_threads_per_core                 <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span> -&gt; <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      ~ disable_api_stop                     <span style=color:#f92672>=</span> false -&gt; <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      ~ disable_api_termination              <span style=color:#f92672>=</span> false -&gt; <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      ~ ebs_optimized                        <span style=color:#f92672>=</span> false -&gt; <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      - hibernation                          <span style=color:#f92672>=</span> false -&gt; null
</span></span><span style=display:flex><span>      + host_id                              <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      ~ id                                   <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;i-0747f2f517d71ae85&#34;</span> -&gt; <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      ~ instance_initiated_shutdown_behavior <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;stop&#34;</span> -&gt; <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      ~ instance_state                       <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;running&#34;</span> -&gt; <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      ~ ipv6_address_count                   <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span> -&gt; <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      ~ ipv6_addresses                       <span style=color:#f92672>=</span> <span style=color:#f92672>[]</span> -&gt; <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      + key_name                             <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      ~ monitoring                           <span style=color:#f92672>=</span> false -&gt; <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      + outpost_arn                          <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      + password_data                        <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      + placement_group                      <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      + placement_partition_number           <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      ~ primary_network_interface_id         <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;eni-034b12b8b4d792825&#34;</span> -&gt; <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      ~ private_dns                          <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;ip-172-31-38-182.ec2.internal&#34;</span> -&gt; <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      ~ private_ip                           <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;172.31.38.182&#34;</span> -&gt; <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      ~ public_dns                           <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;ec2-3-85-112-28.compute-1.amazonaws.com&#34;</span> -&gt; <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      ~ public_ip                            <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;3.85.112.28&#34;</span> -&gt; <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      ~ secondary_private_ips                <span style=color:#f92672>=</span> <span style=color:#f92672>[]</span> -&gt; <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      ~ security_groups                      <span style=color:#f92672>=</span> <span style=color:#f92672>[</span>
</span></span><span style=display:flex><span>          - <span style=color:#e6db74>&#34;default&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>]</span> -&gt; <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        tags                                 <span style=color:#f92672>=</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;Env&#34;</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Dev222&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>      ~ tenancy                              <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;default&#34;</span> -&gt; <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      + user_data                            <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      + user_data_base64                     <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># (9 unchanged attributes hidden)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      ~ capacity_reservation_specification <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>          ~ capacity_reservation_preference <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;open&#34;</span> -&gt; <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>          + capacity_reservation_target <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>              + capacity_reservation_id                 <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>              + capacity_reservation_resource_group_arn <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      - credit_specification <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>          - cpu_credits <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;unlimited&#34;</span> -&gt; null
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      + ebs_block_device <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>          + delete_on_termination <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          + device_name           <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          + encrypted             <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          + iops                  <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          + kms_key_id            <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          + snapshot_id           <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          + tags                  <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          + throughput            <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          + volume_id             <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          + volume_size           <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          + volume_type           <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      ~ enclave_options <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>          ~ enabled <span style=color:#f92672>=</span> false -&gt; <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      + ephemeral_block_device <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>          + device_name  <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          + no_device    <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          + virtual_name <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>exits
</span></span><span style=display:flex><span>      ~ maintenance_options <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>          ~ auto_recovery <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;default&#34;</span> -&gt; <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      ~ metadata_options <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>          ~ http_endpoint               <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;enabled&#34;</span> -&gt; <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          ~ http_put_response_hop_limit <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span> -&gt; <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          ~ http_tokens                 <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;optional&#34;</span> -&gt; <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          ~ instance_metadata_tags      <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;disabled&#34;</span> -&gt; <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      + network_interface <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>          + delete_on_termination <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          + device_index          <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          + network_card_index    <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          + network_interface_id  <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      ~ private_dns_name_options <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>          ~ enable_resource_name_dns_a_record    <span style=color:#f92672>=</span> false -&gt; <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          ~ enable_resource_name_dns_aaaa_record <span style=color:#f92672>=</span> false -&gt; <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          ~ hostname_type                        <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;ip-name&#34;</span> -&gt; <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      ~ root_block_device <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>          ~ delete_on_termination <span style=color:#f92672>=</span> true -&gt; <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          ~ device_name           <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;/dev/xvda&#34;</span> -&gt; <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          ~ encrypted             <span style=color:#f92672>=</span> false -&gt; <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          ~ iops                  <span style=color:#f92672>=</span> <span style=color:#ae81ff>100</span> -&gt; <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          + kms_key_id            <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          ~ tags                  <span style=color:#f92672>=</span> <span style=color:#f92672>{}</span> -&gt; <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          ~ throughput            <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span> -&gt; <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          ~ volume_id             <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;vol-0b353de4ae7778314&#34;</span> -&gt; <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          ~ volume_size           <span style=color:#f92672>=</span> <span style=color:#ae81ff>8</span> -&gt; <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>          ~ volume_type           <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;gp2&#34;</span> -&gt; <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e># random_id.server must be replaced</span>
</span></span><span style=display:flex><span>-/+ resource <span style=color:#e6db74>&#34;random_id&#34;</span> <span style=color:#e6db74>&#34;server&#34;</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>      ~ b64_std     <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;dS2PD5rErdg=&#34;</span> -&gt; <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      ~ b64_url     <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;dS2PD5rErdg&#34;</span> -&gt; <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      ~ dec         <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;8443562173573410264&#34;</span> -&gt; <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      ~ hex         <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;752d8f0f9ac4add8&#34;</span> -&gt; <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      ~ id          <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;dS2PD5rErdg&#34;</span> -&gt; <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      + keepers     <span style=color:#f92672>=</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>          + <span style=color:#e6db74>&#34;ami_id&#34;</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;ami-0cff7528ff583bf9a&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span> <span style=color:#75715e># forces replacement</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># (1 unchanged attribute hidden)</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Plan: <span style=color:#ae81ff>2</span> to add, <span style=color:#ae81ff>0</span> to change, <span style=color:#ae81ff>2</span> to destroy.
</span></span></code></pre></div><h2 id=depends-on>Depends On<a href=#depends-on class=hanchor arialabel=Anchor>&#8983;</a></h2><p><code>depends_on</code> це ще один мета параметр який підтримується більшістю terraform ресурсів. І він дозволяє створювати ресурси в певній послідовності. Наприклад я хочу створити ec2 сервер і security group. І я можу вказати щоб сервер створювався тільки після того як security group вже створена. Я це можу зробити вказавши <code>depends_on</code> параметр в ресурсі aws_instance.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-terraform data-lang=terraform><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;aws_instance&#34;</span> <span style=color:#e6db74>&#34;foo&#34;</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>ami</span>                    = <span style=color:#e6db74>&#34;ami-0cff7528ff583bf9a&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>instance_type</span>          = <span style=color:#e6db74>&#34;t2.micro&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>subnet_id</span>              = <span style=color:#e6db74>&#34;subnet-222a93327f9a744ed&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>vpc_security_group_ids</span> = [<span style=color:#e6db74>&#34;sg-2220a119757753b6e&#34;</span>]
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>tags</span> = {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Env</span> = <span style=color:#e6db74>&#34;Dev&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>volume_tags</span> = {
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Env&#34;</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Dev&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>depends_on</span> = [
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>aws_security_group</span>.<span style=color:#a6e22e>test_sg</span>
</span></span><span style=display:flex><span>  ]
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>
</span></span></span><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;aws_security_group&#34;</span> <span style=color:#e6db74>&#34;test_sg&#34;</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>name</span>        = <span style=color:#e6db74>&#34;test-sg&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>description</span> = <span style=color:#e6db74>&#34;allow traffic to web app&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>vpc_id</span>      = <span style=color:#e6db74>&#34;vcp-123&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>dynamic</span> <span style=color:#e6db74>&#34;ingress&#34;</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>for_each</span> = [<span style=color:#ae81ff>8080</span>, <span style=color:#ae81ff>443</span>, <span style=color:#ae81ff>22</span>, <span style=color:#ae81ff>80</span>, <span style=color:#ae81ff>3000</span>, <span style=color:#ae81ff>8082</span>]
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>content</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>from_port</span> = <span style=color:#a6e22e>ingress</span>.<span style=color:#a6e22e>value</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>to_port</span>   = <span style=color:#a6e22e>ingress</span>.<span style=color:#a6e22e>value</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>protocol</span>  = <span style=color:#e6db74>&#34;tcp&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>cidr_blocks</span> = [
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;0.0.0.0/0&#34;</span>
</span></span><span style=display:flex><span>      ]
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>egress</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>from_port</span>   = <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>to_port</span>     = <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>protocol</span>    = <span style=color:#e6db74>&#34;-1&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>cidr_blocks</span> = [<span style=color:#e6db74>&#34;0.0.0.0/0&#34;</span>]
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>Plan: <span style=color:#ae81ff>2</span> to add, <span style=color:#ae81ff>0</span> to change, <span style=color:#ae81ff>0</span> to destroy.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Do you want to perform these actions?
</span></span><span style=display:flex><span>  Terraform will perform the actions described above.
</span></span><span style=display:flex><span>  Only <span style=color:#e6db74>&#39;yes&#39;</span> will be accepted to approve.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  Enter a value: yes
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>aws_security_group.test_sg: Creating...
</span></span><span style=display:flex><span>aws_security_group.test_sg: Creation complete after 3s <span style=color:#f92672>[</span>id<span style=color:#f92672>=</span>sg-0512f173f605de311<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>aws_instance.foo: Creating...
</span></span><span style=display:flex><span>aws_instance.foo: Still creating... <span style=color:#f92672>[</span>10s elapsed<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>aws_instance.foo: Creation complete after 15s <span style=color:#f92672>[</span>id<span style=color:#f92672>=</span>i-070da129fdd9d4c92<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Apply complete! Resources: <span style=color:#ae81ff>2</span> added, <span style=color:#ae81ff>0</span> changed, <span style=color:#ae81ff>0</span> destroyed.
</span></span></code></pre></div><h2 id=todo-add-terraform-output>TODO: Add terraform output<a href=#todo-add-terraform-output class=hanchor arialabel=Anchor>&#8983;</a></h2><h2 id=outputs>Outputs<a href=#outputs class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Outputs схоже до return в мовах програмування. Він вертає значення які будуть надруковані в консолі після виконання terraform, також ці значення можуть використовуватись іншим terraform кодом. Найчастіше це використовується в модулях коли child модуль передає якісь значення parent модуль, або ж як просто вивід інформації в термінал.</p><p>Якщо terraform створює ec2 і після створення я хочу вивести його ip адрес то це можна зробити так</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-terraform data-lang=terraform><span style=display:flex><span><span style=color:#66d9ef>resource</span> <span style=color:#e6db74>&#34;aws_instance&#34;</span> <span style=color:#e6db74>&#34;foo&#34;</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>ami</span>                    = <span style=color:#e6db74>&#34;ami-0cff7528ff583bf9a&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>instance_type</span>          = <span style=color:#e6db74>&#34;t2.micro&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>subnet_id</span>              = <span style=color:#e6db74>&#34;subnet-222a93327f9a744ed&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>vpc_security_group_ids</span> = [<span style=color:#e6db74>&#34;sg-2220a119757753b6e&#34;</span>]
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>tags</span> = {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Env</span> = <span style=color:#e6db74>&#34;Dev&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>volume_tags</span> = {
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Env&#34;</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Dev&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>
</span></span></span><span style=display:flex><span><span style=color:#66d9ef>output</span> <span style=color:#e6db74>&#34;instance_ip_addr&#34;</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>value</span> = <span style=color:#a6e22e>aws_instance</span>.<span style=color:#a6e22e>foo</span>.<span style=color:#a6e22e>private_ip</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>Plan: <span style=color:#ae81ff>1</span> to add, <span style=color:#ae81ff>0</span> to change, <span style=color:#ae81ff>0</span> to destroy.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Changes to Outputs:
</span></span><span style=display:flex><span>  + instance_ip_addr <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>known after apply<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Do you want to perform these actions?
</span></span><span style=display:flex><span>  Terraform will perform the actions described above.
</span></span><span style=display:flex><span>  Only <span style=color:#e6db74>&#39;yes&#39;</span> will be accepted to approve.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  Enter a value: yes
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>aws_instance.foo: Creating...
</span></span><span style=display:flex><span>aws_instance.foo: Still creating... <span style=color:#f92672>[</span>10s elapsed<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>aws_instance.foo: Creation complete after 14s <span style=color:#f92672>[</span>id<span style=color:#f92672>=</span>i-02b842be3d4556465<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Apply complete! Resources: <span style=color:#ae81ff>1</span> added, <span style=color:#ae81ff>0</span> changed, <span style=color:#ae81ff>0</span> destroyed.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Outputs:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>instance_ip_addr <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;172.31.43.168&#34;</span>
</span></span></code></pre></div><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/qdGpvePGSJs style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div></div></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=https://mpostument.com/ua/2022/09/09/terraform-variables/><span class=button__icon>←</span>
<span class=button__text>Terraform Variables</span></a></span>
<span class="button next"><a href=https://mpostument.com/ua/2022/08/22/terraform-dynamic/><span class=button__text>Terraform Dynamic</span>
<span class=button__icon>→</span></a></span></div></div><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//mpostument-com.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2022 Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script src=https://mpostument.com/assets/main.js></script>
<script src=https://mpostument.com/assets/prism.js></script>
<script src=https://mpostument.com/assets/languageSelector.js></script></div></body></html>