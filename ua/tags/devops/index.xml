<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Devops on mpostument.com</title><link>/ua/tags/devops/</link><description>Recent content in Devops on mpostument.com</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Sat, 06 Mar 2021 18:56:24 +0200</lastBuildDate><atom:link href="/ua/tags/devops/index.xml" rel="self" type="application/rss+xml"/><item><title>Latest post in GitHub readme</title><link>/ua/2021/03/06/latest-post-in-github-readme/</link><pubDate>Sat, 06 Mar 2021 18:56:24 +0200</pubDate><guid>/ua/2021/03/06/latest-post-in-github-readme/</guid><description>–ü—Ä–∏–≤—ñ—Ç!
–°—å–æ–≥–æ–¥–Ω—ñ –ø–æ–∫–∞–∂—É —è–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ GitHub Readme –∑ –æ—Å—Ç–∞–Ω–Ω—ñ–º–∏ –±–ª–æ–≥ –ø–æ—Å—Ç–∞–º–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é go. –í GitHub –ø–æ—Ç—Ä—ñ–±–Ω–æ —Å—Ç–≤–æ—Ä–∏—Ç–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π –∑ —ñ–º–µ–Ω–µ–º GitHub –ø—Ä–æ—Ñ—ñ–ª—è. –ú—ñ–π GitHub –ø—Ä–æ—Ñ–∞–π–ª –Ω–∞–∑–∏–≤–∞—î—Ç—å—Å—è mpostument, –æ—Ç–∂–µ —è —Å—Ç–≤–æ—Ä—é —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π –∑ —Ç–∞–∫–∏–º —Å–∞–º–∏–º —ñ–º–µ–Ω–µ–º.
–ö–ª–æ–Ω—É—é —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π —ñ –≤ –Ω—å–æ–º—É –≤–∏–∫–ª–∏–∫–∞—é go mod init, –¥–ª—è —Ç–æ–≥–æ —â–æ–± —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ go –º–æ–¥—É–ª—å —è–∫–π —ñ –±—É–¥–µ –≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ readme. –í –∫–æ—Ä–µ–Ω—ñ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—è –ø–æ—Ç—Ä—ñ–±–Ω–æ —Å—Ç–≤–æ—Ä–∏—Ç–∏ main.go —è–∫–∏–π —ñ –±—É–¥–µ –∑–¥—ñ–π—Å–Ω—é–≤–∞—Ç–∏ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—é.
–ù–∞ –ø–æ—á–∞—Ç–∫—É –±—É–¥—É—Ç—å —ñ–º–ø–æ—Ä—Ç–∏ —Ç–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤ —è–∫—É –±—É–¥—É—Ç—å –∑–∞–ø–∏—Å—É–≤–∞—Ç–∏—Å—å –ø–æ—Å—Ç–∏.</description><content>&lt;p>–ü—Ä–∏–≤—ñ—Ç!&lt;/p>
&lt;p>–°—å–æ–≥–æ–¥–Ω—ñ –ø–æ–∫–∞–∂—É —è–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ GitHub Readme –∑ –æ—Å—Ç–∞–Ω–Ω—ñ–º–∏ –±–ª–æ–≥ –ø–æ—Å—Ç–∞–º–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é go.
–í GitHub –ø–æ—Ç—Ä—ñ–±–Ω–æ —Å—Ç–≤–æ—Ä–∏—Ç–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π –∑ —ñ–º–µ–Ω–µ–º GitHub –ø—Ä–æ—Ñ—ñ–ª—è. –ú—ñ–π GitHub –ø—Ä–æ—Ñ–∞–π–ª –Ω–∞–∑–∏–≤–∞—î—Ç—å—Å—è mpostument, –æ—Ç–∂–µ —è —Å—Ç–≤–æ—Ä—é —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π –∑ —Ç–∞–∫–∏–º —Å–∞–º–∏–º —ñ–º–µ–Ω–µ–º.&lt;/p>
&lt;p>–ö–ª–æ–Ω—É—é —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π —ñ –≤ –Ω—å–æ–º—É –≤–∏–∫–ª–∏–∫–∞—é &lt;code>go mod init&lt;/code>, –¥–ª—è —Ç–æ–≥–æ —â–æ–± —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ go –º–æ–¥—É–ª—å —è–∫–π —ñ –±—É–¥–µ –≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ readme.
–í –∫–æ—Ä–µ–Ω—ñ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—è –ø–æ—Ç—Ä—ñ–±–Ω–æ —Å—Ç–≤–æ—Ä–∏—Ç–∏ &lt;code>main.go&lt;/code> —è–∫–∏–π —ñ –±—É–¥–µ –∑–¥—ñ–π—Å–Ω—é–≤–∞—Ç–∏ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—é.&lt;/p>
&lt;p>–ù–∞ –ø–æ—á–∞—Ç–∫—É –±—É–¥—É—Ç—å —ñ–º–ø–æ—Ä—Ç–∏ —Ç–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤ —è–∫—É –±—É–¥—É—Ç—å –∑–∞–ø–∏—Å—É–≤–∞—Ç–∏—Å—å –ø–æ—Å—Ç–∏.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-golang" data-lang="golang">&lt;span style="color:#f92672">package&lt;/span> &lt;span style="color:#a6e22e">main&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> (
&lt;span style="color:#e6db74">&amp;#34;log&amp;#34;&lt;/span>
&lt;span style="color:#e6db74">&amp;#34;os&amp;#34;&lt;/span>
&lt;span style="color:#e6db74">&amp;#34;strings&amp;#34;&lt;/span>
&lt;span style="color:#e6db74">&amp;#34;text/template&amp;#34;&lt;/span>
&lt;span style="color:#e6db74">&amp;#34;github.com/mmcdole/gofeed&amp;#34;&lt;/span>
)
&lt;span style="color:#66d9ef">type&lt;/span> &lt;span style="color:#a6e22e">ReadmeData&lt;/span> &lt;span style="color:#66d9ef">struct&lt;/span> {
&lt;span style="color:#a6e22e">Title&lt;/span> &lt;span style="color:#66d9ef">string&lt;/span>
&lt;span style="color:#a6e22e">Link&lt;/span> &lt;span style="color:#66d9ef">string&lt;/span>
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>gofeed&lt;/code> –º–æ–¥—É–ª—å –ø–æ—Ç—Ä—ñ–±–Ω–∏–π —â–æ–± —á–∏—Ç–∞—Ç–∏ rss feed –Ω–∞ –æ—Å–Ω–æ–≤—ñ –Ω—å–æ–≥–æ –≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ —Å–ø–∏—Å–æ–∫ –ø–æ—Å—Ç—ñ–≤.&lt;br>
–°–∞–º –∫–æ–¥ —è–≤–ª—è—î—Ç—å—Å—è –¥–æ—Å–∏—Ç—å –ø—Ä–æ—Å—Ç–∏–º, —á–∏—Ç–∞—é —Ç–µ–º–ø–ª–µ–π—Ç –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é &lt;code>template.ParseFiles&lt;/code>. –ü—ñ—Å–ª—è —Ü—å–æ–≥–æ —Å—Ç–≤–æ—Ä—é—î–º–æ &lt;code>gofeed.NewParser()&lt;/code> –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —è–∫–æ–≥–æ –æ—Ç—Ä–∏–º–∞—î–º–æ rss feed –∑ –º–æ–≥–æ —Å–∞–π—Ç—É. –ü—Ä–æ—Ö–æ–¥–∂—É—Å—å —Ü–∏–∫–ª–æ–º –ø–æ —Å–ø–∏—Å–∫—É —É—Å—ñ—Ö –ø–æ—Å—Ç—ñ–≤ –∑ rss feed —Ç–∞ –¥–æ–±–∞–≤–ª—é –¥–∞–Ω—ñ –ø—Ä–æ –ø–æ—Å—Ç–∏ –≤ —Å–ª–∞–π—Å —è–∫–∏–π –ø–µ—Ä–µ–¥–∞–º –≤ —Ç–µ–º–ø–ª–µ–π—Ç —ñ –∑–±–µ—Ä–µ–∂—É –≤ —Ñ–∞–π–ª –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é &lt;code>template.Execute&lt;/code>.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-golang" data-lang="golang">&lt;span style="color:#66d9ef">func&lt;/span> &lt;span style="color:#a6e22e">main&lt;/span>() {
&lt;span style="color:#a6e22e">template&lt;/span>, &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">template&lt;/span>.&lt;span style="color:#a6e22e">ParseFiles&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;README.tmpl&amp;#34;&lt;/span>)
&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#66d9ef">nil&lt;/span> {
&lt;span style="color:#a6e22e">log&lt;/span>.&lt;span style="color:#a6e22e">Fatalln&lt;/span>(&lt;span style="color:#a6e22e">err&lt;/span>)
}
&lt;span style="color:#a6e22e">fp&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">gofeed&lt;/span>.&lt;span style="color:#a6e22e">NewParser&lt;/span>()
&lt;span style="color:#a6e22e">feed&lt;/span>, &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">fp&lt;/span>.&lt;span style="color:#a6e22e">ParseURL&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;https://mpostument.com/index.xml&amp;#34;&lt;/span>)
&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#66d9ef">nil&lt;/span> {
&lt;span style="color:#a6e22e">log&lt;/span>.&lt;span style="color:#a6e22e">Fatalln&lt;/span>(&lt;span style="color:#a6e22e">err&lt;/span>)
}
&lt;span style="color:#a6e22e">postList&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> []&lt;span style="color:#a6e22e">ReadmeData&lt;/span>{}
&lt;span style="color:#66d9ef">for&lt;/span> &lt;span style="color:#a6e22e">index&lt;/span>, &lt;span style="color:#a6e22e">post&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#66d9ef">range&lt;/span> &lt;span style="color:#a6e22e">feed&lt;/span>.&lt;span style="color:#a6e22e">Items&lt;/span> {
&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">index&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">7&lt;/span> {
&lt;span style="color:#66d9ef">break&lt;/span>
}
&lt;span style="color:#a6e22e">readmeData&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">ReadmeData&lt;/span>{
&lt;span style="color:#a6e22e">Title&lt;/span>: &lt;span style="color:#a6e22e">post&lt;/span>.&lt;span style="color:#a6e22e">Title&lt;/span>,
&lt;span style="color:#a6e22e">Link&lt;/span>: &lt;span style="color:#a6e22e">post&lt;/span>.&lt;span style="color:#a6e22e">Link&lt;/span>,
}
&lt;span style="color:#a6e22e">postList&lt;/span> = append(&lt;span style="color:#a6e22e">postList&lt;/span>, &lt;span style="color:#a6e22e">readmeData&lt;/span>)
}
&lt;span style="color:#a6e22e">f&lt;/span>, &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">os&lt;/span>.&lt;span style="color:#a6e22e">Create&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;README.MD&amp;#34;&lt;/span>)
&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#66d9ef">nil&lt;/span> {
&lt;span style="color:#a6e22e">log&lt;/span>.&lt;span style="color:#a6e22e">Fatalln&lt;/span>(&lt;span style="color:#a6e22e">err&lt;/span>)
}
&lt;span style="color:#a6e22e">err&lt;/span> = &lt;span style="color:#a6e22e">template&lt;/span>.&lt;span style="color:#a6e22e">Execute&lt;/span>(&lt;span style="color:#a6e22e">f&lt;/span>, &lt;span style="color:#a6e22e">postList&lt;/span>)
&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#66d9ef">nil&lt;/span> {
&lt;span style="color:#a6e22e">log&lt;/span>.&lt;span style="color:#a6e22e">Fatalln&lt;/span>(&lt;span style="color:#a6e22e">err&lt;/span>)
}
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>–ù–∞—Å—Ç—É–ø–Ω–∏–º –∫—Ä–æ–∫–æ–º –ø–æ—Ç—Ä—ñ–±–Ω–æ —Å—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–µ–º–ø–ª–µ–π—Ç &lt;code>README.tmpl&lt;/code> –∑ –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-golang" data-lang="golang">&lt;span style="color:#960050;background-color:#1e0010">##&lt;/span> &lt;span style="color:#960050;background-color:#1e0010">üìù&lt;/span> &lt;span style="color:#a6e22e">My&lt;/span> &lt;span style="color:#a6e22e">Latest&lt;/span> &lt;span style="color:#a6e22e">Blog&lt;/span> &lt;span style="color:#a6e22e">Posts&lt;/span>
{{&lt;span style="color:#66d9ef">range&lt;/span> .}}
&lt;span style="color:#f92672">-&lt;/span> [{{.&lt;span style="color:#a6e22e">Title&lt;/span>}}](&lt;span style="color:#a6e22e">https&lt;/span>:&lt;span style="color:#75715e">//mpostument.com{{.Link}}/)
&lt;/span>&lt;span style="color:#75715e">&lt;/span>{{&lt;span style="color:#a6e22e">end&lt;/span>}}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>–Ø–∫—â–æ –∑–∞–ø—É—Å—Ç–∏—Ç–∏ –∫–æ–¥ —Ç–æ —Å—Ç–≤–æ—Ä–∏—Ç—å—Å—è —Ñ–∞–π–ª &lt;code>README.MD&lt;/code> –∑ —Å–ø–∏—Å–∫–æ–º –æ—Å—Ç–∞–Ω–Ω—ñ—Ö –ø–æ—Å—Ç—ñ–≤.&lt;/p>
&lt;p>–î–ª—è —Ç–æ–≥–æ —â–æ–± GitHub readme –≥–µ–Ω–µ—Ä—É–≤–∞–ª–æ—Å—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ GitHubActions.&lt;br>
–í –∫–æ—Ä–µ–Ω—ñ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—è –ø–æ—Ç—Ä—ñ–±–Ω–æ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –ø–∞–ø–∫–∏ &lt;code>.github/workflows&lt;/code>. –Ü –≤ –Ω—ñ–π —Å—Ç–≤–æ—Ä–∏—Ç–∏ —Ñ–∞–π–ª &lt;code>generate_readme.yml&lt;/code>.
–¶–µ–π —Ñ–∞–π–ª —è–≤–ª—è—î—Ç—å—Å—è –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—î—é –∫—Ä–æ–∫—ñ–≤ —è–∫—ñ –≤–∏–∫–ª–∏—á–µ GitHubActions, action –±—É–¥–µ –∑–∞–ø—É—Å–∫–∞—Ç–∏—Å—å —â–æ –¥–Ω—è –æ –ø—ñ–≤–Ω–æ—á—ñ. –°–ø–æ—á–∞—Ç–∫—É –∫–ª–æ–Ω—É—î—Ç—å—Å—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π, –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è go —ñ –∑–∞–≤–∞–Ω—Ç–∞–∂–∞—Ç—å—Å—è —É—Å—ñ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ, —Å–∫–æ–º–ø—ñ–ª—é—î—Ç—å—Å—è –∫–æ–¥, –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è —ñ –∑–≥–µ–Ω–µ—Ä—É—î Readme.md. –Ü —è–∫—â–æ –±—É–¥—É—Ç—å –∑–º—ñ–Ω–∏ –≤ —Ñ–∞–π–ª—ñ –≤–æ–Ω–∏ –∑–∞–∫–æ–º—ñ—Ç—è—Ç—Å—è –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π —ñ –±—É–¥—É—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ñ –≤ –ø—Ä–æ—Ñ—ñ–ª—ñ.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-yml" data-lang="yml">&lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">Generate readme&lt;/span>
&lt;span style="color:#f92672">on&lt;/span>:
&lt;span style="color:#f92672">schedule&lt;/span>:
- &lt;span style="color:#f92672">cron&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;0 0 * * *&amp;#34;&lt;/span>
&lt;span style="color:#f92672">workflow_dispatch&lt;/span>:
&lt;span style="color:#f92672">jobs&lt;/span>:
&lt;span style="color:#f92672">update-readme-with-blog&lt;/span>:
&lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">Update this repo&amp;#39;s README with latest blog posts&lt;/span>
&lt;span style="color:#f92672">runs-on&lt;/span>: &lt;span style="color:#ae81ff">ubuntu-latest&lt;/span>
&lt;span style="color:#f92672">steps&lt;/span>:
- &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">Checkout&lt;/span>
&lt;span style="color:#f92672">uses&lt;/span>: &lt;span style="color:#ae81ff">actions/checkout@v2&lt;/span>
- &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">Setup go&lt;/span>
&lt;span style="color:#f92672">uses&lt;/span>: &lt;span style="color:#ae81ff">actions/setup-go@v2&lt;/span>
&lt;span style="color:#f92672">with&lt;/span>:
&lt;span style="color:#f92672">go-version&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;1.16&amp;#34;&lt;/span>
- &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">Go tidy&lt;/span>
&lt;span style="color:#f92672">run&lt;/span>: &lt;span style="color:#ae81ff">go mod tidy&lt;/span>
- &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">Build project&lt;/span>
&lt;span style="color:#f92672">run&lt;/span>: &lt;span style="color:#ae81ff">go build&lt;/span>
- &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">Generate readme&lt;/span>
&lt;span style="color:#f92672">run&lt;/span>: &lt;span style="color:#ae81ff">./mpostument&lt;/span>
- &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">Commit and push if changed&lt;/span>
&lt;span style="color:#f92672">run&lt;/span>: |-&lt;span style="color:#e6db74">
&lt;/span>&lt;span style="color:#e6db74"> git diff
&lt;/span>&lt;span style="color:#e6db74"> git config --global user.email &amp;#34;actions@users.noreply.github.com&amp;#34;
&lt;/span>&lt;span style="color:#e6db74"> git config --global user.name &amp;#34;README-bot&amp;#34;
&lt;/span>&lt;span style="color:#e6db74"> git add -A
&lt;/span>&lt;span style="color:#e6db74"> git commit -m &amp;#34;Updated readme content&amp;#34; || exit 0
&lt;/span>&lt;span style="color:#e6db74"> git push&lt;/span>
&lt;/code>&lt;/pre>&lt;/div></content></item><item><title>Ebs Auto Resize</title><link>/ua/2021/02/06/ebs-auto-resize/</link><pubDate>Sat, 06 Feb 2021 18:14:40 +0200</pubDate><guid>/ua/2021/02/06/ebs-auto-resize/</guid><description>–ü—Ä–∏–≤—ñ—Ç!
–°—å–æ–≥–æ–¥–Ω—ñ –∑—Ä–æ–±–∏–º–æ —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ —Ä–µ—Å–∞–π–∑—É EBS volume –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é golang i AWS SDK version 2. –î–ª—è —Ç–æ–≥–æ —â–æ–± —Ü–µ –∑—Ä–æ–±–∏—Ç–∏ –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏–∫–æ–Ω–∞—Ç–∏ –¥–µ–∫—ñ–ª—å–∫–∞ –∫—Ä–æ–∫—ñ–≤, –æ—Ç—Ä–∏–º–∞—Ç–∏ —Å–ø–∏—Å–æ–∫ –≤–æ–ª—é–º—ñ–≤, –≤—ñ–¥—Ñ—ñ–ª—å—Ç—Ä—É–≤–∞—Ç–∏ —Ç–∏—Ö –≤ —è–∫–∏—Ö –∫—ñ–ª—å–∫—ñ—Å—Ç—å –≤—ñ–ª—å–Ω–æ—ó –ø–∞–º&amp;rsquo;—è—Ç—ñ –º–µ–Ω—à–∏–π –Ω—ñ–∂ —Ç—Ä–µ—à—Ö–æ–ª–¥, –∑–Ω–∞–π—Ç–∏ ebs id —è–∫–∏–π –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –¥–∞–Ω–æ–º—É –≤–æ–ª—é–º—É. –ó—Ä–æ–±–∏—Ç–∏ —Ä–µ—Å–∞–π–∑ –Ω–∞ –∑–∞–¥–∞–Ω–∏–π –ø—Ä–æ—Ü–µ–Ω—Ç —ñ –∑–±—ñ–ª—å—à–∏—Ç–∏ —Ä–æ–∑–º—ñ—Ä –¥–∏—Å–∫—É –Ω–∞ —Ñ–∞–π–ª–æ–≤—ñ–π —Å–∏—Å—Ç–µ–º—ñ.
–†–æ–∑–ø–æ—á–Ω—É –∑ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –≤ —è–∫—ñ–π –±—É–¥–µ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏—Å—å –≤—Å—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø–æ –¥–∏—Å–∫—É —Ç–∞ –≤–∫–∞–∂—É –≤—Å—ñ –ø–æ—Ç—Ä—ñ–±–Ω—ñ —ñ–º–ø–æ—Ä—Ç–∏.</description><content>&lt;p>–ü—Ä–∏–≤—ñ—Ç!&lt;/p>
&lt;p>–°—å–æ–≥–æ–¥–Ω—ñ –∑—Ä–æ–±–∏–º–æ —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ —Ä–µ—Å–∞–π–∑—É EBS volume –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é golang i AWS SDK version 2.
–î–ª—è —Ç–æ–≥–æ —â–æ–± —Ü–µ –∑—Ä–æ–±–∏—Ç–∏ –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏–∫–æ–Ω–∞—Ç–∏ –¥–µ–∫—ñ–ª—å–∫–∞ –∫—Ä–æ–∫—ñ–≤, –æ—Ç—Ä–∏–º–∞—Ç–∏ —Å–ø–∏—Å–æ–∫ –≤–æ–ª—é–º—ñ–≤, –≤—ñ–¥—Ñ—ñ–ª—å—Ç—Ä—É–≤–∞—Ç–∏ —Ç–∏—Ö –≤ —è–∫–∏—Ö –∫—ñ–ª—å–∫—ñ—Å—Ç—å –≤—ñ–ª—å–Ω–æ—ó –ø–∞–º&amp;rsquo;—è—Ç—ñ –º–µ–Ω—à–∏–π –Ω—ñ–∂ —Ç—Ä–µ—à—Ö–æ–ª–¥, –∑–Ω–∞–π—Ç–∏ ebs id —è–∫–∏–π –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –¥–∞–Ω–æ–º—É –≤–æ–ª—é–º—É. –ó—Ä–æ–±–∏—Ç–∏ —Ä–µ—Å–∞–π–∑ –Ω–∞ –∑–∞–¥–∞–Ω–∏–π –ø—Ä–æ—Ü–µ–Ω—Ç —ñ –∑–±—ñ–ª—å—à–∏—Ç–∏ —Ä–æ–∑–º—ñ—Ä –¥–∏—Å–∫—É –Ω–∞ —Ñ–∞–π–ª–æ–≤—ñ–π —Å–∏—Å—Ç–µ–º—ñ.&lt;/p>
&lt;p>–†–æ–∑–ø–æ—á–Ω—É –∑ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –≤ —è–∫—ñ–π –±—É–¥–µ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏—Å—å –≤—Å—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø–æ –¥–∏—Å–∫—É —Ç–∞ –≤–∫–∞–∂—É –≤—Å—ñ –ø–æ—Ç—Ä—ñ–±–Ω—ñ —ñ–º–ø–æ—Ä—Ç–∏.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-golang" data-lang="golang">&lt;span style="color:#f92672">package&lt;/span> &lt;span style="color:#a6e22e">main&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> (
&lt;span style="color:#e6db74">&amp;#34;context&amp;#34;&lt;/span>
&lt;span style="color:#e6db74">&amp;#34;errors&amp;#34;&lt;/span>
&lt;span style="color:#e6db74">&amp;#34;io/ioutil&amp;#34;&lt;/span>
&lt;span style="color:#e6db74">&amp;#34;log&amp;#34;&lt;/span>
&lt;span style="color:#e6db74">&amp;#34;math&amp;#34;&lt;/span>
&lt;span style="color:#e6db74">&amp;#34;net/http&amp;#34;&lt;/span>
&lt;span style="color:#e6db74">&amp;#34;os/exec&amp;#34;&lt;/span>
&lt;span style="color:#e6db74">&amp;#34;regexp&amp;#34;&lt;/span>
&lt;span style="color:#e6db74">&amp;#34;strings&amp;#34;&lt;/span>
&lt;span style="color:#e6db74">&amp;#34;time&amp;#34;&lt;/span>
&lt;span style="color:#e6db74">&amp;#34;github.com/aws/aws-sdk-go-v2/aws&amp;#34;&lt;/span>
&lt;span style="color:#e6db74">&amp;#34;github.com/aws/aws-sdk-go-v2/config&amp;#34;&lt;/span>
&lt;span style="color:#e6db74">&amp;#34;github.com/aws/aws-sdk-go-v2/service/ec2&amp;#34;&lt;/span>
&lt;span style="color:#e6db74">&amp;#34;github.com/aws/aws-sdk-go-v2/service/ec2/types&amp;#34;&lt;/span>
&lt;span style="color:#e6db74">&amp;#34;github.com/aws/smithy-go&amp;#34;&lt;/span>
&lt;span style="color:#e6db74">&amp;#34;github.com/mvisonneau/go-ebsnvme/pkg/ebsnvme&amp;#34;&lt;/span>
&lt;span style="color:#e6db74">&amp;#34;github.com/shirou/gopsutil/v3/disk&amp;#34;&lt;/span>
)
&lt;span style="color:#66d9ef">type&lt;/span> &lt;span style="color:#a6e22e">DiskData&lt;/span> &lt;span style="color:#66d9ef">struct&lt;/span> {
&lt;span style="color:#a6e22e">VolumeID&lt;/span> &lt;span style="color:#66d9ef">string&lt;/span>
&lt;span style="color:#a6e22e">DeviceName&lt;/span> &lt;span style="color:#66d9ef">string&lt;/span>
&lt;span style="color:#a6e22e">MountPoint&lt;/span> &lt;span style="color:#66d9ef">string&lt;/span>
&lt;span style="color:#a6e22e">TotalUsed&lt;/span> &lt;span style="color:#66d9ef">float64&lt;/span>
&lt;span style="color:#a6e22e">TotalSpace&lt;/span> &lt;span style="color:#66d9ef">uint64&lt;/span>
&lt;span style="color:#a6e22e">FsType&lt;/span> &lt;span style="color:#66d9ef">string&lt;/span>
&lt;span style="color:#a6e22e">VolumeSize&lt;/span> &lt;span style="color:#66d9ef">int32&lt;/span>
}
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>–ü–µ—Ä—à–∏–π –º–µ—Ç–æ–¥ –∑–∞–ø–∏—à–µ —É—Å—é –ø–æ—Ç—Ä—ñ–±–Ω—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –¥–∏—Å–∫–∏ –≤ &lt;code>DiskData&lt;/code> —Å—Ç—Ä—É–∫—Ç—É—Ä—É. –î–ª—è —Ç–æ–≥–æ —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –∑ —Å–∏—Å—Ç–µ–º–∏ –±—É–¥–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏—Å—å &lt;code>gopsutil&lt;/code>. –Ø–∫—â–æ –∂ –≤ —Å–∏—Å—Ç–µ–º—ñ –¥–∏—Å–∫ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î—Ç—å—Å—è —è–∫ &lt;code>nvme&lt;/code> –π–æ–≥–æ —Ç—Ä–µ–±–∞ –ø—Ä–∏–≤–µ—Å—Ç–∏ –¥–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –∑–∞–ø–∏—Å—É (/dev/sda) –∑–∞ —è–∫–∏–º –º–æ–∂–Ω–∞ –±—É–¥–µ —Ñ—ñ–ª—å—Ç—Ä—É–≤–∞—Ç–∏ –ø–æ—Ç—Ä—ñ–±–Ω–∏–π –¥–∏—Å–∫. –ê–ª–µ —Ç—ñ–ª—å–∫–∏ —Ü—å–æ–≥–æ –±—É–¥–µ –Ω–µ –¥–æ—Å—Ç–∞—Ç–Ω—å–æ –æ—Å–∫—ñ–ª—å–∫–∏ –¥–∏—Å–∫–∏ –Ω–∞ —Ä—ñ–∑–Ω–∏—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö –º–æ–∂—É—Ç—å –±—É—Ç–∏ –∑–º–æ–Ω—Ç–æ–≤–∞–Ω—ñ –ø—ñ–¥ –æ–¥–Ω–∞–∫–æ–≤–∏–º —ñ–º–µ–Ω–µ–º. –°–∞–º–µ –¥–ª—è —Ü—å–æ–≥–æ –±—É–¥–µ –ø–æ—Ç—Ä—ñ–±–µ–Ω instance id, —è–∫–∏–π –º–æ–∂–Ω–∞ –æ—Ç—Ä–∏–º–∞—Ç–∏ –∑ –º–µ—Ç–∞–¥–∞–Ω–∏—Ö —Å–µ—Ä–≤–µ—Ä–∞.&lt;/p>
&lt;p>–°–ø–æ—á–∞—Ç–∫—É –æ—Ç—Ä–∏–º—É—é —Å–ø–∏—Å–æ–∫ —É—Å—ñ—Ö –¥–∏—Å–∫—ñ–≤ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é &lt;code>disk.Partitions(false)&lt;/code>, —Ç–∞–∫–æ–∂ —Å—Ç–≤–æ—Ä—é—é ec2client i –æ—Ç—Ä–∏–º—É—é instanceID. –¶—ñ –º–µ—Ç–æ–¥–∏ –±—É–¥—É—Ç—å —Å—Ç–≤–æ—Ä–µ–Ω—ñ –ø—ñ–∑–Ω—ñ—à–µ. –î–∞–ª—ñ —Ü–∏–∫–ª–æ–º –ø—Ä–æ—Ö–æ–¥–∂—É –ø–æ —É—Å—ñ—Ö –¥–∏—Å–∫–∞—Ö —ñ –ø–µ—Ä–µ–≤—ñ—Ä—è—é —á–∏ &lt;code>nvme&lt;/code> —î –≤ –Ω–∞–∑–≤—ñ –¥–∏—Å–∫—É —ñ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é &lt;code>ebsnvme&lt;/code> –æ—Ç—Ä–∏–º—É—é –Ω–∞–∑–≤—É –≤ —Ñ–æ—Ä–º–∞—Ç—ñ /dev/sda. –Ü –∑–±–µ—Ä—ñ–≥–∞—é —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ &lt;code>ebsDevice&lt;/code>. –Ø–∫—â–æ –∂ –Ω—ñ —Ç–æ –º—ñ–Ω—è—é –Ω–∞–∑–≤—É –¥–∏—Å–∫–∞ –∑ &lt;code>xvd&lt;/code> –Ω–∞ &lt;code>sd&lt;/code>. –°–∞–º–µ —Ç–∞–∫–∏–π —Ñ–æ—Ä–º–∞—Ç –ø–æ—Ç—Ä—ñ–±–µ–Ω –¥–ª—è aws. –¢–µ–ø–µ—Ä –º–æ–∂–Ω–∞ –∑—Ä–æ–±–∏—Ç–∏ –∑–∞–ø–∏—Ç –¥–æ aws –¥–ª—è —Ç–æ–≥–æ —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ volumeID. –ó–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –º–µ—Ç–æ–¥–∞ &lt;code>Usage&lt;/code> –æ—Ç—Ä–∏–º—É—é –¥–∞–Ω—ñ –ø–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—é –¥–∏—Å–∫–∞ —Ç–∞ –∑–∞–ø–∏—Å—É—é –≤ &lt;code>DiskData&lt;/code> —Å—Ç—Ä—É–∫—Ç—É—Ä—É —ñ –¥–æ–±–∞–≤–ª—é –≤ —Å–ø–∏—Å–æ–∫, —è–∫–∏–π –≤ –∫—ñ–Ω—Ü—ñ –º–µ—Ç–æ–¥–∞ –ø–æ–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-golang" data-lang="golang">&lt;span style="color:#66d9ef">func&lt;/span> &lt;span style="color:#a6e22e">filterDisks&lt;/span>() ([]&lt;span style="color:#a6e22e">DiskData&lt;/span>, &lt;span style="color:#66d9ef">error&lt;/span>) {
&lt;span style="color:#a6e22e">parts&lt;/span>, &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">disk&lt;/span>.&lt;span style="color:#a6e22e">Partitions&lt;/span>(&lt;span style="color:#66d9ef">false&lt;/span>)
&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#66d9ef">nil&lt;/span> {
&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#66d9ef">nil&lt;/span>, &lt;span style="color:#a6e22e">err&lt;/span>
}
&lt;span style="color:#a6e22e">client&lt;/span>, &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">getEc2Client&lt;/span>()
&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#66d9ef">nil&lt;/span> {
&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#66d9ef">nil&lt;/span>, &lt;span style="color:#a6e22e">err&lt;/span>
}
&lt;span style="color:#a6e22e">instanceID&lt;/span>, &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">getInstanceID&lt;/span>()
&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#66d9ef">nil&lt;/span> {
&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#66d9ef">nil&lt;/span>, &lt;span style="color:#a6e22e">err&lt;/span>
}
&lt;span style="color:#a6e22e">diskData&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> []&lt;span style="color:#a6e22e">DiskData&lt;/span>{}
&lt;span style="color:#66d9ef">for&lt;/span> &lt;span style="color:#a6e22e">_&lt;/span>, &lt;span style="color:#a6e22e">p&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#66d9ef">range&lt;/span> &lt;span style="color:#a6e22e">parts&lt;/span> {
&lt;span style="color:#66d9ef">var&lt;/span> &lt;span style="color:#a6e22e">ebsDevice&lt;/span> &lt;span style="color:#66d9ef">string&lt;/span>
&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">strings&lt;/span>.&lt;span style="color:#a6e22e">Contains&lt;/span>(&lt;span style="color:#a6e22e">p&lt;/span>.&lt;span style="color:#a6e22e">Device&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;nvme&amp;#34;&lt;/span>) {
&lt;span style="color:#a6e22e">volumeMapping&lt;/span>, &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">ebsnvme&lt;/span>.&lt;span style="color:#a6e22e">ScanDevice&lt;/span>(&lt;span style="color:#a6e22e">p&lt;/span>.&lt;span style="color:#a6e22e">Device&lt;/span>)
&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#66d9ef">nil&lt;/span> {
&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#66d9ef">nil&lt;/span>, &lt;span style="color:#a6e22e">err&lt;/span>
}
&lt;span style="color:#a6e22e">ebsDevice&lt;/span> = &lt;span style="color:#a6e22e">volumeMapping&lt;/span>.&lt;span style="color:#a6e22e">Name&lt;/span>
} &lt;span style="color:#66d9ef">else&lt;/span> {
&lt;span style="color:#a6e22e">ebsDevice&lt;/span> = &lt;span style="color:#a6e22e">strings&lt;/span>.&lt;span style="color:#a6e22e">Replace&lt;/span>(&lt;span style="color:#a6e22e">p&lt;/span>.&lt;span style="color:#a6e22e">Device&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;xvd&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;sd&amp;#34;&lt;/span>, &lt;span style="color:#ae81ff">1&lt;/span>)
}
&lt;span style="color:#a6e22e">filter&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#f92672">&amp;amp;&lt;/span>&lt;span style="color:#a6e22e">ec2&lt;/span>.&lt;span style="color:#a6e22e">DescribeVolumesInput&lt;/span>{&lt;span style="color:#a6e22e">Filters&lt;/span>: []&lt;span style="color:#a6e22e">types&lt;/span>.&lt;span style="color:#a6e22e">Filter&lt;/span>{
{
&lt;span style="color:#a6e22e">Name&lt;/span>: &lt;span style="color:#a6e22e">aws&lt;/span>.&lt;span style="color:#a6e22e">String&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;attachment.device&amp;#34;&lt;/span>),
&lt;span style="color:#a6e22e">Values&lt;/span>: []&lt;span style="color:#66d9ef">string&lt;/span>{
&lt;span style="color:#a6e22e">ebsDevice&lt;/span>,
},
},
{
&lt;span style="color:#a6e22e">Name&lt;/span>: &lt;span style="color:#a6e22e">aws&lt;/span>.&lt;span style="color:#a6e22e">String&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;attachment.instance-id&amp;#34;&lt;/span>),
&lt;span style="color:#a6e22e">Values&lt;/span>: []&lt;span style="color:#66d9ef">string&lt;/span>{
&lt;span style="color:#a6e22e">instanceID&lt;/span>,
},
},
},
}
&lt;span style="color:#a6e22e">volumeInfo&lt;/span>, &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">client&lt;/span>.&lt;span style="color:#a6e22e">DescribeVolumes&lt;/span>(&lt;span style="color:#a6e22e">context&lt;/span>.&lt;span style="color:#a6e22e">Background&lt;/span>(), &lt;span style="color:#a6e22e">filter&lt;/span>)
&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#66d9ef">nil&lt;/span> {
&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#66d9ef">nil&lt;/span>, &lt;span style="color:#a6e22e">err&lt;/span>
}
&lt;span style="color:#a6e22e">usage&lt;/span>, &lt;span style="color:#a6e22e">_&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">disk&lt;/span>.&lt;span style="color:#a6e22e">Usage&lt;/span>(&lt;span style="color:#a6e22e">p&lt;/span>.&lt;span style="color:#a6e22e">Mountpoint&lt;/span>)
&lt;span style="color:#a6e22e">disk&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">DiskData&lt;/span>{
&lt;span style="color:#a6e22e">VolumeID&lt;/span>: &lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#a6e22e">volumeInfo&lt;/span>.&lt;span style="color:#a6e22e">Volumes&lt;/span>[&lt;span style="color:#ae81ff">0&lt;/span>].&lt;span style="color:#a6e22e">VolumeId&lt;/span>,
&lt;span style="color:#a6e22e">DeviceName&lt;/span>: &lt;span style="color:#a6e22e">p&lt;/span>.&lt;span style="color:#a6e22e">Device&lt;/span>,
&lt;span style="color:#a6e22e">MountPoint&lt;/span>: &lt;span style="color:#a6e22e">p&lt;/span>.&lt;span style="color:#a6e22e">Mountpoint&lt;/span>,
&lt;span style="color:#a6e22e">TotalUsed&lt;/span>: &lt;span style="color:#a6e22e">usage&lt;/span>.&lt;span style="color:#a6e22e">UsedPercent&lt;/span>,
&lt;span style="color:#a6e22e">TotalSpace&lt;/span>: &lt;span style="color:#a6e22e">usage&lt;/span>.&lt;span style="color:#a6e22e">Total&lt;/span>,
&lt;span style="color:#a6e22e">VolumeSize&lt;/span>: &lt;span style="color:#a6e22e">volumeInfo&lt;/span>.&lt;span style="color:#a6e22e">Volumes&lt;/span>[&lt;span style="color:#ae81ff">0&lt;/span>].&lt;span style="color:#a6e22e">Size&lt;/span>,
&lt;span style="color:#a6e22e">FsType&lt;/span>: &lt;span style="color:#a6e22e">p&lt;/span>.&lt;span style="color:#a6e22e">Fstype&lt;/span>,
}
&lt;span style="color:#a6e22e">diskData&lt;/span> = append(&lt;span style="color:#a6e22e">diskData&lt;/span>, &lt;span style="color:#a6e22e">disk&lt;/span>)
}
&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">diskData&lt;/span>, &lt;span style="color:#66d9ef">nil&lt;/span>
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>–ü–æ—Ç—Ä—ñ–±–Ω–æ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –º–µ—Ç–æ–¥–∏ —è–∫—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è filterDisks, –ø–æ—á–Ω—É –∑ getInstanceID. –¶–µ–π –º–µ—Ç–æ–¥ —Ä–æ–±–∏—Ç—å –∑–∞–ø–∏—Ç –¥–æ –º–µ—Ç–∞–¥–∞–Ω–∏—Ö ec2 —ñ–Ω—Å—Ç–∞–Ω—Å–∞ —ñ –æ—Ç—Ä–∏–º—É—î —É –≤—ñ–¥–ø–æ–≤—ñ–¥—å InstanceID.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-golang" data-lang="golang">&lt;span style="color:#66d9ef">func&lt;/span> &lt;span style="color:#a6e22e">getInstanceID&lt;/span>() (&lt;span style="color:#66d9ef">string&lt;/span>, &lt;span style="color:#66d9ef">error&lt;/span>) {
&lt;span style="color:#a6e22e">cfg&lt;/span>, &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">config&lt;/span>.&lt;span style="color:#a6e22e">LoadDefaultConfig&lt;/span>(&lt;span style="color:#a6e22e">context&lt;/span>.&lt;span style="color:#a6e22e">TODO&lt;/span>())
&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#66d9ef">nil&lt;/span> {
&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#e6db74">&amp;#34;&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">err&lt;/span>
}
&lt;span style="color:#a6e22e">client&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">imds&lt;/span>.&lt;span style="color:#a6e22e">NewFromConfig&lt;/span>(&lt;span style="color:#a6e22e">cfg&lt;/span>)
&lt;span style="color:#a6e22e">instanceID&lt;/span>, &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">client&lt;/span>.&lt;span style="color:#a6e22e">GetInstanceIdentityDocument&lt;/span>(&lt;span style="color:#a6e22e">context&lt;/span>.&lt;span style="color:#a6e22e">TODO&lt;/span>(), &lt;span style="color:#f92672">&amp;amp;&lt;/span>&lt;span style="color:#a6e22e">imds&lt;/span>.&lt;span style="color:#a6e22e">GetInstanceIdentityDocumentInput&lt;/span>{})
&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#66d9ef">nil&lt;/span> {
&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#e6db74">&amp;#34;&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">err&lt;/span>
}
&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">instanceID&lt;/span>.&lt;span style="color:#a6e22e">InstanceID&lt;/span>, &lt;span style="color:#66d9ef">nil&lt;/span>
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>getEc2Client&lt;/code> –∑ –º–µ—Ç–∞–¥–∞–Ω–∏—Ö –æ—Ç—Ä–∏–º—É—î –Ω–∞–∑–≤—É —Ä–µ–≥—ñ–æ–Ω—É —Ç–∞ –ø–æ–≤–µ—Ä—Ç–∞—î ec2 client.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-golang" data-lang="golang">&lt;span style="color:#66d9ef">func&lt;/span> &lt;span style="color:#a6e22e">getEc2Client&lt;/span>() (&lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#a6e22e">ec2&lt;/span>.&lt;span style="color:#a6e22e">Client&lt;/span>, &lt;span style="color:#66d9ef">error&lt;/span>) {
&lt;span style="color:#a6e22e">cfg&lt;/span>, &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">config&lt;/span>.&lt;span style="color:#a6e22e">LoadDefaultConfig&lt;/span>(&lt;span style="color:#a6e22e">context&lt;/span>.&lt;span style="color:#a6e22e">TODO&lt;/span>())
&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#66d9ef">nil&lt;/span> {
&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#66d9ef">nil&lt;/span>, &lt;span style="color:#a6e22e">err&lt;/span>
}
&lt;span style="color:#a6e22e">client&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">imds&lt;/span>.&lt;span style="color:#a6e22e">NewFromConfig&lt;/span>(&lt;span style="color:#a6e22e">cfg&lt;/span>)
&lt;span style="color:#a6e22e">region&lt;/span>, &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">client&lt;/span>.&lt;span style="color:#a6e22e">GetRegion&lt;/span>(&lt;span style="color:#a6e22e">context&lt;/span>.&lt;span style="color:#a6e22e">TODO&lt;/span>(), &lt;span style="color:#f92672">&amp;amp;&lt;/span>&lt;span style="color:#a6e22e">imds&lt;/span>.&lt;span style="color:#a6e22e">GetRegionInput&lt;/span>{})
&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#66d9ef">nil&lt;/span> {
&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#66d9ef">nil&lt;/span>, &lt;span style="color:#a6e22e">err&lt;/span>
}
&lt;span style="color:#a6e22e">cfg&lt;/span>.&lt;span style="color:#a6e22e">Region&lt;/span> = &lt;span style="color:#a6e22e">region&lt;/span>.&lt;span style="color:#a6e22e">Region&lt;/span>
&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">ec2&lt;/span>.&lt;span style="color:#a6e22e">NewFromConfig&lt;/span>(&lt;span style="color:#a6e22e">cfg&lt;/span>), &lt;span style="color:#a6e22e">err&lt;/span>
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>–ó–∞–ª–∏—à–∏–ª–æ—Å—å –≤–∏—Ä–∞—Ö—É–≤–∞—Ç–∏ –Ω–∞ —Å–∫—ñ–ª—å–∫–∏ –∑–±—ñ–ª—å—à–∏—Ç–∏ —Ä–æ–∑–º—ñ—Ä –¥–∏—Å–∫–∞.
–í —Ü—å–æ–º—É –º–µ—Ç–æ–¥—ñ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç—å—Å—è —Ä–æ–∑–º—ñ—Ä –¥–∏—Å–∫–∞ –æ—Ç—Ä–∏–º–∞–Ω–∏–π –≤ &lt;code>filterDisks&lt;/code> –∑ –±–∞–π—Ç—ñ–≤ –≤ –≥—ñ–≥–∞–±–∞–π—Ç —Ç–∞ –≤–∏–∑–Ω–∞—á–∞—î—Ç—å—Å—è –Ω–æ–≤–∏–π —Ä–æ–∑–º—ñ—Ä –¥–∏—Å–∫–∞.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-golang" data-lang="golang">&lt;span style="color:#66d9ef">func&lt;/span> &lt;span style="color:#a6e22e">findNewSize&lt;/span>(&lt;span style="color:#a6e22e">oldSize&lt;/span> &lt;span style="color:#66d9ef">uint64&lt;/span>, &lt;span style="color:#a6e22e">increasePercent&lt;/span> &lt;span style="color:#66d9ef">float64&lt;/span>) &lt;span style="color:#66d9ef">int32&lt;/span> {
&lt;span style="color:#a6e22e">gbSize&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> float64(&lt;span style="color:#a6e22e">oldSize&lt;/span>) &lt;span style="color:#f92672">/&lt;/span> &lt;span style="color:#a6e22e">math&lt;/span>.&lt;span style="color:#a6e22e">Pow&lt;/span>(&lt;span style="color:#ae81ff">1024&lt;/span>, &lt;span style="color:#ae81ff">3&lt;/span>)
&lt;span style="color:#a6e22e">newSize&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> ((&lt;span style="color:#a6e22e">gbSize&lt;/span> &lt;span style="color:#f92672">*&lt;/span> &lt;span style="color:#a6e22e">increasePercent&lt;/span>) &lt;span style="color:#f92672">/&lt;/span> &lt;span style="color:#ae81ff">100&lt;/span>) &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#a6e22e">gbSize&lt;/span>
&lt;span style="color:#66d9ef">return&lt;/span> int32(&lt;span style="color:#a6e22e">newSize&lt;/span>)
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>–°–∞–º —Ä–µ—Å–∞–π–∑ –±—É–¥–µ –≤—ñ–¥–±—É–≤–∞—Ç–∏—Å—å –≤ —Ç—Ä–∏ –∫—Ä–æ–∫–∏:&lt;/p>
&lt;ol>
&lt;li>
&lt;p>–ó–±—ñ–ª—å—à–∏—Ç–∏ —Ä–æ–∑–º—ñ—Ä ebs&lt;/p>
&lt;/li>
&lt;li>
&lt;p>–í–∏–∫–ª–∏–∫–∞—Ç–∏ grow part –¥–ª—è —Ç–æ–≥–æ —â–æ–± –∑–±—ñ–ª—å—à–∏—Ç–∏ —Ä–æ–∑–º—ñ—Ä –ø–∞—Ä—Ç–∏—à–∏–Ω–∞ —è–∫—â–æ –≤—ñ–Ω —ñ—Å–Ω—É—î.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>–ó–±—ñ–ª—å—à–∏—Ç–∏ —Ä–æ–∑–º—ñ—Ä —Ñ–∞–π–ª–æ–≤–æ—ó —Å–∏—Å—Ç–µ–º–∏.&lt;/p>
&lt;/li>
&lt;/ol>
&lt;p>–†–æ–∑–ø–æ—á–Ω—É –∑ –ø–µ—Ä—à–æ–≥–æ –∫—Ä–æ–∫—É.&lt;br>
–í —Ü—å–æ–º—É –º–µ—Ç–æ–¥—ñ —è –æ—Ç—Ä–∏–º—É—é ec2 client –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –º–µ—Ç–æ–¥–∞ &lt;code>getEc2Client&lt;/code> —Ç–∞ —Ä–æ–±–ª—é &lt;code>ModifyVolume&lt;/code> –∑–∞–ø–∏—Ç –¥–æ AWS. –¢—É—Ç –≤–∞–∂–ª–∏–≤–æ –≤—ñ–¥—Ñ—ñ–ª—å—Ç—Ä—É–≤–∞—Ç–∏ –ø–µ–≤–Ω—ñ –ø–æ–º–∏–ª–∫–∏.
–ü–µ—Ä—à–∞ —Ü–µ &lt;code>VolumeModificationRateExceeded&lt;/code>. AWS –¥–æ–∑–≤–æ–ª—è—î —Ä–æ–±–∏—Ç–∏ —Ä–µ—Å–∞–π–∑ 1 —Ä–∞–∑ –≤ 6 –≥–æ–¥–∏–Ω, —Ç–æ–º—É —è –Ω–µ —Ö–æ—á—É —â–æ–± —Å–∫—Ä–∏–ø—Ç –∑–∞–≤–µ—Ä—à—É–≤–∞–≤—Å—è —è–∫—â–æ –ª—ñ–º—ñ—Ç –ø–µ—Ä–µ–≤–∏—â–µ–Ω–æ, –∞ –ø–µ—Ä–µ–≤—ñ—Ä—è–≤ —ñ–Ω—à—ñ –¥–æ—Å—Ç—É–ø–Ω—ñ –¥–∏—Å–∫–∏.&lt;/p>
&lt;p>–ù–∞—Å—Ç—É–ø–Ω–∞ –ø–æ–º–∏–ª–∫–∞ —Ü–µ &lt;code>IncorrectModificationState&lt;/code>. –ü—ñ—Å–ª—è —Ä–µ—Å–∞–π–∑—É –¥–∏—Å–∫—É –≤ –Ω—å–æ–≥–æ –∑–º—ñ–Ω—é—î—Ç—å—Å—è —Å—Ç–∞—Ç—É—Ç –Ω–∞ &lt;code>Optimizing&lt;/code>, –≤ —Ç–∞–∫–æ–º—É –≤–∏–ø–∞–¥–∫—É —è —Ç–µ–∂ –Ω–µ —Ö–æ—á—É –∑–∞–≤–µ—Ä—à—É–≤–∞—Ç–∏ —Ä–æ–±–æ—Ç—É, –∞ –ø–µ—Ä–µ–π—Ç–∏ –¥–æ –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ –¥–∏—Å–∫—É.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-golang" data-lang="golang">&lt;span style="color:#66d9ef">func&lt;/span> &lt;span style="color:#a6e22e">ebsResize&lt;/span>(&lt;span style="color:#a6e22e">newSize&lt;/span> &lt;span style="color:#66d9ef">int32&lt;/span>, &lt;span style="color:#a6e22e">volumeID&lt;/span> &lt;span style="color:#66d9ef">string&lt;/span>) &lt;span style="color:#66d9ef">error&lt;/span> {
&lt;span style="color:#a6e22e">client&lt;/span>, &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">getEc2Client&lt;/span>()
&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#66d9ef">nil&lt;/span> {
&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">err&lt;/span>
}
&lt;span style="color:#a6e22e">log&lt;/span>.&lt;span style="color:#a6e22e">Println&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;Starting resize of ebs volume&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">volumeID&lt;/span>)
&lt;span style="color:#a6e22e">input&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#f92672">&amp;amp;&lt;/span>&lt;span style="color:#a6e22e">ec2&lt;/span>.&lt;span style="color:#a6e22e">ModifyVolumeInput&lt;/span>{&lt;span style="color:#a6e22e">VolumeId&lt;/span>: &lt;span style="color:#f92672">&amp;amp;&lt;/span>&lt;span style="color:#a6e22e">volumeID&lt;/span>, &lt;span style="color:#a6e22e">Size&lt;/span>: &lt;span style="color:#a6e22e">newSize&lt;/span>}
&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">_&lt;/span>, &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">client&lt;/span>.&lt;span style="color:#a6e22e">ModifyVolume&lt;/span>(&lt;span style="color:#a6e22e">context&lt;/span>.&lt;span style="color:#a6e22e">Background&lt;/span>(), &lt;span style="color:#a6e22e">input&lt;/span>); &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#66d9ef">nil&lt;/span> {
&lt;span style="color:#66d9ef">var&lt;/span> &lt;span style="color:#a6e22e">ae&lt;/span> &lt;span style="color:#a6e22e">smithy&lt;/span>.&lt;span style="color:#a6e22e">APIError&lt;/span>
&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">errors&lt;/span>.&lt;span style="color:#a6e22e">As&lt;/span>(&lt;span style="color:#a6e22e">err&lt;/span>, &lt;span style="color:#f92672">&amp;amp;&lt;/span>&lt;span style="color:#a6e22e">ae&lt;/span>) {
&lt;span style="color:#66d9ef">switch&lt;/span> &lt;span style="color:#a6e22e">ae&lt;/span>.&lt;span style="color:#a6e22e">ErrorCode&lt;/span>() {
&lt;span style="color:#66d9ef">case&lt;/span> &lt;span style="color:#e6db74">&amp;#34;VolumeModificationRateExceeded&amp;#34;&lt;/span>:
&lt;span style="color:#a6e22e">log&lt;/span>.&lt;span style="color:#a6e22e">Println&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;Ebs was already resized, wait for 6 hours before next resize&amp;#34;&lt;/span>)
&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">errVolumeRetryLater&lt;/span>
&lt;span style="color:#66d9ef">case&lt;/span> &lt;span style="color:#e6db74">&amp;#34;IncorrectModificationState&amp;#34;&lt;/span>:
&lt;span style="color:#a6e22e">log&lt;/span>.&lt;span style="color:#a6e22e">Println&lt;/span>(&lt;span style="color:#a6e22e">ae&lt;/span>.&lt;span style="color:#a6e22e">ErrorMessage&lt;/span>())
&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">errVolumeRetryLater&lt;/span>
}
} &lt;span style="color:#66d9ef">else&lt;/span> {
&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">err&lt;/span>
}
}
&lt;span style="color:#a6e22e">err&lt;/span> = &lt;span style="color:#a6e22e">waitForEbsResize&lt;/span>(&lt;span style="color:#a6e22e">volumeID&lt;/span>)
&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#66d9ef">nil&lt;/span> {
&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">err&lt;/span>
}
&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#66d9ef">nil&lt;/span>
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>–ü—ñ—Å–ª—è —Ç–æ–≥–æ —è–∫ —Ä–µ—Å–∞–π–∑ –∑–∞–ø—É—â–µ–Ω–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –¥–æ—á–µ–∫–∞—Ç–∏—Å—å –∫–æ–ª–∏ –≤—ñ–Ω –∑–∞–≤–µ—Ä—à–∏—Ç—å—Å—è, –¥–ª—è —Ü—å–æ–≥–æ —è —Å—Ç–≤–æ—Ä—é –Ω–∞—Å—Ç—É–ø–Ω–∏–π –º–µ—Ç–æ–¥ &lt;code>waitForEbsResize&lt;/code>.
–ú–µ—Ç–æ–¥ &lt;code>waitForEbsResize&lt;/code> –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é ec2 client —Ä–æ–±–∏—Ç—å –∑–∞–ø–∏—Ç —Ç–∏–ø—É &lt;code>DescribeVolumesModifications&lt;/code> —ñ –ø–µ—Ä–µ–≤—ñ—Ä—è—î —á–∏ —Å—Ç–∞—Ç—É—Å –¥–∏—Å–∫—É &lt;code>modifying&lt;/code>. –Ø–∫—â–æ —Ç–∞–∫ —á–µ–∫–∞—é 15 —Å–µ–∫—É–Ω–¥ —ñ –∑–∞–ø—É—Å–∫–∞—é —â–µ —Ä–∞–∑ –º–µ—Ç–æ–¥ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-golang" data-lang="golang">&lt;span style="color:#66d9ef">func&lt;/span> &lt;span style="color:#a6e22e">waitForEbsResize&lt;/span>(&lt;span style="color:#a6e22e">volumeID&lt;/span> &lt;span style="color:#66d9ef">string&lt;/span>) &lt;span style="color:#66d9ef">error&lt;/span> {
&lt;span style="color:#a6e22e">client&lt;/span>, &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">getEc2Client&lt;/span>()
&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#66d9ef">nil&lt;/span> {
&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">err&lt;/span>
}
&lt;span style="color:#a6e22e">input&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#f92672">&amp;amp;&lt;/span>&lt;span style="color:#a6e22e">ec2&lt;/span>.&lt;span style="color:#a6e22e">DescribeVolumesModificationsInput&lt;/span>{&lt;span style="color:#a6e22e">VolumeIds&lt;/span>: []&lt;span style="color:#66d9ef">string&lt;/span>{&lt;span style="color:#a6e22e">volumeID&lt;/span>}}
&lt;span style="color:#a6e22e">status&lt;/span>, &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">client&lt;/span>.&lt;span style="color:#a6e22e">DescribeVolumesModifications&lt;/span>(&lt;span style="color:#a6e22e">context&lt;/span>.&lt;span style="color:#a6e22e">Background&lt;/span>(), &lt;span style="color:#a6e22e">input&lt;/span>)
&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">status&lt;/span>.&lt;span style="color:#a6e22e">VolumesModifications&lt;/span>[&lt;span style="color:#ae81ff">0&lt;/span>].&lt;span style="color:#a6e22e">ModificationState&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#e6db74">&amp;#34;modifying&amp;#34;&lt;/span> {
&lt;span style="color:#a6e22e">log&lt;/span>.&lt;span style="color:#a6e22e">Println&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;Ebs modification in progress. Waiting for 15 second&amp;#34;&lt;/span>)
&lt;span style="color:#a6e22e">time&lt;/span>.&lt;span style="color:#a6e22e">Sleep&lt;/span>(&lt;span style="color:#ae81ff">15&lt;/span> &lt;span style="color:#f92672">*&lt;/span> &lt;span style="color:#a6e22e">time&lt;/span>.&lt;span style="color:#a6e22e">Second&lt;/span>)
&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">waitForEbsResize&lt;/span>(&lt;span style="color:#a6e22e">volumeID&lt;/span>); &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#66d9ef">nil&lt;/span> {
&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">err&lt;/span>
}
}
&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#66d9ef">nil&lt;/span>
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>–¢–µ–ø–µ—Ä –º–æ–∂–Ω–∞ –ø—Ä–∏—Å—Ç—É–ø–∏—Ç–∏ –¥–æ 2 –∫—Ä–æ–∫—É &lt;code>growPartition&lt;/code>.&lt;/p>
&lt;p>–ü–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏–∑–Ω–∞—á–∏—Ç–∏ —á–∏ —î –ø–∞—Ä—Ç—ñ—à–∏–Ω, —è–∫—â–æ –π–æ–≥–æ –Ω–µ–º–∞—î grow part –≤–∏–∫–ª–∏–∫–∞—Ç–∏ –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ. –í –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –≤—ñ–¥ —Ç–æ–≥–æ —è–∫–∏–π —Ç–∏–ø –¥–∏—Å–∫—É —è —Ç–∞–∫ —ñ –±—É–¥—É –≤–∏–∑–Ω–∞—á–∞—Ç–∏ —á–∏ —î –ø–∞—Ä—Ç—ñ—à–∏–Ω. –ü–æ—Ç—Ä—ñ–±–Ω–æ –∑—Ä–æ–±–∏—Ç–∏ –¥–µ–∫—ñ–ª—å–∫–∞ –ø–µ—Ä–µ–≤—ñ—Ä–æ–∫. –ü–µ—Ä—à–∞ —á–∏ –≤ –Ω–∞–∑–≤—ñ –Ω–µ–º–∞—î —Ü–∏—Ñ—Ä. –Ø–∫—â–æ —ó—Ö –Ω–µ–º–∞—î —Ç–æ —Ü–µ –Ω–µ –ø–∞—Ä—Ç—ñ—à–∏–Ω —ñ —Ä–æ–±–∏—Ç–∏ growpart –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ. –ù–∞—Å—Ç—É–ø–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –¥–ª—è nvme –ø—Ä–∏—Å—Ç—Ä–æ—ó–≤. –Ø–∫—â–æ –≤ –Ω–∞–∑–≤—ñ —î —Å–∏–º–≤–æ–ª p –æ—Ç–∂–µ —Ü–µ –ø–∞—Ä—Ç—ñ—à–∏–Ω. –ù–∞–ø—Ä–∏–∫–ª–∞–¥ &lt;code>/dev/nvme1n1&lt;/code> - –¥–∏—Å–∫ —ñ &lt;code>/dev/nvme0n1p1&lt;/code> - –ø–∞—Ä—Ç—ñ—à–∏–Ω. –Ü –æ—Å—Ç–∞–Ω–Ω—ñ–π –≤–∏–ø–∞–¥–æ–∫ —è–∫—â–æ —î xvd –≤ –Ω–∞–∑–≤—ñ –ø—Ä–∏—Å—Ç—Ä–æ—é, —Ü—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ª–∏—à–µ –¥–ª—è —Ç–æ–≥–æ —â–æ–± –≤—ñ–¥—Ñ—ñ–ª—å—Ç—Ä—É–≤–∞—Ç–∏ –∑–≤–∏—á–∞–π–Ω–∏–π ebs –≤—ñ–¥ nvme. –Ü –≤ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –≤—ñ–¥ –∫–æ–∂–Ω–æ–≥–æ –≤–∏–ø–∞–¥–∫—É –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è grow part –¥–ª—è ebs - &lt;code>growpart /dev/xvdf 1&lt;/code> —ñ –¥–ª—è nvme - &lt;code>growpart /dev/nvme0n1 1&lt;/code>.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-golang" data-lang="golang">&lt;span style="color:#66d9ef">func&lt;/span> &lt;span style="color:#a6e22e">growPartition&lt;/span>(&lt;span style="color:#a6e22e">partition&lt;/span> &lt;span style="color:#66d9ef">string&lt;/span>) &lt;span style="color:#66d9ef">error&lt;/span> {
&lt;span style="color:#a6e22e">log&lt;/span>.&lt;span style="color:#a6e22e">Println&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;Starting growpart for&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">partition&lt;/span>)
&lt;span style="color:#66d9ef">var&lt;/span> &lt;span style="color:#a6e22e">cmd&lt;/span> &lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#a6e22e">exec&lt;/span>.&lt;span style="color:#a6e22e">Cmd&lt;/span>
&lt;span style="color:#a6e22e">i&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">strings&lt;/span>.&lt;span style="color:#a6e22e">LastIndex&lt;/span>(&lt;span style="color:#a6e22e">partition&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;p&amp;#34;&lt;/span>)
&lt;span style="color:#a6e22e">isLetter&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">regexp&lt;/span>.&lt;span style="color:#a6e22e">MustCompile&lt;/span>(&lt;span style="color:#e6db74">`^/dev/+[a-zA-Z]+$`&lt;/span>).&lt;span style="color:#a6e22e">MatchString&lt;/span>
&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">isLetter&lt;/span>(&lt;span style="color:#a6e22e">partition&lt;/span>) {
&lt;span style="color:#a6e22e">log&lt;/span>.&lt;span style="color:#a6e22e">Println&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;Grow partition for&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">partition&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;not required&amp;#34;&lt;/span>)
} &lt;span style="color:#66d9ef">else&lt;/span> &lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">i&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#f92672">-&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span> {
&lt;span style="color:#a6e22e">cmd&lt;/span> = &lt;span style="color:#a6e22e">exec&lt;/span>.&lt;span style="color:#a6e22e">Command&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;growpart&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">partition&lt;/span>[:&lt;span style="color:#a6e22e">i&lt;/span>], &lt;span style="color:#a6e22e">partition&lt;/span>[&lt;span style="color:#a6e22e">i&lt;/span>&lt;span style="color:#f92672">+&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>:])
&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">cmd&lt;/span>.&lt;span style="color:#a6e22e">Run&lt;/span>()
} &lt;span style="color:#66d9ef">else&lt;/span> &lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">strings&lt;/span>.&lt;span style="color:#a6e22e">Contains&lt;/span>(&lt;span style="color:#a6e22e">partition&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;xvd&amp;#34;&lt;/span>) {
&lt;span style="color:#a6e22e">re&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">regexp&lt;/span>.&lt;span style="color:#a6e22e">MustCompile&lt;/span>(&lt;span style="color:#e6db74">`\D+`&lt;/span>)
&lt;span style="color:#a6e22e">m&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">re&lt;/span>.&lt;span style="color:#a6e22e">FindString&lt;/span>(&lt;span style="color:#a6e22e">partition&lt;/span>)
&lt;span style="color:#a6e22e">cmd&lt;/span> = &lt;span style="color:#a6e22e">exec&lt;/span>.&lt;span style="color:#a6e22e">Command&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;growpart&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">m&lt;/span>, &lt;span style="color:#a6e22e">partition&lt;/span>[len(&lt;span style="color:#a6e22e">m&lt;/span>):])
&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">cmd&lt;/span>.&lt;span style="color:#a6e22e">Run&lt;/span>()
}
&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#66d9ef">nil&lt;/span>
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>–û—Å—Ç–∞–Ω–Ω—ñ –µ—Ç–∞–ø —Ü–µ –∑–±—ñ–ª—å—à–∏—Ç–∏ —Ä–æ–∑–º—ñ—Ä —Ñ–∞–π–ª–æ–≤–æ—ó —Å–∏—Å—Ç–µ–º–∏. –Ø–∫ –±—É–¥–µ –≤—ñ–¥–±—É–≤–∞—Ç–∏—Å—å —Ä–µ—Å–∞–π–∑ –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ —Ñ–∞–π–ª–æ–≤–æ—ó —Å–∏—Å—Ç–µ–º–∏.
–Ø–∫—â–æ —Ü–µ xfs —Ç–æ –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è &lt;code>xfs_growfs&lt;/code> –≤ —ñ–Ω—à–∏—Ö –≤–∏–ø–∞–¥–∫–∞—Ö —Ü–µ &lt;code>resize2fs&lt;/code>.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-golang" data-lang="golang">&lt;span style="color:#66d9ef">func&lt;/span> &lt;span style="color:#a6e22e">fsResize&lt;/span>(&lt;span style="color:#a6e22e">filesystem&lt;/span> &lt;span style="color:#66d9ef">string&lt;/span>, &lt;span style="color:#a6e22e">mountPoint&lt;/span> &lt;span style="color:#66d9ef">string&lt;/span>, &lt;span style="color:#a6e22e">partition&lt;/span> &lt;span style="color:#66d9ef">string&lt;/span>) &lt;span style="color:#66d9ef">error&lt;/span> {
&lt;span style="color:#a6e22e">log&lt;/span>.&lt;span style="color:#a6e22e">Println&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;Starting system volume resize for&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">partition&lt;/span>)
&lt;span style="color:#66d9ef">var&lt;/span> &lt;span style="color:#a6e22e">cmd&lt;/span> &lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#a6e22e">exec&lt;/span>.&lt;span style="color:#a6e22e">Cmd&lt;/span>
&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">filesystem&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#e6db74">&amp;#34;xfs&amp;#34;&lt;/span> {
&lt;span style="color:#a6e22e">cmd&lt;/span> = &lt;span style="color:#a6e22e">exec&lt;/span>.&lt;span style="color:#a6e22e">Command&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;xfs_growfs&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;-d&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">mountPoint&lt;/span>)
} &lt;span style="color:#66d9ef">else&lt;/span> {
&lt;span style="color:#a6e22e">cmd&lt;/span> = &lt;span style="color:#a6e22e">exec&lt;/span>.&lt;span style="color:#a6e22e">Command&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;resize2fs&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">partition&lt;/span>)
}
&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">cmd&lt;/span>.&lt;span style="color:#a6e22e">Run&lt;/span>()
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>–¢–µ–ø–µ—Ä –∑–∞–ª–∏—à–∏–ª–æ—Å—å –≤–∏–∫–ª–∏–∫–∞—Ç–∏ –≤—Å—ñ –º–µ—Ç–æ–¥–∏ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º—É –ø–æ—Ä—è–¥–∫—É:&lt;/p>
&lt;ol>
&lt;li>
&lt;p>–û—Ç—Ä–∏–º—É—é —Å–ø–∏—Å–æ–∫ –¥–∏—Å–∫—ñ–≤&lt;/p>
&lt;/li>
&lt;li>
&lt;p>–ô–¥—É —Ü–∏–∫–ª–æ–º –ø–æ —É—Å—ñ—Ö –¥–∏—Å–∫–∞—Ö. –Ø–∫—â–æ —É–º–æ–≤–∞ &lt;code>disk.TotalUsed &amp;lt; 70&lt;/code> false —Ç–æ —Ä–µ—Å–∞–π–∑ –Ω–µ –ø–æ—Ç—Ä—ñ–±–µ–Ω.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>–í–∏—Ä–∞—Ö–æ–≤—É—é –Ω–æ–≤–∏–π —Ä–æ–∑–º—ñ—Ä –¥–∏—Å–∫—É&lt;/p>
&lt;/li>
&lt;li>
&lt;p>–í–∏–∫–ª–∏–∫–∞—é ebsResize&lt;/p>
&lt;/li>
&lt;li>
&lt;p>–í–∏–∫–ª–∏–∫–∞—é growPartition&lt;/p>
&lt;/li>
&lt;li>
&lt;p>–í–∏–∫–ª–∏–∫–∞—é fsResize&lt;/p>
&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-golang" data-lang="golang">&lt;span style="color:#66d9ef">func&lt;/span> &lt;span style="color:#a6e22e">main&lt;/span>() {
&lt;span style="color:#a6e22e">disksInfo&lt;/span>, &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">filterDisks&lt;/span>()
&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#66d9ef">nil&lt;/span> {
&lt;span style="color:#a6e22e">log&lt;/span>.&lt;span style="color:#a6e22e">Fatalln&lt;/span>(&lt;span style="color:#a6e22e">err&lt;/span>)
}
&lt;span style="color:#66d9ef">for&lt;/span> &lt;span style="color:#a6e22e">_&lt;/span>, &lt;span style="color:#a6e22e">disk&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#66d9ef">range&lt;/span> &lt;span style="color:#a6e22e">disksInfo&lt;/span> {
&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">disk&lt;/span>.&lt;span style="color:#a6e22e">TotalUsed&lt;/span> &amp;lt; &lt;span style="color:#ae81ff">70&lt;/span> {
&lt;span style="color:#a6e22e">log&lt;/span>.&lt;span style="color:#a6e22e">Println&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;Resize for&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">disk&lt;/span>.&lt;span style="color:#a6e22e">DeviceName&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;not required&amp;#34;&lt;/span>)
&lt;span style="color:#66d9ef">continue&lt;/span>
}
&lt;span style="color:#a6e22e">log&lt;/span>.&lt;span style="color:#a6e22e">Println&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;Starting resize of&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">disk&lt;/span>.&lt;span style="color:#a6e22e">DeviceName&lt;/span>)
&lt;span style="color:#a6e22e">newSize&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">findNewSize&lt;/span>(&lt;span style="color:#a6e22e">disk&lt;/span>.&lt;span style="color:#a6e22e">TotalSpace&lt;/span>, &lt;span style="color:#ae81ff">30&lt;/span>)
&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">ebsResize&lt;/span>(int32(&lt;span style="color:#a6e22e">newSize&lt;/span>), &lt;span style="color:#a6e22e">disk&lt;/span>.&lt;span style="color:#a6e22e">VolumeID&lt;/span>); &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#a6e22e">errVolumeRetryLater&lt;/span> {
&lt;span style="color:#66d9ef">continue&lt;/span>
} &lt;span style="color:#66d9ef">else&lt;/span> &lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#66d9ef">nil&lt;/span> {
&lt;span style="color:#a6e22e">log&lt;/span>.&lt;span style="color:#a6e22e">Fatalln&lt;/span>(&lt;span style="color:#a6e22e">err&lt;/span>)
}
&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">growPartition&lt;/span>(&lt;span style="color:#a6e22e">disk&lt;/span>.&lt;span style="color:#a6e22e">DeviceName&lt;/span>); &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#66d9ef">nil&lt;/span> {
&lt;span style="color:#a6e22e">log&lt;/span>.&lt;span style="color:#a6e22e">Fatalln&lt;/span>(&lt;span style="color:#a6e22e">err&lt;/span>)
}
&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">fsResize&lt;/span>(&lt;span style="color:#a6e22e">disk&lt;/span>.&lt;span style="color:#a6e22e">FsType&lt;/span>, &lt;span style="color:#a6e22e">disk&lt;/span>.&lt;span style="color:#a6e22e">MountPoint&lt;/span>, &lt;span style="color:#a6e22e">disk&lt;/span>.&lt;span style="color:#a6e22e">DeviceName&lt;/span>); &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#66d9ef">nil&lt;/span> {
&lt;span style="color:#a6e22e">log&lt;/span>.&lt;span style="color:#a6e22e">Fatalln&lt;/span>(&lt;span style="color:#a6e22e">err&lt;/span>)
}
}
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>–ß–µ—Ä–µ–∑ –¥–µ–∫—ñ–ª—å–∫–∞ —Å–µ–∫—É–Ω–¥ –¥–∏—Å–∫ –º–∞—î –Ω–æ–≤–∏–π —Ä–æ–∑–º—ñ—Ä.&lt;/p></content></item><item><title>Failed Asg Event Notification</title><link>/ua/2021/01/03/failed-asg-event-notification/</link><pubDate>Sun, 03 Jan 2021 17:57:36 +0200</pubDate><guid>/ua/2021/01/03/failed-asg-event-notification/</guid><description>–ü—Ä–∏–≤—ñ—Ç!
–°—å–æ–≥–æ–¥–Ω—ñ —Ö–æ—á—É —Ä–æ–∑–∫–∞–∑–∞—Ç–∏ —è–∫ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é AWS Lambda —Ç–∞ Golang –º–æ–∂–Ω–∞ –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤ slack –∫–æ–ª–∏ Autoscaling –Ω–µ –∑–º—ñ–≥ —Å—Ç–≤–æ—Ä–∏—Ç–∏ Ec2 —Å–µ—Ä–≤–µ—Ä. –î–µ–ø–ª–æ–π —è –∞–≤—Ç–æ–º–∞—Ç–∏–∑—É—é –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é serverless.
–ü–æ—á–Ω–µ–º–æ –∑ —ñ–Ω—Å—Ç–∞–ª—è—Ü—ñ—é node —Ç–∞ serverless. –Ø –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é nvm –¥–ª—è —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –≤–µ—Ä—Å—ñ—è–º–∏ node.
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.37.2/install.sh | bash nvm install v14.15.3 npm install -g serverless –°—Ç–≤–æ—Ä—é –ø–∞–ø–∫—É —Ç–∞ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—é –≤ –Ω—ñ–π go –º–æ–¥—É–ª—å.
mkdir failed-asg cd failed-asg go mod init touch main.</description><content>&lt;p>–ü—Ä–∏–≤—ñ—Ç!&lt;/p>
&lt;p>–°—å–æ–≥–æ–¥–Ω—ñ —Ö–æ—á—É —Ä–æ–∑–∫–∞–∑–∞—Ç–∏ —è–∫ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é AWS Lambda —Ç–∞ Golang –º–æ–∂–Ω–∞ –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤ slack –∫–æ–ª–∏ Autoscaling –Ω–µ –∑–º—ñ–≥ —Å—Ç–≤–æ—Ä–∏—Ç–∏ Ec2 —Å–µ—Ä–≤–µ—Ä. –î–µ–ø–ª–æ–π —è –∞–≤—Ç–æ–º–∞—Ç–∏–∑—É—é –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é serverless.&lt;/p>
&lt;p>–ü–æ—á–Ω–µ–º–æ –∑ —ñ–Ω—Å—Ç–∞–ª—è—Ü—ñ—é node —Ç–∞ serverless. –Ø –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é &lt;a href="https://github.com/nvm-sh/nvm#install--update-script">nvm&lt;/a> –¥–ª—è —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –≤–µ—Ä—Å—ñ—è–º–∏ node.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-shell" data-lang="shell">curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.37.2/install.sh | bash
nvm install v14.15.3
npm install -g serverless
&lt;/code>&lt;/pre>&lt;/div>&lt;p>–°—Ç–≤–æ—Ä—é –ø–∞–ø–∫—É —Ç–∞ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—é –≤ –Ω—ñ–π go –º–æ–¥—É–ª—å.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-shell" data-lang="shell">mkdir failed-asg
cd failed-asg
go mod init
touch main.go
&lt;/code>&lt;/pre>&lt;/div>&lt;p>–ù–∞ –ø–æ—á–∞—Ç–∫—É –±—É–¥–µ package, —ñ–º–ø–æ—Ä—Ç–∏ —Ç–∞ main. Main –±—É–¥–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–∞ –∑–∞ –∑–∞–ø—É—Å–∫ handler —Ñ—É–Ω–∫—Ü—ñ—ó.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-golang" data-lang="golang">&lt;span style="color:#f92672">package&lt;/span> &lt;span style="color:#a6e22e">main&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> (
&lt;span style="color:#e6db74">&amp;#34;bytes&amp;#34;&lt;/span>
&lt;span style="color:#e6db74">&amp;#34;context&amp;#34;&lt;/span>
&lt;span style="color:#e6db74">&amp;#34;encoding/json&amp;#34;&lt;/span>
&lt;span style="color:#e6db74">&amp;#34;errors&amp;#34;&lt;/span>
&lt;span style="color:#e6db74">&amp;#34;fmt&amp;#34;&lt;/span>
&lt;span style="color:#e6db74">&amp;#34;io/ioutil&amp;#34;&lt;/span>
&lt;span style="color:#e6db74">&amp;#34;log&amp;#34;&lt;/span>
&lt;span style="color:#e6db74">&amp;#34;net/http&amp;#34;&lt;/span>
&lt;span style="color:#e6db74">&amp;#34;strings&amp;#34;&lt;/span>
&lt;span style="color:#e6db74">&amp;#34;github.com/aws/aws-lambda-go/events&amp;#34;&lt;/span>
&lt;span style="color:#e6db74">&amp;#34;github.com/aws/aws-lambda-go/lambda&amp;#34;&lt;/span>
)
&lt;span style="color:#66d9ef">func&lt;/span> &lt;span style="color:#a6e22e">main&lt;/span>() {
&lt;span style="color:#a6e22e">lambda&lt;/span>.&lt;span style="color:#a6e22e">Start&lt;/span>(&lt;span style="color:#a6e22e">handleRequest&lt;/span>)
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>–û—Å–Ω–æ–≤–Ω–æ—é —Ñ—É–Ω–∫—Ü—ñ—î—é –±—É–¥–µ handleRequest. –í –Ω—ñ–π —Å—Ñ–æ—Ä–º—É—î—Ç—å—Å—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –Ω–∞ –æ—Å–Ω–æ–≤—ñ &lt;code>AutoScalingEvent&lt;/code> —ñ –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç—å—Å—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤ slack.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-go" data-lang="go">&lt;span style="color:#66d9ef">func&lt;/span> &lt;span style="color:#a6e22e">handleRequest&lt;/span>(&lt;span style="color:#a6e22e">ctx&lt;/span> &lt;span style="color:#a6e22e">context&lt;/span>.&lt;span style="color:#a6e22e">Context&lt;/span>, &lt;span style="color:#a6e22e">event&lt;/span> &lt;span style="color:#a6e22e">events&lt;/span>.&lt;span style="color:#a6e22e">AutoScalingEvent&lt;/span>) (&lt;span style="color:#66d9ef">string&lt;/span>, &lt;span style="color:#66d9ef">error&lt;/span>) {
&lt;span style="color:#a6e22e">url&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;https://hooks.slack.com/services/token&amp;#34;&lt;/span>
&lt;span style="color:#66d9ef">var&lt;/span> &lt;span style="color:#a6e22e">sb&lt;/span> &lt;span style="color:#a6e22e">strings&lt;/span>.&lt;span style="color:#a6e22e">Builder&lt;/span>
&lt;span style="color:#a6e22e">sb&lt;/span>.&lt;span style="color:#a6e22e">WriteString&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;:siren: *EC2 Instance Launch Unsuccessful* :siren:\n&amp;#34;&lt;/span>)
&lt;span style="color:#a6e22e">sb&lt;/span>.&lt;span style="color:#a6e22e">WriteString&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;*Autoscaling Group Name*:&amp;#34;&lt;/span>)
&lt;span style="color:#a6e22e">sb&lt;/span>.&lt;span style="color:#a6e22e">WriteString&lt;/span>(&lt;span style="color:#a6e22e">event&lt;/span>.&lt;span style="color:#a6e22e">Detail&lt;/span>[&lt;span style="color:#e6db74">&amp;#34;AutoScalingGroupName&amp;#34;&lt;/span>].(&lt;span style="color:#66d9ef">string&lt;/span>))
&lt;span style="color:#a6e22e">sb&lt;/span>.&lt;span style="color:#a6e22e">WriteString&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;\n&amp;#34;&lt;/span>)
&lt;span style="color:#a6e22e">sb&lt;/span>.&lt;span style="color:#a6e22e">WriteString&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;*StatusMessage*:&amp;#34;&lt;/span>)
&lt;span style="color:#a6e22e">sb&lt;/span>.&lt;span style="color:#a6e22e">WriteString&lt;/span>(&lt;span style="color:#a6e22e">event&lt;/span>.&lt;span style="color:#a6e22e">Detail&lt;/span>[&lt;span style="color:#e6db74">&amp;#34;StatusMessage&amp;#34;&lt;/span>].(&lt;span style="color:#66d9ef">string&lt;/span>))
&lt;span style="color:#a6e22e">sb&lt;/span>.&lt;span style="color:#a6e22e">WriteString&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;\n&amp;#34;&lt;/span>)
&lt;span style="color:#a6e22e">payload&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#66d9ef">map&lt;/span>[&lt;span style="color:#66d9ef">string&lt;/span>]&lt;span style="color:#66d9ef">interface&lt;/span>{}{
&lt;span style="color:#e6db74">&amp;#34;username&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;ASGFailedEvents&amp;#34;&lt;/span>,
&lt;span style="color:#e6db74">&amp;#34;channel&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;#test-db-alerts&amp;#34;&lt;/span>,
&lt;span style="color:#e6db74">&amp;#34;text&amp;#34;&lt;/span>: &lt;span style="color:#a6e22e">sb&lt;/span>.&lt;span style="color:#a6e22e">String&lt;/span>(),
}
&lt;span style="color:#a6e22e">_&lt;/span>, &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">SendSlackNotification&lt;/span>(&lt;span style="color:#a6e22e">url&lt;/span>, &lt;span style="color:#a6e22e">payload&lt;/span>)
&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#66d9ef">nil&lt;/span> {
&lt;span style="color:#a6e22e">log&lt;/span>.&lt;span style="color:#a6e22e">Fatalln&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;Not able to send slack message&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">err&lt;/span>)
}
&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">sb&lt;/span>.&lt;span style="color:#a6e22e">String&lt;/span>(), &lt;span style="color:#66d9ef">nil&lt;/span>
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Url –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–∞–º—ñ–Ω–∏—Ç–∏ –Ω–∞ –∑–Ω–∞—á–µ–Ω–Ω—è —Å–≤–æ–≥–æ Slack Webhook.&lt;br>
–ó–∞ –¥–æ–ø–æ–º–æ–≥–æ—é &lt;code>strings.Builder&lt;/code> —è —Ñ–æ—Ä–º—É—é –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —è–∫–µ –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç—å—Å—è, –¥–æ–±–∞–≤–ª—é –≤ –Ω—å–æ–≥–æ –Ω–∞–∑–≤—É AutoScalingGroup —Ç–∞ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∑ –ø–æ–º–∏–ª–∫–æ—é. –¢–æ–¥—ñ —Ñ–æ—Ä–º—É—é &lt;code>payload&lt;/code> –≤ —è–∫–æ–º—É –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∫–∞–∑–∞—Ç–∏ –Ω–∞–∑–≤—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –≤—ñ–¥ —è–∫–æ–≥–æ –±—É–¥–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è, –∫–∞–Ω–∞–ª —ñ —Å–∞–º text –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —Ç–∞ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é &lt;code>SendSlackNotification&lt;/code> –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç—å—Å—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤ slack.&lt;/p>
&lt;p>–ü–µ—Ä–µ–π–¥–µ–º–æ –¥–æ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –º–µ—Ç–æ–¥–∞ &lt;code>SendSlackNotification&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-go" data-lang="go">&lt;span style="color:#66d9ef">func&lt;/span> &lt;span style="color:#a6e22e">SendSlackNotification&lt;/span>(&lt;span style="color:#a6e22e">url&lt;/span> &lt;span style="color:#66d9ef">string&lt;/span>, &lt;span style="color:#a6e22e">data&lt;/span> &lt;span style="color:#66d9ef">interface&lt;/span>{}) (&lt;span style="color:#a6e22e">bodyString&lt;/span> &lt;span style="color:#66d9ef">string&lt;/span>, &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#66d9ef">error&lt;/span>) {
&lt;span style="color:#a6e22e">jsonString&lt;/span>, &lt;span style="color:#a6e22e">_&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">json&lt;/span>.&lt;span style="color:#a6e22e">Marshal&lt;/span>(&lt;span style="color:#a6e22e">data&lt;/span>)
&lt;span style="color:#a6e22e">req&lt;/span>, &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">http&lt;/span>.&lt;span style="color:#a6e22e">NewRequest&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;POST&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">url&lt;/span>, &lt;span style="color:#a6e22e">bytes&lt;/span>.&lt;span style="color:#a6e22e">NewBuffer&lt;/span>(&lt;span style="color:#a6e22e">jsonString&lt;/span>))
&lt;span style="color:#a6e22e">req&lt;/span>.&lt;span style="color:#a6e22e">Header&lt;/span>.&lt;span style="color:#a6e22e">Set&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;Content-Type&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;application/json&amp;#34;&lt;/span>)
&lt;span style="color:#a6e22e">client&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#f92672">&amp;amp;&lt;/span>&lt;span style="color:#a6e22e">http&lt;/span>.&lt;span style="color:#a6e22e">Client&lt;/span>{}
&lt;span style="color:#a6e22e">resp&lt;/span>, &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">client&lt;/span>.&lt;span style="color:#a6e22e">Do&lt;/span>(&lt;span style="color:#a6e22e">req&lt;/span>)
&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#66d9ef">nil&lt;/span> {
panic(&lt;span style="color:#a6e22e">err&lt;/span>)
}
&lt;span style="color:#66d9ef">defer&lt;/span> &lt;span style="color:#a6e22e">resp&lt;/span>.&lt;span style="color:#a6e22e">Body&lt;/span>.&lt;span style="color:#a6e22e">Close&lt;/span>()
&lt;span style="color:#a6e22e">body&lt;/span>, &lt;span style="color:#a6e22e">_&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">ioutil&lt;/span>.&lt;span style="color:#a6e22e">ReadAll&lt;/span>(&lt;span style="color:#a6e22e">resp&lt;/span>.&lt;span style="color:#a6e22e">Body&lt;/span>)
&lt;span style="color:#a6e22e">bodyString&lt;/span> = string(&lt;span style="color:#a6e22e">body&lt;/span>)
&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">resp&lt;/span>.&lt;span style="color:#a6e22e">StatusCode&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#ae81ff">200&lt;/span> {
&lt;span style="color:#a6e22e">fmt&lt;/span>.&lt;span style="color:#a6e22e">Println&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;Response Status:&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">resp&lt;/span>.&lt;span style="color:#a6e22e">Status&lt;/span>) &lt;span style="color:#75715e">// 200 OK
&lt;/span>&lt;span style="color:#75715e">&lt;/span> &lt;span style="color:#a6e22e">fmt&lt;/span>.&lt;span style="color:#a6e22e">Println&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;Response Headers:&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">resp&lt;/span>.&lt;span style="color:#a6e22e">Header&lt;/span>)
&lt;span style="color:#a6e22e">fmt&lt;/span>.&lt;span style="color:#a6e22e">Println&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;Response Body:&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">bodyString&lt;/span>)
&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">bodyString&lt;/span>, &lt;span style="color:#a6e22e">errors&lt;/span>.&lt;span style="color:#a6e22e">New&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;can&amp;#39;t work with 42&amp;#34;&lt;/span>)
}
&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">bodyString&lt;/span>, &lt;span style="color:#66d9ef">nil&lt;/span>
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>–¢—É—Ç —Ñ–æ—Ä–º—É—î—Ç—å—Å—è json –∑ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–≥–æ —Å—Ç–≤–æ—Ä–µ–Ω–æ–≥–æ &lt;code>payload&lt;/code> —Ç–∞ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é http –∑–¥—ñ–π—Å–Ω—é—î—Ç—å—Å—è —Ä–µ–∫–≤–µ—Å—Ç –¥–æ Webhook Url —Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä—è—î—Ç—å—Å—è —á–∏ —Ä–µ–∫–≤–µ—Å—Ç –±—É–≤ —É—Å–ø—ñ—â–æ–Ω–æ –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–∏–π.&lt;/p>
&lt;p>–ü–æ–≤–µ—Ä–Ω–µ–º–æ—Å—å –¥–æ serverless –¥–ª—è –¥–µ–ø–ª–æ—é –ª—è–º–±–¥–∏.&lt;br>
–í –∫–æ—Ä–µ–Ω—ñ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—è —Å—Ç–≤–æ—Ä—é —Ñ–∞–π–ª serverless.yml –∑ –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-yml" data-lang="yml">&lt;span style="color:#f92672">service&lt;/span>: &lt;span style="color:#ae81ff">asg-failed-events&lt;/span>
&lt;span style="color:#f92672">provider&lt;/span>:
&lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">aws&lt;/span>
&lt;span style="color:#f92672">runtime&lt;/span>: &lt;span style="color:#ae81ff">go1.x&lt;/span>
&lt;span style="color:#f92672">package&lt;/span>:
&lt;span style="color:#f92672">exclude&lt;/span>:
- &lt;span style="color:#ae81ff">./**&lt;/span>
&lt;span style="color:#f92672">include&lt;/span>:
- &lt;span style="color:#ae81ff">./bin/**&lt;/span>
&lt;span style="color:#f92672">functions&lt;/span>:
&lt;span style="color:#f92672">lambda-time&lt;/span>:
&lt;span style="color:#f92672">handler&lt;/span>: &lt;span style="color:#ae81ff">bin/failed-asg-event-notification&lt;/span>
&lt;span style="color:#f92672">events&lt;/span>:
- &lt;span style="color:#f92672">cloudwatchEvent&lt;/span>:
&lt;span style="color:#f92672">event&lt;/span>:
&lt;span style="color:#f92672">source&lt;/span>:
- &lt;span style="color:#e6db74">&amp;#34;aws.autoscaling&amp;#34;&lt;/span>
&lt;span style="color:#f92672">detail-type&lt;/span>:
- &lt;span style="color:#e6db74">&amp;#34;EC2 Instance Launch Unsuccessful&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>–¢—É—Ç –æ–ø–∏—Å—É—î—Ç—å—Å—è –Ω–∞–∑–≤–∞ –ª—è–º–±–¥–∏ —è–∫–∞ –±—É–¥–µ —Å—Ç–≤–æ—Ä–µ–Ω–∞ —Ç–∞ —â–æ –±—É–¥–µ —Ç—Ä–∏–≥–µ—Ä–∏—Ç–∏ —ó—ó, –≤ —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É —Ü–µ &lt;code>EC2 Instance Launch Unsuccessful&lt;/code> —ñ–≤–µ–Ω—Ç –≤—ñ–¥ &lt;code>aws.autoscaling&lt;/code>.&lt;/p>
&lt;p>–¢–µ–ø–µ—Ä –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –≤—Å—ñ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ, —Å–∫–æ–º–ø—ñ–ª—é–≤–∞—Ç–∏ –∫–æ–¥ —Ç–∞ –∑–∞–¥–µ–ø–ª–æ—ó—Ç–∏.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-shell" data-lang="shell">go mod tidy
OOS&lt;span style="color:#f92672">=&lt;/span>linux GOARCH&lt;span style="color:#f92672">=&lt;/span>amd64 go build -o bin/failed-asg-event-notification .
sls deploy
&lt;/code>&lt;/pre>&lt;/div>&lt;p>–ü—ñ—Å–ª—è —Ü—å–æ–≥–æ —è–∫—â–æ –≤—ñ–¥–±—É–¥–µ—Ç—å—Å—è —ñ–≤–µ–Ω—Ç —Ç–∏–ø—É &lt;code>EC2 Instance Launch Unsuccessful&lt;/code> –≤—ñ–¥ &lt;code>aws.autoscaling&amp;quot;&lt;/code> –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –±—É–¥–µ –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ slack.&lt;/p></content></item><item><title>Import Grafana Dashboards With Go</title><link>/ua/2020/12/23/import-grafana-dashboards-with-go/</link><pubDate>Wed, 23 Dec 2020 23:18:28 +0200</pubDate><guid>/ua/2020/12/23/import-grafana-dashboards-with-go/</guid><description>–ü—Ä–∏–≤—ñ—Ç!
–í –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–º—É –ø–æ—Å—Ç—ñ —è –ø–æ–∫–∞–∑—É–≤–∞–≤ —è–∫ –º–æ–∂–Ω–∞ –µ–∫—Å–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ –¥–∞—à–±–æ—Ä–¥–∏ –∑ Grafana. –¢–µ–ø–µ—Ä –ø–æ–¥–∏–≤–∏–º–æ—Å—å —è–∫ —ó—Ö –º–æ–∂–Ω–∞ —ñ–º–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ –≤ Grafana.
–Ø–∫ –∑–∞–≤–∂–¥–∏ –Ω–∞ –ø–æ—á–∞—Ç–∫—É –±—É–¥—É—Ç—å —ñ–º–ø–æ—Ä—Ç–∏ —Ç–∞ main —Ñ—É–Ω–∫—Ü—ñ—è
package grafana import ( &amp;#34;context&amp;#34; &amp;#34;encoding/json&amp;#34; &amp;#34;fmt&amp;#34; &amp;#34;io/ioutil&amp;#34; &amp;#34;log&amp;#34; &amp;#34;os&amp;#34; &amp;#34;strings&amp;#34; &amp;#34;github.com/grafana-tools/sdk&amp;#34; ) func main() { } –î–æ–¥–∞–º–æ –¥–µ–∫—ñ–ª—å–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤:
var ( filesInDir []os.FileInfo rawBoard []byte err error grafanaURL string apiKey string directory string ) –í filesInDir –±—É–¥—É—Ç—å –∑–±–µ—Ä—ñ–≥–∞—Ç–∏—Å—å —É—Å—ñ –ø—Ä–æ—á–∏—Ç–∞–Ω—ñ –¥–∞—à–±–æ—Ä–¥–∏ –∑ —Ñ–∞–π–ª–æ–≤–æ—ó —Å–∏—Å—Ç–µ–º–∏.</description><content>&lt;p>–ü—Ä–∏–≤—ñ—Ç!&lt;/p>
&lt;p>–í –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–º—É &lt;a href="/ua/2020/12/19/export-grafana-dashboards-with-go/" title="–ø–æ—Å—Ç—ñ">–ø–æ—Å—Ç—ñ&lt;/a> —è –ø–æ–∫–∞–∑—É–≤–∞–≤ —è–∫ –º–æ–∂–Ω–∞ –µ–∫—Å–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ –¥–∞—à–±–æ—Ä–¥–∏ –∑ Grafana. –¢–µ–ø–µ—Ä –ø–æ–¥–∏–≤–∏–º–æ—Å—å —è–∫ —ó—Ö –º–æ–∂–Ω–∞ —ñ–º–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ –≤ Grafana.&lt;/p>
&lt;p>–Ø–∫ –∑–∞–≤–∂–¥–∏ –Ω–∞ –ø–æ—á–∞—Ç–∫—É –±—É–¥—É—Ç—å —ñ–º–ø–æ—Ä—Ç–∏ —Ç–∞ main —Ñ—É–Ω–∫—Ü—ñ—è&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-go" data-lang="go">&lt;span style="color:#f92672">package&lt;/span> &lt;span style="color:#a6e22e">grafana&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> (
&lt;span style="color:#e6db74">&amp;#34;context&amp;#34;&lt;/span>
&lt;span style="color:#e6db74">&amp;#34;encoding/json&amp;#34;&lt;/span>
&lt;span style="color:#e6db74">&amp;#34;fmt&amp;#34;&lt;/span>
&lt;span style="color:#e6db74">&amp;#34;io/ioutil&amp;#34;&lt;/span>
&lt;span style="color:#e6db74">&amp;#34;log&amp;#34;&lt;/span>
&lt;span style="color:#e6db74">&amp;#34;os&amp;#34;&lt;/span>
&lt;span style="color:#e6db74">&amp;#34;strings&amp;#34;&lt;/span>
&lt;span style="color:#e6db74">&amp;#34;github.com/grafana-tools/sdk&amp;#34;&lt;/span>
)
&lt;span style="color:#66d9ef">func&lt;/span> &lt;span style="color:#a6e22e">main&lt;/span>() {
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>–î–æ–¥–∞–º–æ –¥–µ–∫—ñ–ª—å–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-go" data-lang="go"> &lt;span style="color:#66d9ef">var&lt;/span> (
&lt;span style="color:#a6e22e">filesInDir&lt;/span> []&lt;span style="color:#a6e22e">os&lt;/span>.&lt;span style="color:#a6e22e">FileInfo&lt;/span>
&lt;span style="color:#a6e22e">rawBoard&lt;/span> []&lt;span style="color:#66d9ef">byte&lt;/span>
&lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#66d9ef">error&lt;/span>
&lt;span style="color:#a6e22e">grafanaURL&lt;/span> &lt;span style="color:#66d9ef">string&lt;/span>
&lt;span style="color:#a6e22e">apiKey&lt;/span> &lt;span style="color:#66d9ef">string&lt;/span>
&lt;span style="color:#a6e22e">directory&lt;/span> &lt;span style="color:#66d9ef">string&lt;/span>
)
&lt;/code>&lt;/pre>&lt;/div>&lt;p>–í &lt;code>filesInDir&lt;/code> –±—É–¥—É—Ç—å –∑–±–µ—Ä—ñ–≥–∞—Ç–∏—Å—å —É—Å—ñ –ø—Ä–æ—á–∏—Ç–∞–Ω—ñ –¥–∞—à–±–æ—Ä–¥–∏ –∑ —Ñ–∞–π–ª–æ–≤–æ—ó —Å–∏—Å—Ç–µ–º–∏. –ê –≤ &lt;code>rawBoard&lt;/code> –±—É–¥–µ –º—ñ—Å—Ç–∏—Ç–∏—Å—å —Å–∞–º –∫–æ–Ω—Ç–µ–Ω—Ç —Ñ–∞–π–ª—ñ–≤. &lt;code>directory&lt;/code> –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—è –≤ —è–∫—É –±—É–¥—É—Ç—å –∑–±–µ—Ä—ñ–≥–∞—Ç–∏—Å—å –¥–∞—à–±–æ—Ä–¥–∏. &lt;code>grafanaURL&lt;/code> - Grafana url –∑ –ø–æ—Ä—Ç–æ–º –≤ —Ñ–æ—Ä–º–∞—Ç—ñ &lt;code>http://127.0.0.1:3030&lt;/code> —Ç–∞ &lt;code>apiKey&lt;/code> –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó –≤ Grafana. –í grafanaUR, apiKey —Ç–∞ directory –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–Ω–µ—Å—Ç–∏ —Å–≤–æ—î –∑–Ω–∞—á–µ–Ω–Ω—è.&lt;/p>
&lt;p>–°—Ç–≤–æ—Ä—é—é Grafana –∫–ª—ñ—î–Ω—Ç –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —è–∫–æ–≥–æ –±—É–¥—É —Ä–æ–±–∏—Ç–∏ –∑–∞–ø–∏—Ç–∏ –¥–æ Grafana Api&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-go" data-lang="go"> &lt;span style="color:#a6e22e">ctx&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">context&lt;/span>.&lt;span style="color:#a6e22e">Background&lt;/span>()
&lt;span style="color:#a6e22e">c&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">sdk&lt;/span>.&lt;span style="color:#a6e22e">NewClient&lt;/span>(&lt;span style="color:#a6e22e">grafanaURL&lt;/span>, &lt;span style="color:#a6e22e">apiKey&lt;/span>, &lt;span style="color:#a6e22e">sdk&lt;/span>.&lt;span style="color:#a6e22e">DefaultHTTPClient&lt;/span>)
&lt;/code>&lt;/pre>&lt;/div>&lt;p>–ó–∞–ª–∏—à–∏–ª–æ—Å—å –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —Ñ–∞–π–ª–∏ —ñ –º–æ–∂–Ω–∞ —ó—Ö –µ–∫—Å–ø–æ—Ä—Ç—É–≤–∞—Ç–∏.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-go" data-lang="go"> &lt;span style="color:#a6e22e">filesInDir&lt;/span>, &lt;span style="color:#a6e22e">err&lt;/span> = &lt;span style="color:#a6e22e">ioutil&lt;/span>.&lt;span style="color:#a6e22e">ReadDir&lt;/span>(&lt;span style="color:#a6e22e">directory&lt;/span>)
&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#66d9ef">nil&lt;/span> {
&lt;span style="color:#a6e22e">log&lt;/span>.&lt;span style="color:#a6e22e">Fatal&lt;/span>(&lt;span style="color:#a6e22e">err&lt;/span>)
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>–¢–µ–ø–µ—Ä —Ü–∏–∫–ª–æ–º –π–¥—É –ø–æ —É—Å—ñ—Ö —Ñ–∞–π–ª–∞—Ö. –ê–ª–µ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó —è–∫—É —è —á–∏—Ç–∞—é –º–æ–∂—É—Ç—å –±—É—Ç–∏ —ñ–Ω—à—ñ–π —Ñ–∞–π–ª–∏ –æ–∫—Ä—ñ–º .json —Ç–æ–º—É –±—É–¥—É –ø–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏ —á–∏ –Ω–∞–∑–≤–∞ —Ñ–∞–π–ª—É –∑–∞–∫—ñ–Ω—á—É—î—Ç—å—Å—è –Ω–∞ .json. –Ø–∫—â–æ —Ñ–∞–π–ª –≤—Å–µ —Ç–∞–∫–∏ json –∑–∞–ø–∏—Å—É—é –π–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç –≤ &lt;code>rawBoard&lt;/code>. –Ü –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—é —Ü–µ–π —Ñ–∞–π–ª –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä—É &lt;code>sdk.Board&lt;/code>. –¢–∞–∫–æ–∂ —Å—Ç–≤–æ—Ä—é—é –æ–±&amp;rsquo;—î–∫—Ç —Ç–∏–ø—É sdk.SetDashboardParams –≤ —è–∫–æ–º—É –≤–∫–∞–∑—É—é –≤ —è–∫—É –ø–∞–ø–∫—É —ñ–º–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ –¥–∞—à–±–æ—Ä–¥ —Ç–∞ —á–∏ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç–∏ —è–∫—â–æ —Ç–∞–∫–∏–π –¥–∞—à–±–æ—Ä–¥ –≤–∂–µ —ñ—Å–Ω—É—î. –ö–æ–ª–∏ –≤—Å—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –≥–æ—Ç–æ–≤—ñ –≤–∏–∫–ª–∏–∫–∞—é –º–µ—Ç–æ–¥ SetDashboard —è–∫–∏–π —ñ –∑–¥—ñ–π—Å–Ω–∏—Ç—å –µ–∫—Å–ø–æ—Ä—Ç.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-go" data-lang="go"> &lt;span style="color:#66d9ef">for&lt;/span> &lt;span style="color:#a6e22e">_&lt;/span>, &lt;span style="color:#a6e22e">file&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#66d9ef">range&lt;/span> &lt;span style="color:#a6e22e">filesInDir&lt;/span> {
&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">strings&lt;/span>.&lt;span style="color:#a6e22e">HasSuffix&lt;/span>(&lt;span style="color:#a6e22e">file&lt;/span>.&lt;span style="color:#a6e22e">Name&lt;/span>(), &lt;span style="color:#e6db74">&amp;#34;.json&amp;#34;&lt;/span>) {
&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">rawBoard&lt;/span>, &lt;span style="color:#a6e22e">err&lt;/span> = &lt;span style="color:#a6e22e">ioutil&lt;/span>.&lt;span style="color:#a6e22e">ReadFile&lt;/span>(&lt;span style="color:#a6e22e">fmt&lt;/span>.&lt;span style="color:#a6e22e">Sprintf&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;%s/%s&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">directory&lt;/span>, &lt;span style="color:#a6e22e">file&lt;/span>.&lt;span style="color:#a6e22e">Name&lt;/span>())); &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#66d9ef">nil&lt;/span> {
&lt;span style="color:#a6e22e">log&lt;/span>.&lt;span style="color:#a6e22e">Println&lt;/span>(&lt;span style="color:#a6e22e">err&lt;/span>)
&lt;span style="color:#66d9ef">continue&lt;/span>
}
&lt;span style="color:#66d9ef">var&lt;/span> &lt;span style="color:#a6e22e">board&lt;/span> &lt;span style="color:#a6e22e">sdk&lt;/span>.&lt;span style="color:#a6e22e">Board&lt;/span>
&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">err&lt;/span> = &lt;span style="color:#a6e22e">json&lt;/span>.&lt;span style="color:#a6e22e">Unmarshal&lt;/span>(&lt;span style="color:#a6e22e">rawBoard&lt;/span>, &lt;span style="color:#f92672">&amp;amp;&lt;/span>&lt;span style="color:#a6e22e">board&lt;/span>); &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#66d9ef">nil&lt;/span> {
&lt;span style="color:#a6e22e">log&lt;/span>.&lt;span style="color:#a6e22e">Println&lt;/span>(&lt;span style="color:#a6e22e">err&lt;/span>)
&lt;span style="color:#66d9ef">continue&lt;/span>
}
&lt;span style="color:#a6e22e">params&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">sdk&lt;/span>.&lt;span style="color:#a6e22e">SetDashboardParams&lt;/span>{
&lt;span style="color:#a6e22e">FolderID&lt;/span>: &lt;span style="color:#a6e22e">sdk&lt;/span>.&lt;span style="color:#a6e22e">DefaultFolderId&lt;/span>,
&lt;span style="color:#a6e22e">Overwrite&lt;/span>: &lt;span style="color:#66d9ef">true&lt;/span>,
}
&lt;span style="color:#a6e22e">_&lt;/span>, &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">c&lt;/span>.&lt;span style="color:#a6e22e">SetDashboard&lt;/span>(&lt;span style="color:#a6e22e">ctx&lt;/span>, &lt;span style="color:#a6e22e">board&lt;/span>, &lt;span style="color:#a6e22e">params&lt;/span>)
&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#66d9ef">nil&lt;/span> {
&lt;span style="color:#a6e22e">log&lt;/span>.&lt;span style="color:#a6e22e">Printf&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;error on importing dashboard %s&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">board&lt;/span>.&lt;span style="color:#a6e22e">Title&lt;/span>)
&lt;span style="color:#66d9ef">continue&lt;/span>
}
}
}
&lt;/code>&lt;/pre>&lt;/div></content></item><item><title>Export Grafana Dashboards With Go</title><link>/ua/2020/12/19/export-grafana-dashboards-with-go/</link><pubDate>Sat, 19 Dec 2020 18:27:35 +0200</pubDate><guid>/ua/2020/12/19/export-grafana-dashboards-with-go/</guid><description>–ü—Ä–∏–≤—ñ—Ç!
–°—å–æ–≥–æ–¥–Ω—ñ –ø–æ–¥–∏–≤–∏–º–æ—Å—å —è–∫ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é go –º–æ–∂–Ω–∞ –µ–∫—Å–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ –¥–∞—à–±–æ—Ä–¥–∏ –∑ Grafana. –î–ª—è –≤–∑–∞—î–º–æ–¥—ñ—ó –∑ Grafana —è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—é sdk. Sdk –º–æ–∂–Ω–∞ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é go get github.com/grafana-tools/sdk.
–ü–æ—á–Ω–µ–º–æ –ø–∏—Å–∞—Ç–∏ –∫–æ–¥. –ù–∞ –ø–æ—á–∞—Ç–∫—É —Ñ–∞–π–ª—É –±—É–¥–µ package, —ñ–º–ø–æ—Ä—Ç–∏ —Ç–∞ main —Ñ—É–Ω–∫—Ü—ñ—è
package main import ( &amp;#34;context&amp;#34; &amp;#34;encoding/json&amp;#34; &amp;#34;fmt&amp;#34; &amp;#34;log&amp;#34; &amp;#34;os&amp;#34; &amp;#34;github.com/grafana-tools/sdk&amp;#34; ) func main() { } ) –î–æ–¥–∞–º–æ –¥–µ–∫—ñ–ª—å–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤:
var ( boardLinks []sdk.FoundBoard rawBoard sdk.Board meta sdk.BoardProperties err error grafanaURL string apiKey string directory string ) –í boardLinks –±—É–¥—É—Ç—å –¥–æ–±–∞–≤–ª—è—Ç–∏—Å—å —Å—Å–∏–ª–∫–∏ –Ω–∞ –¥–∞—à–±–æ—Ä–¥–∏ –≤ Grafana.</description><content>&lt;p>–ü—Ä–∏–≤—ñ—Ç!&lt;/p>
&lt;p>–°—å–æ–≥–æ–¥–Ω—ñ –ø–æ–¥–∏–≤–∏–º–æ—Å—å —è–∫ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é go –º–æ–∂–Ω–∞ –µ–∫—Å–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ –¥–∞—à–±–æ—Ä–¥–∏ –∑ Grafana.
–î–ª—è –≤–∑–∞—î–º–æ–¥—ñ—ó –∑ Grafana —è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—é &lt;a href="https://github.com/grafana-tools/sdk">sdk&lt;/a>. Sdk –º–æ–∂–Ω–∞ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é &lt;code>go get github.com/grafana-tools/sdk&lt;/code>.&lt;/p>
&lt;p>–ü–æ—á–Ω–µ–º–æ –ø–∏—Å–∞—Ç–∏ –∫–æ–¥. –ù–∞ –ø–æ—á–∞—Ç–∫—É —Ñ–∞–π–ª—É –±—É–¥–µ package, —ñ–º–ø–æ—Ä—Ç–∏ —Ç–∞ main —Ñ—É–Ω–∫—Ü—ñ—è&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-go" data-lang="go">&lt;span style="color:#f92672">package&lt;/span> &lt;span style="color:#a6e22e">main&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> (
&lt;span style="color:#e6db74">&amp;#34;context&amp;#34;&lt;/span>
&lt;span style="color:#e6db74">&amp;#34;encoding/json&amp;#34;&lt;/span>
&lt;span style="color:#e6db74">&amp;#34;fmt&amp;#34;&lt;/span>
&lt;span style="color:#e6db74">&amp;#34;log&amp;#34;&lt;/span>
&lt;span style="color:#e6db74">&amp;#34;os&amp;#34;&lt;/span>
&lt;span style="color:#e6db74">&amp;#34;github.com/grafana-tools/sdk&amp;#34;&lt;/span>
)
&lt;span style="color:#66d9ef">func&lt;/span> &lt;span style="color:#a6e22e">main&lt;/span>() {
}
)
&lt;/code>&lt;/pre>&lt;/div>&lt;p>–î–æ–¥–∞–º–æ –¥–µ–∫—ñ–ª—å–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-go" data-lang="go"> &lt;span style="color:#66d9ef">var&lt;/span> (
&lt;span style="color:#a6e22e">boardLinks&lt;/span> []&lt;span style="color:#a6e22e">sdk&lt;/span>.&lt;span style="color:#a6e22e">FoundBoard&lt;/span>
&lt;span style="color:#a6e22e">rawBoard&lt;/span> &lt;span style="color:#a6e22e">sdk&lt;/span>.&lt;span style="color:#a6e22e">Board&lt;/span>
&lt;span style="color:#a6e22e">meta&lt;/span> &lt;span style="color:#a6e22e">sdk&lt;/span>.&lt;span style="color:#a6e22e">BoardProperties&lt;/span>
&lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#66d9ef">error&lt;/span>
&lt;span style="color:#a6e22e">grafanaURL&lt;/span> &lt;span style="color:#66d9ef">string&lt;/span>
&lt;span style="color:#a6e22e">apiKey&lt;/span> &lt;span style="color:#66d9ef">string&lt;/span>
&lt;span style="color:#a6e22e">directory&lt;/span> &lt;span style="color:#66d9ef">string&lt;/span>
)
&lt;/code>&lt;/pre>&lt;/div>&lt;p>–í &lt;code>boardLinks&lt;/code> –±—É–¥—É—Ç—å –¥–æ–±–∞–≤–ª—è—Ç–∏—Å—å —Å—Å–∏–ª–∫–∏ –Ω–∞ –¥–∞—à–±–æ—Ä–¥–∏ –≤ Grafana. –í &lt;code>rawBoard&lt;/code> –±—É–¥–µ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏—Å—å –¥–∞—à–±–æ—Ä–¥. &lt;code>meta&lt;/code> –±—É–¥–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏—Å—å –¥–ª—è —Ç–æ–≥–æ —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ —ñ–º&amp;rsquo;—è –¥–∞—à–±–æ—Ä–¥–∞ —ñ –∑–±–µ—Ä–µ–≥—Ç–∏ –π–æ–≥–æ –∑ —Ç–∞–∫–∏–º —ñ–º–µ–Ω–µ–º –≤ —Ñ–∞–π–ª. &lt;code>directory&lt;/code> –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—è –≤ —è–∫—É –±—É–¥—É—Ç—å –∑–±–µ—Ä—ñ–≥–∞—Ç–∏—Å—å –¥–∞—à–±–æ—Ä–¥–∏. &lt;code>grafanaURL&lt;/code> - Grafana url –∑ –ø–æ—Ä—Ç–æ–º –≤ —Ñ–æ—Ä–º–∞—Ç—ñ &lt;code>http://127.0.0.1:3030&lt;/code> —Ç–∞ &lt;code>apiKey&lt;/code> –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó –≤ Grafana. –í grafanaUR, apiKey —Ç–∞ directory –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–Ω–µ—Å—Ç–∏ —Å–≤–æ—î –∑–Ω–∞—á–µ–Ω–Ω—è.&lt;/p>
&lt;p>–°—Ç–≤–æ—Ä—é—î–º–æ Grafana –∫–ª—ñ—î–Ω—Ç&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-go" data-lang="go"> &lt;span style="color:#a6e22e">ctx&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">context&lt;/span>.&lt;span style="color:#a6e22e">Background&lt;/span>()
&lt;span style="color:#a6e22e">c&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">sdk&lt;/span>.&lt;span style="color:#a6e22e">NewClient&lt;/span>(&lt;span style="color:#a6e22e">grafanaURL&lt;/span>, &lt;span style="color:#a6e22e">apiKey&lt;/span>, &lt;span style="color:#a6e22e">sdk&lt;/span>.&lt;span style="color:#a6e22e">DefaultHTTPClient&lt;/span>)
&lt;/code>&lt;/pre>&lt;/div>&lt;p>–Ü —Ç–µ–ø–µ—Ä –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∫–ª—ñ—î–Ω—Ç–∞ –º–æ–∂–Ω–∞ —Ä–æ–±–∏—Ç–∏ –∑–∞–ø–∏—Ç–∏ –¥–æ Grafana api. –Ü –ø–µ—Ä—à–µ —â–æ –º–æ–∂–Ω–∞ –æ—Ç—Ä–∏–º–∞—Ç–∏ —Ü–µ —Å–ø–∏—Å–æ–∫ —Å—Å–∏–ª–æ–∫ –Ω–∞ –¥–∞—à–±–æ—Ä–¥–∏&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-go" data-lang="go"> &lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">boardLinks&lt;/span>, &lt;span style="color:#a6e22e">err&lt;/span> = &lt;span style="color:#a6e22e">c&lt;/span>.&lt;span style="color:#a6e22e">Search&lt;/span>(&lt;span style="color:#a6e22e">ctx&lt;/span>); &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#66d9ef">nil&lt;/span> {
&lt;span style="color:#a6e22e">log&lt;/span>.&lt;span style="color:#a6e22e">Fatalln&lt;/span>(&lt;span style="color:#a6e22e">err&lt;/span>)
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>–¢–µ–ø–µ—Ä —è–∫ —Å—Å–∏–ª–∫–∏ –Ω–∞ –¥–∞—à–±–æ—Ä–¥–∏ –æ—Ç—Ä–∏–º–∞–Ω–æ –º–æ–∂–Ω–∞ —ñ –æ—Ç—Ä–∏–º–∞—Ç–∏ —Å–∞–º—ñ –¥–∞—à–±–æ—Ä–¥–∏ —Ç–∞ –∑–∞–ø–∏—Å–∞—Ç–∏ —ó—Ö –≤ —Ñ–∞–π–ª.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-go" data-lang="go"> &lt;span style="color:#66d9ef">for&lt;/span> &lt;span style="color:#a6e22e">_&lt;/span>, &lt;span style="color:#a6e22e">link&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#66d9ef">range&lt;/span> &lt;span style="color:#a6e22e">boardLinks&lt;/span> {
&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">rawBoard&lt;/span>, &lt;span style="color:#a6e22e">meta&lt;/span>, &lt;span style="color:#a6e22e">err&lt;/span> = &lt;span style="color:#a6e22e">c&lt;/span>.&lt;span style="color:#a6e22e">GetDashboardByUID&lt;/span>(&lt;span style="color:#a6e22e">ctx&lt;/span>, &lt;span style="color:#a6e22e">link&lt;/span>.&lt;span style="color:#a6e22e">UID&lt;/span>); &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#66d9ef">nil&lt;/span> {
&lt;span style="color:#a6e22e">log&lt;/span>.&lt;span style="color:#a6e22e">Printf&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;%s for %s\n&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">err&lt;/span>, &lt;span style="color:#a6e22e">link&lt;/span>.&lt;span style="color:#a6e22e">URI&lt;/span>)
&lt;span style="color:#66d9ef">continue&lt;/span>
}
&lt;span style="color:#a6e22e">rawBoard&lt;/span>.&lt;span style="color:#a6e22e">ID&lt;/span> = &lt;span style="color:#ae81ff">0&lt;/span>
&lt;span style="color:#a6e22e">writeDashboardToFile&lt;/span>(&lt;span style="color:#a6e22e">directory&lt;/span>, &lt;span style="color:#a6e22e">rawBoard&lt;/span>, &lt;span style="color:#a6e22e">meta&lt;/span>.&lt;span style="color:#a6e22e">Slug&lt;/span>)
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>–¶–∏–∫–ª–æ–º —è –ø—Ä–æ—Ö–æ–¥–∂—É –ø–æ —É—Å—ñ—Ö —Å—Å–∏–ª–∫–∞—Ö –Ω–∞ –¥–∞—à–±–æ—Ä–¥–∏ –≤ slice boardLinks —ñ –Ω–∞ –∫–æ–∂–Ω–æ–≥–æ –∑ –Ω–∏—Ö –≤–∏–∫–ª–∏–∫–∞—é –º–µ—Ç–æ–¥ &lt;code>GetDashboardByUID&lt;/code>, —è–∫–æ–≥–æ –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –ø–µ—Ä–µ–¥–∞—é –∫–æ–Ω—Ç–µ–∫—Å—Ç —Ç–∞ UID –¥–∞—à–±–æ—Ä–¥–∞.&lt;/p>
&lt;p>–¢–∞–∫–æ–∂ –≤–∞–∂–ª–∏–≤–æ —â–æ–± –ø–æ–ª–µ &lt;code>ID&lt;/code> –±—É–ª–æ –≤—ñ–¥—Å—É—Ç–Ω—î, —ñ–Ω–∞–∫—à–µ Grafana –Ω–µ –¥–æ–∑–≤–æ–ª–∏—Ç—å –∑—Ä–æ–±–∏—Ç–∏ –µ–∫—Å–ø–æ—Ä—Ç –¥–∞—à–±–æ—Ä–¥—ñ–≤. –ß–µ—Ä–µ–∑ —Ç–æ —â–æ –≤ sdk.Board –≤–æ–Ω–æ –º–∞—î —Ç–∏–ø uint —Ç–∞ omitempty —è –º–æ–∂—É –¥–∞—Ç–∏ –π–æ–º—É –∑–Ω–∞—á–µ–Ω–Ω—è 0 —ñ —Ü–µ –ø–æ–ª–µ –Ω–µ –±—É–¥–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-go" data-lang="go">&lt;span style="color:#a6e22e">ID&lt;/span> &lt;span style="color:#66d9ef">uint&lt;/span> &lt;span style="color:#e6db74">`json:&amp;#34;id,omitempty&amp;#34;`&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>–Ü –≤ –∫—ñ–Ω—Ü—ñ –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –º–µ—Ç–æ–¥ writeDashboardToFile —è–∫–∏–π –ø—Ä–∏–π–º–∞—î —Ç—Ä–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏, –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—è –¥–µ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ –¥–∞—à–±–æ—Ä–¥, —Å–∞–º –¥–∞—à–±–æ—Ä–¥, —Ç–∞ —ñ–º&amp;rsquo;—è –¥–∞—à–±–æ—Ä–¥–∞ —è–∫–µ –º–æ–∂–Ω–∞ –æ—Ç—Ä–∏–º–∞—Ç–∏ –∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ meta.&lt;/p>
&lt;p>–©–æ –∑–∞–ª–∏—à–∏–ª–æ—Å—å —Ü–µ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –º–µ—Ç–æ–¥ &lt;code>writeDashboardToFile&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-go" data-lang="go">&lt;span style="color:#66d9ef">func&lt;/span> &lt;span style="color:#a6e22e">writeDashboardToFile&lt;/span>(&lt;span style="color:#a6e22e">directory&lt;/span> &lt;span style="color:#66d9ef">string&lt;/span>, &lt;span style="color:#a6e22e">dashboard&lt;/span> &lt;span style="color:#a6e22e">sdk&lt;/span>.&lt;span style="color:#a6e22e">Board&lt;/span>, &lt;span style="color:#a6e22e">name&lt;/span> &lt;span style="color:#66d9ef">string&lt;/span>, &lt;span style="color:#a6e22e">tag&lt;/span> &lt;span style="color:#66d9ef">string&lt;/span>) {
&lt;span style="color:#66d9ef">var&lt;/span> (
&lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#66d9ef">error&lt;/span>
&lt;span style="color:#a6e22e">dashboardFile&lt;/span> &lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#a6e22e">os&lt;/span>.&lt;span style="color:#a6e22e">File&lt;/span>
&lt;span style="color:#a6e22e">fileName&lt;/span> &lt;span style="color:#66d9ef">string&lt;/span>
)
&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">_&lt;/span>, &lt;span style="color:#a6e22e">err&lt;/span> = &lt;span style="color:#a6e22e">os&lt;/span>.&lt;span style="color:#a6e22e">Stat&lt;/span>(&lt;span style="color:#a6e22e">directory&lt;/span>); &lt;span style="color:#a6e22e">os&lt;/span>.&lt;span style="color:#a6e22e">IsNotExist&lt;/span>(&lt;span style="color:#a6e22e">err&lt;/span>) {
&lt;span style="color:#a6e22e">os&lt;/span>.&lt;span style="color:#a6e22e">MkdirAll&lt;/span>(&lt;span style="color:#a6e22e">directory&lt;/span>, &lt;span style="color:#ae81ff">0755&lt;/span>)
}
&lt;span style="color:#a6e22e">fileName&lt;/span> = &lt;span style="color:#a6e22e">fmt&lt;/span>.&lt;span style="color:#a6e22e">Sprintf&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;%s/%s.json&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">directory&lt;/span>, &lt;span style="color:#a6e22e">name&lt;/span>)
&lt;span style="color:#a6e22e">dashboardFile&lt;/span>, &lt;span style="color:#a6e22e">err&lt;/span> = &lt;span style="color:#a6e22e">os&lt;/span>.&lt;span style="color:#a6e22e">Create&lt;/span>(&lt;span style="color:#a6e22e">fileName&lt;/span>)
&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#66d9ef">nil&lt;/span> {
&lt;span style="color:#a6e22e">log&lt;/span>.&lt;span style="color:#a6e22e">Printf&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;failed to create file for dashboard %s&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">fileName&lt;/span>)
}
&lt;span style="color:#66d9ef">defer&lt;/span> &lt;span style="color:#a6e22e">dashboardFile&lt;/span>.&lt;span style="color:#a6e22e">Close&lt;/span>()
&lt;span style="color:#a6e22e">err&lt;/span> = &lt;span style="color:#a6e22e">json&lt;/span>.&lt;span style="color:#a6e22e">NewEncoder&lt;/span>(&lt;span style="color:#a6e22e">dashboardFile&lt;/span>).&lt;span style="color:#a6e22e">Encode&lt;/span>(&lt;span style="color:#a6e22e">dashboard&lt;/span>)
&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#66d9ef">nil&lt;/span> {
&lt;span style="color:#a6e22e">log&lt;/span>.&lt;span style="color:#a6e22e">Printf&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;failed to encode dashboard json to file %s&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">fileName&lt;/span>)
}
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>–í —Ü—å–æ–º—É –º–µ—Ç–æ–¥—ñ –ø–µ—Ä–µ–≤—ñ—Ä—è—é —á–∏ —ñ—Å–Ω—É—î –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—è, —è–∫—â–æ –∂ –Ω—ñ —Ç–æ —Å—Ç–≤–æ—Ä—é—é —ó—ó. –î–∞–ª—ñ –≤ —Ü—ñ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó —è —Å—Ç–≤–æ—Ä—é—é —Ñ–∞–π–ª –∑ –Ω–∞–∑–≤–æ—é –¥–∞—à–±–æ—Ä–¥–∞ —ñ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é &lt;code>json.NewEncoder&lt;/code> –∑–∞–ø–∏—Å—É—é json –≤ —Ñ–∞–π–ª.&lt;/p>
&lt;p>–ù–∞—Å—Ç—É–ø–Ω–∏–º –∫—Ä–æ–∫–æ–º –Ω–∞ –æ—Å–Ω–æ–≤—ñ –¥–∞–Ω–æ–≥–æ –∫–æ–¥—É –º–æ–∂–Ω–∞ —Å—Ç–≤–æ—Ä–∏—Ç–∏ cli –Ω–∞–ø—Ä–∏–∫–ª–∞–¥ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é cobra —á–∏ —ñ–Ω—à–æ—ó –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏.&lt;/p></content></item><item><title>Filter Ebs Snapshot By Date With Go</title><link>/ua/2020/12/05/filter-ebs-snapshot-by-date-with-go/</link><pubDate>Sat, 05 Dec 2020 17:53:29 +0200</pubDate><guid>/ua/2020/12/05/filter-ebs-snapshot-by-date-with-go/</guid><description>–ü—Ä–∏–≤—ñ—Ç!
–°—å–æ–≥–æ–¥–Ω—ñ –ø–æ–¥–∏–≤–∏–º–æ—Å—å —è–∫ –º–æ–∂–Ω–∞ —Ñ—ñ–ª—å—Ç—Ä—É–≤–∞—Ç–∏ ebs —Å–Ω–µ–ø—à–æ—Ç–∏ –ø–æ –¥–∞—Ç—ñ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é golang.
–î–ª—è –ø–æ—á–∞—Ç–∫—É —Å—Ç–≤–æ—Ä—é –ø–∞–ø–∫—É —ñ –≤ –Ω—ñ–π —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—é go –º–æ–¥—É–ª—å
mkdir snapshotFilter cd snapshotFilter go mod init snapshotFilter –ü–æ—Ç—Ä—ñ–±–Ω–æ —Å—Ç–≤–æ—Ä–∏—Ç–∏ main.go –≤ —è–∫–æ–º—É –±—É–¥–µ –∫–æ–¥. –ü–æ—á–Ω–µ–º–æ –∑ main —Ñ—É–Ω–∫—Ü—ñ—ó
package main import ( &amp;#34;flag&amp;#34; &amp;#34;fmt&amp;#34; &amp;#34;log&amp;#34; &amp;#34;sort&amp;#34; &amp;#34;time&amp;#34; &amp;#34;github.com/aws/aws-sdk-go/aws&amp;#34; &amp;#34;github.com/aws/aws-sdk-go/aws/session&amp;#34; &amp;#34;github.com/aws/aws-sdk-go/service/ec2&amp;#34; ) func main() { sess := session.Must(session.NewSession()) ec2Client := ec2.New(sess) filterDate := flag.String(&amp;#34;snapshot-date&amp;#34;, time.Now().Format(time.RFC3339), &amp;#34;Provide snapshot creation date&amp;#34;) snapshotName := flag.</description><content>&lt;p>–ü—Ä–∏–≤—ñ—Ç!&lt;/p>
&lt;p>–°—å–æ–≥–æ–¥–Ω—ñ –ø–æ–¥–∏–≤–∏–º–æ—Å—å —è–∫ –º–æ–∂–Ω–∞ —Ñ—ñ–ª—å—Ç—Ä—É–≤–∞—Ç–∏ ebs —Å–Ω–µ–ø—à–æ—Ç–∏ –ø–æ –¥–∞—Ç—ñ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é golang.&lt;/p>
&lt;p>–î–ª—è –ø–æ—á–∞—Ç–∫—É —Å—Ç–≤–æ—Ä—é –ø–∞–ø–∫—É —ñ –≤ –Ω—ñ–π —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—é go –º–æ–¥—É–ª—å&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">mkdir snapshotFilter
cd snapshotFilter
go mod init snapshotFilter
&lt;/code>&lt;/pre>&lt;/div>&lt;p>–ü–æ—Ç—Ä—ñ–±–Ω–æ —Å—Ç–≤–æ—Ä–∏—Ç–∏ &lt;code>main.go&lt;/code> –≤ —è–∫–æ–º—É –±—É–¥–µ –∫–æ–¥.
–ü–æ—á–Ω–µ–º–æ –∑ main —Ñ—É–Ω–∫—Ü—ñ—ó&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-go" data-lang="go">&lt;span style="color:#f92672">package&lt;/span> &lt;span style="color:#a6e22e">main&lt;/span>
&lt;span style="color:#f92672">import&lt;/span> (
&lt;span style="color:#e6db74">&amp;#34;flag&amp;#34;&lt;/span>
&lt;span style="color:#e6db74">&amp;#34;fmt&amp;#34;&lt;/span>
&lt;span style="color:#e6db74">&amp;#34;log&amp;#34;&lt;/span>
&lt;span style="color:#e6db74">&amp;#34;sort&amp;#34;&lt;/span>
&lt;span style="color:#e6db74">&amp;#34;time&amp;#34;&lt;/span>
&lt;span style="color:#e6db74">&amp;#34;github.com/aws/aws-sdk-go/aws&amp;#34;&lt;/span>
&lt;span style="color:#e6db74">&amp;#34;github.com/aws/aws-sdk-go/aws/session&amp;#34;&lt;/span>
&lt;span style="color:#e6db74">&amp;#34;github.com/aws/aws-sdk-go/service/ec2&amp;#34;&lt;/span>
)
&lt;span style="color:#66d9ef">func&lt;/span> &lt;span style="color:#a6e22e">main&lt;/span>() {
&lt;span style="color:#a6e22e">sess&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">session&lt;/span>.&lt;span style="color:#a6e22e">Must&lt;/span>(&lt;span style="color:#a6e22e">session&lt;/span>.&lt;span style="color:#a6e22e">NewSession&lt;/span>())
&lt;span style="color:#a6e22e">ec2Client&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">ec2&lt;/span>.&lt;span style="color:#a6e22e">New&lt;/span>(&lt;span style="color:#a6e22e">sess&lt;/span>)
&lt;span style="color:#a6e22e">filterDate&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">flag&lt;/span>.&lt;span style="color:#a6e22e">String&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;snapshot-date&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">time&lt;/span>.&lt;span style="color:#a6e22e">Now&lt;/span>().&lt;span style="color:#a6e22e">Format&lt;/span>(&lt;span style="color:#a6e22e">time&lt;/span>.&lt;span style="color:#a6e22e">RFC3339&lt;/span>), &lt;span style="color:#e6db74">&amp;#34;Provide snapshot creation date&amp;#34;&lt;/span>)
&lt;span style="color:#a6e22e">snapshotName&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">flag&lt;/span>.&lt;span style="color:#a6e22e">String&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;snapshot-name&amp;#34;&lt;/span>, &lt;span style="color:#66d9ef">nil&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;Provide snapshot name&amp;#34;&lt;/span>)
&lt;span style="color:#a6e22e">flag&lt;/span>.&lt;span style="color:#a6e22e">Parse&lt;/span>()
&lt;span style="color:#a6e22e">parsedTime&lt;/span>, &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">time&lt;/span>.&lt;span style="color:#a6e22e">Parse&lt;/span>(&lt;span style="color:#a6e22e">time&lt;/span>.&lt;span style="color:#a6e22e">RFC3339&lt;/span>, &lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#a6e22e">filterDate&lt;/span>)
&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#66d9ef">nil&lt;/span> {
&lt;span style="color:#a6e22e">log&lt;/span>.&lt;span style="color:#a6e22e">Fatalln&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;Not able to parse time&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">err&lt;/span>)
}
&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#a6e22e">snapshotName&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#e6db74">&amp;#34;&amp;#34;&lt;/span> {
&lt;span style="color:#a6e22e">log&lt;/span>.&lt;span style="color:#a6e22e">Fatalln&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;Please provide snapshot name&amp;#34;&lt;/span>)
}
&lt;span style="color:#a6e22e">fmt&lt;/span>.&lt;span style="color:#a6e22e">Println&lt;/span>(&lt;span style="color:#a6e22e">filterSnapshotByDate&lt;/span>(&lt;span style="color:#a6e22e">parsedTime&lt;/span>, &lt;span style="color:#a6e22e">snapshotName&lt;/span>, &lt;span style="color:#a6e22e">ec2Client&lt;/span>))
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>–ü–æ—á–∏–Ω–∞—î—Ç—å—Å—è —Ñ–∞–π–ª –∑ –Ω–∞–∑–≤–∏ package —Ç–∞ —ñ–º–ø–æ—Ä—Ç—ñ–≤. –ù–∞—Å—Ç—É–ø–Ω–∏–º —ñ–¥–µ —Ñ—É–Ω–∫—Ü—ñ—è main.
–¢—É—Ç —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è ec2 –∫–ª—ñ—î–Ω—Ç —Ç–∞ –ø–∞—Ä–∞–º–µ—Ç–µ—Ä –∫–æ–º–∞–Ω–¥–Ω–æ–≥–æ —Ä—è–¥–∫–∞ &lt;code>filterDate&lt;/code> —ñ &lt;code>snapshotName&lt;/code>. &lt;code>filterDate&lt;/code> –±—É–¥–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ –¥–ª—è –≤–≤–µ–¥–µ–Ω–Ω—è –¥–∞—Ç–∏ —Å–Ω–µ–ø—à–æ—Ç—É –∑ –∫–æ–Ω—Å–æ–ª—ñ. –Ø–∫—â–æ —Ü–µ–π –ø–∞—Ä–∞–º–µ—Ç—Ä –Ω–µ –±—É–¥–µ –≤–≤–µ–¥–µ–Ω–æ –ø–æ—Ç–æ—á–Ω–∞ –¥–∞—Ç–∞ –±—É–¥–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∞ –≤ —Ñ–æ—Ä–º–∞—Ç—ñ RFC3339 (2006-01-02T15:04:05Z07:00). –î–ª—è —Ç–æ–≥–æ —â–æ–± –≤–∫–∞–∑–∞—Ç–∏ —Ü–µ –∑–Ω–∞—á–µ–Ω–Ω—è –∑ –∫–æ–Ω—Å–æ–ª—ñ —Ü–µ –±—É–¥–µ –≤–∏–≥–ª—è–¥–∞—Ç–∏ —Ç–∞–∫ - &lt;code>go run main.go -snapshot-date=2020-03-20T06:24:05Z&lt;/code>. –ê–Ω–∞–ª–æ–≥—ñ—á–Ω–æ —Å—Ç–≤–æ—Ä—é—é –ø–∞—Ä–∞–º–µ—Ç–µ—Ä –¥–ª—è —ñ–º–µ–Ω—ñ —Å–Ω–µ–ø—à–æ—Ç–∞, –∞–ª–µ —è–∫—â–æ —Ü–µ–π –ø–∞—Ä–∞–º–µ—Ç–µ—Ä –Ω–µ –∑–∞–∑–Ω–∞—á–µ–Ω–æ —Ç–æ –ø—Ä–æ–≥—Ä–∞–º–∏ –∑–∞–≤–µ—Ä—à–∏—Ç—å—Å—è –∑ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è–º &lt;code>Please provide snapshot name&lt;/code>. –¢–∞–∫–æ–∂ –ø–æ—Ç—Ä—ñ–±–Ω–æ –¥–∞—Ç—É —è–∫—É –ø–µ—Ä–µ–¥–∞–≤ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á —Ç–∏–ø—É string –ø–µ—Ä–µ—Ç–≤–æ—Ä–∏—Ç–∏ –≤ —Ç–∏–ø time.Time. –Ø –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—é –º–µ—Ç–æ–¥ time.Parse, –ø–µ—Ä—à–∏–º –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç–∏ layout, –æ—Å–∫—ñ–ª—å–∫–∏ —è –∑–Ω–∞—é —â–æ –º—ñ–π —Ñ–æ—Ä–º–∞—Ç —Ü–µ &lt;code>RFC3339&lt;/code> —Ç–æ —è –≤–∫–∞–∂—É &lt;code>time.RFC3339&lt;/code>, –¥—Ä—É–≥–∏–º –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º —è –ø–µ—Ä–µ–¥–∞–º –∑–Ω–∞—á–µ–Ω–Ω—è —â–æ –≤–≤—ñ–≤ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á.
&lt;code>filterSnapshotByDate(filterDate, snapshotName, ec2Client)&lt;/code> –º–µ—Ç–æ–¥ —è–∫–∏–π –±—É–¥–µ —Ä–æ–±–∏—Ç–∏ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—é.&lt;/p>
&lt;p>–î–ª—è —Ç–æ–≥–æ —â–æ–± –≤—ñ–¥—Ñ—ñ–ª—å—Ç—Ä—É–≤–∞—Ç–∏ —Å–Ω–µ–ø—à–æ—Ç —Å–ø–æ—á–∞—Ç–∫—É –æ—Ç—Ä–∏–º–∞—Ç–∏ —Å–ø–∏—Å–æ–∫ –≤—Å—ñ —Å–Ω–µ–ø—à–æ—Ç—ñ–≤. –Ø –±—É–¥—É –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ç–µ–≥ Name –¥–ª—è —Ç–æ–≥–æ —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ —Å–∞–º–µ —Ç–æ–π —Å–Ω–µ–ø—à–æ—Ç —è–∫–∏–π –º–µ–Ω—ñ –ø–æ—Ç—Ä—ñ–±–Ω–æ.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-go" data-lang="go">&lt;span style="color:#66d9ef">func&lt;/span> &lt;span style="color:#a6e22e">filterSnapshotByDate&lt;/span>(&lt;span style="color:#a6e22e">filterDate&lt;/span> &lt;span style="color:#a6e22e">time&lt;/span>.&lt;span style="color:#a6e22e">Time&lt;/span>, &lt;span style="color:#a6e22e">snapshotName&lt;/span> &lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#66d9ef">string&lt;/span>, &lt;span style="color:#a6e22e">client&lt;/span> &lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#a6e22e">ec2&lt;/span>.&lt;span style="color:#a6e22e">EC2&lt;/span>) &lt;span style="color:#66d9ef">string&lt;/span> {
&lt;span style="color:#a6e22e">input&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#f92672">&amp;amp;&lt;/span>&lt;span style="color:#a6e22e">ec2&lt;/span>.&lt;span style="color:#a6e22e">DescribeSnapshotsInput&lt;/span>{&lt;span style="color:#a6e22e">Filters&lt;/span>: []&lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#a6e22e">ec2&lt;/span>.&lt;span style="color:#a6e22e">Filter&lt;/span>{
{&lt;span style="color:#a6e22e">Name&lt;/span>: &lt;span style="color:#a6e22e">aws&lt;/span>.&lt;span style="color:#a6e22e">String&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;tag:Name&amp;#34;&lt;/span>), &lt;span style="color:#a6e22e">Values&lt;/span>: []&lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#66d9ef">string&lt;/span>{&lt;span style="color:#a6e22e">snapshotName&lt;/span>}},
}}
&lt;span style="color:#66d9ef">var&lt;/span> &lt;span style="color:#a6e22e">result&lt;/span> []&lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#a6e22e">ec2&lt;/span>.&lt;span style="color:#a6e22e">Snapshot&lt;/span>
&lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">client&lt;/span>.&lt;span style="color:#a6e22e">DescribeSnapshotsPages&lt;/span>(&lt;span style="color:#a6e22e">input&lt;/span>,
&lt;span style="color:#66d9ef">func&lt;/span>(&lt;span style="color:#a6e22e">page&lt;/span> &lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#a6e22e">ec2&lt;/span>.&lt;span style="color:#a6e22e">DescribeSnapshotsOutput&lt;/span>, &lt;span style="color:#a6e22e">lastPage&lt;/span> &lt;span style="color:#66d9ef">bool&lt;/span>) &lt;span style="color:#66d9ef">bool&lt;/span> {
&lt;span style="color:#a6e22e">result&lt;/span> = append(&lt;span style="color:#a6e22e">result&lt;/span>, &lt;span style="color:#a6e22e">page&lt;/span>.&lt;span style="color:#a6e22e">Snapshots&lt;/span>&lt;span style="color:#f92672">...&lt;/span>)
&lt;span style="color:#66d9ef">return&lt;/span> !&lt;span style="color:#a6e22e">lastPage&lt;/span>
})
&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#66d9ef">nil&lt;/span> {
&lt;span style="color:#a6e22e">log&lt;/span>.&lt;span style="color:#a6e22e">Fatalln&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;Was not able to get list of snapshots&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">err&lt;/span>)
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>–í input –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ —è —Å—Ç–≤–æ—Ä—é —Ñ—ñ–ª—å—Ç—Ä —è–∫–∏–º –±—É–¥—É —Ñ—ñ–ª—å—Ç—Ä—É–≤–∞—Ç–∏ –ø–æ—Ç—Ä—ñ–±–Ω—ñ –º–µ–Ω—ñ —Å–Ω–µ–ø–æ—à—Ç–∏ –ø–æ —ñ–º–µ–Ω—ñ. –Ü –¥–∞–ª—ñ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ñ—É–Ω–∫—Ü—ñ—ó –ø–∞–≥—ñ–Ω–∞—Ü—ñ—ó &lt;code>DescribeSnapshotsPages&lt;/code> —è –æ—Ç—Ä–∏–º–∞—é —Å–ø–∏—Å–æ–∫ —É—Å—ñ—Ö —Å–Ω–µ–ø—à–æ—Ç—ñ–≤ —Ç–∞ –¥–æ–±–∞–≤–ª—é —ó—Ö –≤ —Å–ø–∏—Å–æ–∫ &lt;code>var result []*ec2.Snapshot&lt;/code>.&lt;/p>
&lt;p>–î–ª—è —Ç–æ–≥–æ —â–æ–± –≤—ñ–¥—Ñ—ñ–ª—å—Ç—Ä—É–≤–∞—Ç–∏ —Å–Ω–µ–ø—à–æ—Ç –ø–æ –¥–∞—Ç—ñ —Å–ø–æ—á–∞—Ç–∫—É —ó—Ö —Ç—Ä–µ–±–∞ –ø–æ—Å–æ—Ä—Ç—É–≤–∞—Ç–∏.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-go" data-lang="go"> &lt;span style="color:#a6e22e">sort&lt;/span>.&lt;span style="color:#a6e22e">Slice&lt;/span>(&lt;span style="color:#a6e22e">result&lt;/span>, &lt;span style="color:#66d9ef">func&lt;/span>(&lt;span style="color:#a6e22e">i&lt;/span>, &lt;span style="color:#a6e22e">j&lt;/span> &lt;span style="color:#66d9ef">int&lt;/span>) &lt;span style="color:#66d9ef">bool&lt;/span> {
&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">result&lt;/span>[&lt;span style="color:#a6e22e">i&lt;/span>].&lt;span style="color:#a6e22e">StartTime&lt;/span>.&lt;span style="color:#a6e22e">After&lt;/span>(&lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#a6e22e">result&lt;/span>[&lt;span style="color:#a6e22e">j&lt;/span>].&lt;span style="color:#a6e22e">StartTime&lt;/span>)
})
&lt;/code>&lt;/pre>&lt;/div>&lt;p>–ß–µ—Ä–µ–∑ —Ç–µ —â–æ –æ–±&amp;rsquo;—î–∫—Ç–∏ —è–∫—ñ —è —Ñ—ñ–ª—å—Ç—Ä—É—é –º–∞—é—Ç—å —Ç–∏–ø time.Time —è –Ω–µ –º–æ–∂—É —ó—Ö –ø–æ—Ä—ñ–≤–Ω—é–≤–∞—Ç–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é &amp;gt; —á–∏ &amp;lt;. –ê–ª–µ –¥–ª—è —Ç–∞–∫–∏—Ö –≤–∏–ø–∞–¥–∫—ñ–≤ –≤ go —î –º–µ—Ç–æ–¥ After. –°–∞–º–µ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –Ω—å–æ–≥–æ —è –ø–æ—Å–æ—Ä—Ç—É—é —Å–ª–∞–π—Å –∑ —Å–Ω–µ–ø—à–æ—Ç–∞–º–∏.&lt;/p>
&lt;p>–¢–µ–ø–µ—Ä –º–æ–∂–Ω–∞ —Ñ—ñ–ª—å—Ç—Ä—É–≤–∞—Ç–∏ —Å–Ω–µ–ø—à–æ—Ç–∏, –¥–ª—è —Ü—å–æ–≥–æ —Ü–∏–∫–ª–æ–º —è –ø—Ä–æ–π–¥—É—Å—å –ø–æ –≤—ñ–¥—Å–æ—Ä—Ç–æ–≤–∞–Ω–∏—Ö —Å–Ω–µ–ø—à–æ—Ç–∞—Ö —ñ –∫–æ–ª–∏ –¥–∞—Ç–∞ –≤–≤–µ–¥–µ–Ω–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º –±—É–¥–µ –±—ñ–ª—å—à–∞ —á–∏–º –¥–∞—Ç–∞ —Å–Ω–µ–ø–æ—à—Ç–∞ —è –ø–æ–≤–µ—Ä–Ω—É id —Å–Ω–µ–ø—à–æ—Ç–∞.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-go" data-lang="go"> &lt;span style="color:#66d9ef">for&lt;/span> &lt;span style="color:#a6e22e">_&lt;/span>, &lt;span style="color:#a6e22e">snapshot&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#66d9ef">range&lt;/span> &lt;span style="color:#a6e22e">result&lt;/span> {
&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">filterDate&lt;/span>.&lt;span style="color:#a6e22e">After&lt;/span>(&lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#a6e22e">snapshot&lt;/span>.&lt;span style="color:#a6e22e">StartTime&lt;/span>) {
&lt;span style="color:#a6e22e">log&lt;/span>.&lt;span style="color:#a6e22e">Println&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;Found snapshot with date&amp;#34;&lt;/span>, &lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#a6e22e">snapshot&lt;/span>.&lt;span style="color:#a6e22e">StartTime&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;which are closest date to&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">filterDate&lt;/span>.&lt;span style="color:#a6e22e">String&lt;/span>)
&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#a6e22e">snapshot&lt;/span>.&lt;span style="color:#a6e22e">SnapshotId&lt;/span>
}
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>–Ø–∫—â–æ –∂ —Ç–∞–∫–æ–≥–æ —Å–Ω–µ–ø—à–æ—Ç–∞ –Ω–µ –±—É–¥–µ –∑–Ω–∞–π–¥–µ–Ω–æ —Ç–æ —è –ø–æ–≤–µ—Ä–Ω—É id –æ—Å—Ç–∞–Ω–Ω—å–æ–≥–æ —Å–Ω–µ–ø–æ—à—Ç–∞&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-go" data-lang="go"> &lt;span style="color:#a6e22e">log&lt;/span>.&lt;span style="color:#a6e22e">Println&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;Not found spashot with specific date&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">filterDate&lt;/span>.&lt;span style="color:#a6e22e">String&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;going to use latest&amp;#34;&lt;/span>, &lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#a6e22e">result&lt;/span>[&lt;span style="color:#ae81ff">0&lt;/span>].&lt;span style="color:#a6e22e">StartTime&lt;/span>)
&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#a6e22e">result&lt;/span>[&lt;span style="color:#ae81ff">0&lt;/span>].&lt;span style="color:#a6e22e">SnapshotId&lt;/span>
}
&lt;/code>&lt;/pre>&lt;/div></content></item><item><title>Custom Dns for Github Pages</title><link>/ua/2020/11/02/custom-dns-for-github-pages/</link><pubDate>Mon, 02 Nov 2020 16:19:52 +0200</pubDate><guid>/ua/2020/11/02/custom-dns-for-github-pages/</guid><description>–ü—Ä–∏–≤—ñ—Ç!
–°—å–æ–≥–æ–¥–Ω—ñ —Ö–æ—á—É –ø–æ–∫–∞–∑–∞—Ç–∏ —è–∫ –¥–ª—è GithubPages —Å–∞–π—Ç—É –º–æ–∂–Ω–∞ –¥–æ–±–∞–≤–∏—Ç–∏ –∫–∞—Å—Ç–æ–º–Ω–µ –¥–æ–º–µ–Ω–Ω–µ —ñ–º&amp;rsquo;—è.
–î–ª—è —Ü—å–æ–≥–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏–∫–æ–Ω–∞—Ç–∏ –¥–µ–∫—ñ–ª—å–∫–∞ –∫—Ä–æ–∫—ñ–≤. –†–æ–∑–ø–æ—á–Ω–µ–º–æ –∑ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó –¥–æ–º–µ–Ω–Ω–æ–≥–æ —ñ–º–µ–Ω—ñ. –î–ª—è —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó —è—è –≤–∏–±—Ä–∞–≤ Namecheap.
–ü–µ—Ä–µ–π—à–æ–≤—à–∏ –Ω–∞ Namecheap –≤ –ø–æ—à—É–∫—É –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–≤–µ—Å—Ç–∏ –¥–æ–º–µ–Ω–Ω–µ —ñ–º&amp;rsquo;—è —è–∫–µ —Ö–æ—á—É –∫—É–ø–∏—Ç–∏ —ñ –∑–Ω–∞–π—à–æ–≤–∏—à–∏ –¥–æ–¥–∞—Ç–∏ –π–æ–≥–æ –≤ –∫–æ—Ä–∑–∏–Ω—É.
–ë—ñ–ª—è –º–æ–≥–æ –¥–æ–º–µ–Ω–Ω–æ–≥–æ —ñ–º–µ–Ω—ñ –Ω–∞–ø–∏—Å–∞–Ω–æ Taken —Ü–µ —Ç–æ–º—É —â–æ —è –≤–∂–µ –π–æ–≥–æ –∫—É–ø–∏–≤.
–ü—ñ—Å–ª—è —Ç–æ–≥–æ —è–∫ –¥–æ–º–µ–Ω–Ω–µ —ñ–º&amp;rsquo;—è –∫—É–ø–ª–µ–Ω–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø–µ—Ä–µ–π—Ç–∏ –≤ —Å–≤—ñ–π –ø—Ä–æ—Ñ—ñ–ª—å —Ç–∞ –Ω–∞—Ç–∏—Å–Ω—É—Ç–∏ Manage.</description><content>&lt;p>–ü—Ä–∏–≤—ñ—Ç!&lt;/p>
&lt;p>–°—å–æ–≥–æ–¥–Ω—ñ —Ö–æ—á—É –ø–æ–∫–∞–∑–∞—Ç–∏ —è–∫ –¥–ª—è GithubPages —Å–∞–π—Ç—É –º–æ–∂–Ω–∞ –¥–æ–±–∞–≤–∏—Ç–∏ –∫–∞—Å—Ç–æ–º–Ω–µ –¥–æ–º–µ–Ω–Ω–µ —ñ–º&amp;rsquo;—è.&lt;br>
–î–ª—è —Ü—å–æ–≥–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏–∫–æ–Ω–∞—Ç–∏ –¥–µ–∫—ñ–ª—å–∫–∞ –∫—Ä–æ–∫—ñ–≤. –†–æ–∑–ø–æ—á–Ω–µ–º–æ –∑ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó –¥–æ–º–µ–Ω–Ω–æ–≥–æ —ñ–º–µ–Ω—ñ. –î–ª—è —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó —è—è –≤–∏–±—Ä–∞–≤ &lt;a href="https://www.namecheap.com/">Namecheap&lt;/a>.&lt;br>
–ü–µ—Ä–µ–π—à–æ–≤—à–∏ –Ω–∞ Namecheap –≤ –ø–æ—à—É–∫—É –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–≤–µ—Å—Ç–∏ –¥–æ–º–µ–Ω–Ω–µ —ñ–º&amp;rsquo;—è —è–∫–µ —Ö–æ—á—É –∫—É–ø–∏—Ç–∏ —ñ –∑–Ω–∞–π—à–æ–≤–∏—à–∏ –¥–æ–¥–∞—Ç–∏ –π–æ–≥–æ –≤ –∫–æ—Ä–∑–∏–Ω—É.&lt;/p>
&lt;p>&lt;img src="https://i.imgur.com/J1e9EI6.png" alt="Namecheap">&lt;/p>
&lt;p>–ë—ñ–ª—è –º–æ–≥–æ –¥–æ–º–µ–Ω–Ω–æ–≥–æ —ñ–º–µ–Ω—ñ –Ω–∞–ø–∏—Å–∞–Ω–æ &lt;code>Taken&lt;/code> —Ü–µ —Ç–æ–º—É —â–æ —è –≤–∂–µ –π–æ–≥–æ –∫—É–ø–∏–≤.&lt;/p>
&lt;p>–ü—ñ—Å–ª—è —Ç–æ–≥–æ —è–∫ –¥–æ–º–µ–Ω–Ω–µ —ñ–º&amp;rsquo;—è –∫—É–ø–ª–µ–Ω–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø–µ—Ä–µ–π—Ç–∏ –≤ —Å–≤—ñ–π –ø—Ä–æ—Ñ—ñ–ª—å —Ç–∞ –Ω–∞—Ç–∏—Å–Ω—É—Ç–∏ &lt;code>Manage&lt;/code>.&lt;/p>
&lt;p>&lt;img src="https://i.imgur.com/nUFrMWl.png" alt="NamecheapDns">&lt;/p>
&lt;p>–í —Å–µ–∫—Ü—ñ—ó &lt;code>Advanced DNS&lt;/code> —è –¥–æ–±–∞–≤–ª—é –¥–µ–∫—ñ–ª—å–∫–∞ –∑–∞–ø–∏—Å—ñ–≤ –∑—ñ–≥–¥–Ω–æ Github –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—ó. –ê–∫—Ç—É–∞–ª—å–Ω—ñ –∞–¥—Ä–µ—Å–∞ —Ç–∞–∫–æ–∂ –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ –≤ &lt;a href="https://docs.github.com/en/free-pro-team@latest/github/working-with-github-pages/managing-a-custom-domain-for-your-github-pages-site">–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—ó&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://i.imgur.com/AeXmmxb.png" alt="Dns">&lt;/p>
&lt;p>–°–ø–∏—Å–æ–∫ A —Ä–µ–∫–æ—Ä–¥—ñ–≤ —è–∫—ñ –ø–æ—Ç—Ä—ñ–±–Ω–æ —Å—Ç–≤–æ—Ä–∏—Ç–∏:&lt;/p>
&lt;ul>
&lt;li>185.199.108.153&lt;/li>
&lt;li>185.199.109.153&lt;/li>
&lt;li>185.199.110.153&lt;/li>
&lt;li>185.199.111.153&lt;/li>
&lt;/ul>
&lt;p>–¢–∞–∫–æ–∂ –ø–æ—Ç—Ä—ñ–±–Ω–æ —Å—Ç–≤–æ—Ä–∏—Ç–∏ CNAME —è–∫–∏–π –±—É–¥–µ –≤–∫–∞–∑—É–≤–∞—Ç–∏ –Ω–∞ GitHub Pages url. –í –º–æ—î–º—É –≤–∏–ø–∞–¥–∫—É —Ü–µ &lt;code>mpostument.github.io&lt;/code>.&lt;/p>
&lt;p>–ù–∞—Å—Ç—É–ø–Ω–∏–º –∫—Ä–æ–∫–æ–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –¥–æ–±–∞–≤–∏—Ç–∏ —Ñ–∞–π–ª –∑ —ñ–º–µ–Ω–µ–º CNAME –≤ –∫–æ—Ä—ñ–Ω—å GitHub Pages —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—è. –í –ø–µ—Ä—à–æ–º—É —Ä—è–¥–∫—É —Ü—å–æ–≥–æ —Ñ–∞–π–ª–∞ –ø–æ—Ç—Ä—ñ–±–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç–∏ –Ω–æ–≤–µ –¥–æ–º–µ–Ω–Ω–µ —ñ–º&amp;rsquo;—è, –¥–ª—è –º–µ–Ω–µ —Ü–µ &lt;code>mpostument.com&lt;/code>. –Ø –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é —Å—Ç–∞—Ç–∏—á–Ω–∏–π —Å–∞–π—Ç –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä Hugo –∑ Github Actions. (–ü—Ä–æ—á–∏—Ç–∞—Ç–∏ –ø—Ä–æ —Ü–µ –º–æ–∂–Ω–∞ –≤ –º–æ—î–º—É –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–º—É &lt;a href="https://mpostument.com/2020/10/21/deploy-hugo-with-github-actions-and-pages/">–ø–æ—Å—Ç—ñ&lt;/a>). –î–ª—è —Ç–æ–≥–æ —â–æ–± CNAME –ø–æ—Ç—Ä–∞–ø–∏–≤ –≤ –∫–æ—Ä—ñ–Ω—å –ø—ñ—Å–ª—è –¥–µ–ø–ª–æ—é –π–æ–≥–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø–æ–∫–ª–∞—Å—Ç–∏ –≤ –ø–∞–ø–∫—É static.&lt;/p>
&lt;p>&lt;img src="https://i.imgur.com/6zaK6Q1.png" alt="CNAME">&lt;/p>
&lt;p>–û—Å—Ç–∞–Ω—ñ–º –∫—Ä–æ–∫–æ–º —è –≤–∫–∞–∂—É –Ω–æ–≤–µ –¥–æ–º–µ–Ω–Ω–µ —ñ–º&amp;rsquo;—è –≤ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è—Ö GitHub Pages —Ä–µ–ø–æ–∑–∏—Ç—Ä—ñ—è. –î–ª—è —Ü—å–æ–≥–æ –≤—ñ–¥–∫—Ä–∏—Ç–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π —Ç–∞ –Ω–∞—Ç–∏—Å–Ω—É—Ç–∏ &lt;code>Settings&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://i.imgur.com/yXAnZ0q.png" alt="Settings">&lt;/p>
&lt;p>–¢–∞–º –∑–Ω–∞–π—Ç–∏ —Å–µ–∫—Ü—ñ—é —è–∫–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –∑–∞ GitHub Pages. –í –ø–æ–ª—ñ Custom domain –≤–∫–∞–∑–∞—Ç–∏ —Å–≤–æ—î –∑–Ω–∞—á–µ–Ω–Ω—è —Ç–∞ –Ω–∞—Ç–∏—Å–Ω—É—Ç–∏ Save. –û–ø—Ü—ñ—è Enforce HTTPS —Å—Ç–∞–Ω–µ –¥–æ—Å—Ç—É–ø–Ω–æ—é –ø—Ä–æ—Ç—è–≥–æ–º 24 –≥–æ–¥–∏–Ω, —Ä–µ–∫–æ–º–µ–Ω–¥—É—é —ó—ó —Ç–∞–∫–æ–∂ –≤–∫–ª—é—á–∏—Ç–∏.&lt;/p>
&lt;p>&lt;img src="https://i.imgur.com/PE502gk.png" alt="PagesSetting">&lt;/p>
&lt;p>–Ü —Ç–µ–ø–µ—Ä –ø–µ—Ä–µ–π—à–æ–≤—à–∏ –Ω–∞ &lt;code>mpostument.github.io&lt;/code> —è –±—É–¥—É –æ–¥—Ä–∞–∑—É –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π –Ω–∞ &lt;code>mpostument.com&lt;/code>&lt;/p></content></item><item><title>Deploy Hugo With Github Actions and Pages</title><link>/ua/2020/10/21/deploy-hugo-with-github-actions-and-pages/</link><pubDate>Wed, 21 Oct 2020 20:19:26 +0300</pubDate><guid>/ua/2020/10/21/deploy-hugo-with-github-actions-and-pages/</guid><description>–ü—Ä–∏–≤—ñ—Ç!
–•–æ—á—É –ø–æ–∫–∞–∑–∞—Ç–∏ —è–∫ –º–æ–∂–Ω–∞ –¥–µ–ø–ª–æ—ó—Ç–∏ hugo –≤–µ–±—Å–∞–π—Ç –≤ GitHub Pages –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é github actions. –°–∞–º–µ —Ç–∞–∫ —è –¥–µ–ø–ª–æ—é —Å–≤—ñ–π —Å–∞–π—Ç.
Install Hugo Hugo –º–æ–∂–Ω–∞ —Å–∫–∞—á–∞—Ç–∏ –∑ GitHub. –Ü –ø–æ–∫–ª–∞—Å—Ç–∏ binary –≤ —Ñ–∞–π–ª –≤ –ø–æ—Ç—Ä—ñ–±–Ω—É –ª–æ–∫–∞—Ü—ñ—é.
GitHub setup –í github –ø–æ—Ç—Ä—ñ–±–Ω–æ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –¥–≤–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—è, –æ–¥–∏–Ω –≤ —è–∫–æ–º—É –±—É–¥—É—Ç—å –∑–±–µ—Ä—ñ–≥–∞—Ç–∏—Å—å .md —Ñ–∞–π–ª–∏ —Ç–∞ —Ç–µ–º–∞ (content-mpostument –≤ –º–æ—î–º—É –≤–∏–ø–∞–¥–∫—É) –≤ —ñ–Ω—à–∏–π –±—É–¥–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏—Å—å –¥–ª—è GitHub Pages, –≤ —è–∫–∏–π –±—É–¥–µ –¥–µ–ø–ª–æ—ó—Ç–∏—Å—å —Å–∞–π—Ç –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∏–π hugo (mpostument.</description><content>&lt;p>–ü—Ä–∏–≤—ñ—Ç!&lt;/p>
&lt;p>–•–æ—á—É –ø–æ–∫–∞–∑–∞—Ç–∏ —è–∫ –º–æ–∂–Ω–∞ –¥–µ–ø–ª–æ—ó—Ç–∏ hugo –≤–µ–±—Å–∞–π—Ç –≤ GitHub Pages –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é github actions. –°–∞–º–µ —Ç–∞–∫ —è –¥–µ–ø–ª–æ—é —Å–≤—ñ–π —Å–∞–π—Ç.&lt;/p>
&lt;h2 id="install-hugo">Install Hugo&lt;/h2>
&lt;p>Hugo –º–æ–∂–Ω–∞ —Å–∫–∞—á–∞—Ç–∏ –∑ &lt;a href="https://github.com/gohugoio/hugo/releases">GitHub&lt;/a>. –Ü –ø–æ–∫–ª–∞—Å—Ç–∏ binary –≤ —Ñ–∞–π–ª –≤ –ø–æ—Ç—Ä—ñ–±–Ω—É –ª–æ–∫–∞—Ü—ñ—é.&lt;/p>
&lt;h2 id="github-setup">GitHub setup&lt;/h2>
&lt;p>–í github –ø–æ—Ç—Ä—ñ–±–Ω–æ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –¥–≤–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—è, –æ–¥–∏–Ω –≤ —è–∫–æ–º—É –±—É–¥—É—Ç—å –∑–±–µ—Ä—ñ–≥–∞—Ç–∏—Å—å .md —Ñ–∞–π–ª–∏ —Ç–∞ —Ç–µ–º–∞ (content-mpostument –≤ –º–æ—î–º—É –≤–∏–ø–∞–¥–∫—É) –≤ —ñ–Ω—à–∏–π –±—É–¥–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏—Å—å –¥–ª—è GitHub Pages, –≤ —è–∫–∏–π –±—É–¥–µ –¥–µ–ø–ª–æ—ó—Ç–∏—Å—å —Å–∞–π—Ç –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∏–π hugo (mpostument.github.io).&lt;/p>
&lt;p>&lt;img src="https://i.imgur.com/GnsuIEm.png" alt="Repository">&lt;/p>
&lt;p>–í &lt;code>mpostument.github.io&lt;/code> –∫–æ–¥ –±—É–¥–µ –¥–µ–ø–ª–æ—ó—Ç–∏—Å—å —á–µ—Ä–µ–∑ github actions. –†—É–∫–∞–º–∏ –∑–º—ñ–Ω–∏ —Å—é–¥–∏ –≤–Ω–æ—Å–∏—Ç–∏—Å—å –Ω–µ –±—É–¥—É—Ç—å.&lt;/p>
&lt;p>–ó–∞ –¥–æ–ø–æ–º–æ–≥–æ—é hugo —Å—Ç–≤–æ—Ä—é –Ω–æ–≤–∏–π —Å–∞–π—Ç. –ë—É–¥–µ —Å—Ç–≤–æ—Ä–µ–Ω–∞ –Ω–æ–≤–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—è &lt;code>hugodemo&lt;/code> –≤ –Ω—ñ–π —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—é git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π —Ç–∞ –¥–æ–±–∞–≤–ª—é remote –Ω–∞ &lt;code>content-mpostument&lt;/code>.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-shell" data-lang="shell">hugo new site hugodemo
cd hugodemo
git init
git remote add origin git@github.com:mpostument/content-mpostument.git
&lt;/code>&lt;/pre>&lt;/div>&lt;p>–¢–µ–ø–µ—Ä –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏–±—Ä–∞—Ç–∏ —Ç–µ–º—É –¥–ª—è —Å–∞–π—Ç—É. –¢–µ–º–∏ –º–æ–∂–Ω–∞ –ø–æ–¥–∏–≤–∏—Ç–∏—Å—å –Ω–∞ &lt;a href="https://themes.gohugo.io/">themes.gohugo&lt;/a>&lt;/p>
&lt;p>–î–ª—è —Å–≤–æ–≥–æ —Å–∞–π—Ç—É —è –æ–±—Ä–∞–≤ —Ç–µ–º—É &lt;a href="https://github.com/panr/hugo-theme-terminal/">Terminal&lt;/a>. –¢–µ–º—É –º–æ–∂–Ω–∞ —Å–∫–∞—á–∞—Ç–∏ –∞—Ä—Ö—ñ–≤–æ–º —ñ —Ä–æ–∑–ø–∞–∫—É–≤–∞—Ç–∏ –≤ –ø–∞–ø–∫—É &lt;code>themes&lt;/code> –∞–±–æ –¥–æ–±–∞–≤–∏—Ç–∏ —è–∫ submodule. –Ø –¥–æ–±–∞–≤–ª—é —è–∫ submodule –¥–ª—è —Ç–æ–≥–æ —â–æ–± –∑–∞–≤–∂–¥–∏ –º–∞—Ç–∏ –æ—Å—Ç–∞–Ω–Ω—é –≤–µ—Ä—Å—ñ—é —Ç–µ–º–∏.&lt;/p>
&lt;p>&lt;code>git submodule add https://github.com/panr/hugo-theme-terminal.git themes/terminal&lt;/code>.&lt;/p>
&lt;p>–ó–∞–∑–≤–∏—á–∞–π –¥–æ –∫–æ–∂–Ω–æ—ó —Ç–µ–º–∏ –π–¥–µ –ø—Ä–∏–∫–ª–∞–¥ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π–Ω–æ–≥–æ —Ñ–∞–π–ª—É. –Ø —Å–∫–æ–ø—ñ—é—é –π–æ–≥–æ –∑ github —Å—Ç–æ—Ä—ñ–Ω–∫–∏ —ñ –∑–±–µ—Ä–µ–∂—É –≤ —Ñ–∞–π–ª—ñ &lt;code>config.toml&lt;/code>. –î–∞–ª—ñ –º–æ–∂–Ω–∞ –π–æ–≥–æ –ø—ñ–¥–ª–∞—à—Ç–æ–≤—É–≤–∞—Ç–∏ –ø—ñ–¥ —Å–≤–æ—ó –ø–æ—Ç—Ä–µ–±–∏.&lt;/p>
&lt;p>–¢–µ–ø–µ—Ä –º–æ–∂–Ω–∞ –∑–∞–ø—É—Å—Ç–∏—Ç–∏ —Å–∞–π—Ç —ñ –ø–æ–¥–∏–≤–∏—Ç–∏—Å—å —è–∫ –≤—ñ–Ω –≤–∏–≥–ª—è–¥–∞—Ç–∏–º–µ &lt;code>hugo serve -D&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://i.imgur.com/yFdQHA5.png" alt="HugoExample">&lt;/p>
&lt;h2 id="github-actions">Github Actions&lt;/h2>
&lt;p>–î–ª—è —Ç–æ–≥–æ —â–æ–± GitHub actions –ø—Ä–∞—Ü—é–≤–∞–≤, –≤ –∫–æ—Ä–µ–Ω—ñ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—è –ø–æ—Ç—Ä—ñ–±–Ω–æ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –ø–∞–ø–∫—É &lt;code>.github/workflows&lt;/code> –≤ —è–∫—ñ–π —Å—Ç–≤–æ—Ä–∏—Ç–∏ yml —Ñ–∞–π–ª –∑ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—î—é –¥–ª—è Actions. –í &lt;code>on&lt;/code> —Å–µ–∫—Ü—ñ—ó —è –≤–∫–∞–∑—É—é –∑–∞–ø—É—Å–∫–∞—Ç–∏ –±—ñ–ª–¥ —Ç—ñ–ª—å–∫–∏ –Ω–∞ push –≤ master –±—Ä–µ–Ω—á—É.&lt;/p>
&lt;p>–í &lt;code>steps&lt;/code> —è –≤–∏–∫–ª–∏–∫–∞—é –ø–æ —á–µ—Ä–∑—ñ –¥–µ–∫—ñ–ª—å–∫–∞ actions. –ü–æ—á–∏–Ω–∞—î—Ç—å—Å—è pipeline –∑ –∫–ª–æ–Ω—É–≤–∞–Ω–Ω—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—è. –ü—ñ—Å–ª—è —Ü—å–æ–≥–æ —è –≤–∏–∫–ª–∏–∫–∞—é &lt;code>git submodule update --init --recursive&lt;/code> –¥–ª—è —Ç–æ–≥–æ —â–æ–± –æ–Ω–æ–≤–∏—Ç–∏ —Ç–µ–º—É –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é submodule. –ù–∞—Å—Ç—É–ø–Ω–∏–º –∫—Ä–æ–∫–æ–º –≤—Å—Ç–∞–Ω–æ–≤–ª—é—é –ø–æ—Ç—Ä—ñ–±–Ω—É –≤–µ—Ä—Å—ñ—ó hugo —Ç–∞ –≤–∏–∫–ª–∏–∫–∞—é &lt;code>hugo --minify&lt;/code> –¥–ª—è —Ç–æ–≥–æ —â–æ–± –∑–≥–µ–Ω–µ–Ω—Ä—É–≤–∞—Ç–∏ —Å—Ç–∞—Ç–∏—á–Ω–∏–π —Å–∞–π—Ç –∑ .md —Ñ–∞–π–ª—ñ–≤ —Ç–∞ —Ç–µ–º–∏. –Ü –æ—Å—Ç–∞–Ω—ñ–º –∫—Ä–æ–∫–æ–º —è –¥–µ–ø–ª–æ—é –∫–æ–Ω—Ç–µ–Ω—Ç –∑ &lt;code>./public&lt;/code> –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó. –í–æ–Ω–∞ –∑&amp;rsquo;—è–≤–ª—è—î—Ç—å—Å—è –ø—ñ—Å–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∫–æ–º–∞–Ω–¥–∏ &lt;code>hugo --minify&lt;/code>. –Ø–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ —Ç–∞–∫–æ–∂ –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç–∏ —ñ–º&amp;rsquo;—è git –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, –µ–º–µ–π–ª, –±—Ä–µ–Ω—á—É —Ç–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π –≤ —è–∫—É –∑–¥—ñ–π—Å–Ω—é–≤–∞—Ç–∏ –¥–µ–ø–ª–æ–π.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-yml" data-lang="yml">&lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">CI&lt;/span>
&lt;span style="color:#f92672">on&lt;/span>:
&lt;span style="color:#f92672">push&lt;/span>:
&lt;span style="color:#f92672">branches&lt;/span>:
- &lt;span style="color:#ae81ff">master&lt;/span>
&lt;span style="color:#f92672">jobs&lt;/span>:
&lt;span style="color:#f92672">deploy&lt;/span>:
&lt;span style="color:#f92672">runs-on&lt;/span>: &lt;span style="color:#ae81ff">ubuntu-18.04&lt;/span>
&lt;span style="color:#f92672">steps&lt;/span>:
- &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">Git checkout&lt;/span>
&lt;span style="color:#f92672">uses&lt;/span>: &lt;span style="color:#ae81ff">actions/checkout@v2.3.3&lt;/span>
- &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">Update theme&lt;/span>
&lt;span style="color:#f92672">run&lt;/span>: &lt;span style="color:#ae81ff">git submodule update --init --recursive&lt;/span>
- &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">Setup hugo&lt;/span>
&lt;span style="color:#f92672">uses&lt;/span>: &lt;span style="color:#ae81ff">peaceiris/actions-hugo@v2.4.13&lt;/span>
&lt;span style="color:#f92672">with&lt;/span>:
&lt;span style="color:#f92672">hugo-version&lt;/span>: &lt;span style="color:#e6db74">&amp;#39;0.76.5&amp;#39;&lt;/span>
- &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">Build&lt;/span>
&lt;span style="color:#f92672">run&lt;/span>: &lt;span style="color:#ae81ff">hugo --minify&lt;/span>
- &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">Deploy&lt;/span>
&lt;span style="color:#f92672">uses&lt;/span>: &lt;span style="color:#ae81ff">peaceiris/actions-gh-pages@v3.7.3&lt;/span>
&lt;span style="color:#f92672">with&lt;/span>:
&lt;span style="color:#f92672">personal_token&lt;/span>: &lt;span style="color:#ae81ff">${{ secrets.GH_TOKEN }}&lt;/span>
&lt;span style="color:#f92672">external_repository&lt;/span>: &lt;span style="color:#ae81ff">mpostument/mpostument.github.io&lt;/span>
&lt;span style="color:#f92672">publish_dir&lt;/span>: &lt;span style="color:#ae81ff">./public&lt;/span>
&lt;span style="color:#f92672">user_name&lt;/span>: &lt;span style="color:#ae81ff">mpostument&lt;/span>
&lt;span style="color:#f92672">user_email&lt;/span>: &lt;span style="color:#ae81ff">777rip777@gmail.com&lt;/span>
&lt;span style="color:#f92672">publish_branch&lt;/span>: &lt;span style="color:#ae81ff">master&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>–¢–µ–ø–µ—Ä —Ü–µ –º–æ–∂–Ω–∞ –∑–∞–∫–æ–º—ñ—Ç–∏—Ç–∏ –≤ github —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π —ñ –ø—Ä–∏ –º–µ—Ä–¥–∂—ñ –≤ –º–∞—Å—Ç–µ—Ä –±—ñ–ª–¥ –º–∞—î –∑–∞–ø—É—Å—Ç–∏—Ç–∏—Å—å.&lt;/p>
&lt;p>&lt;img src="https://i.imgur.com/1Vfl3A8.png" alt="ActionBuild">&lt;/p>
&lt;p>–Ø–∫ —Ç—ñ–ª—å–∫–∏ –±—ñ–ª–¥ –ø—Ä–æ–π—à–æ–≤ –Ω–æ–≤—ñ —Ñ–∞–π–ª–∏ –º–∞—é—Ç—å –æ–¥—Ä–∞–∑—É –∑—è–≤–∏—Ç–∏—Å—å –≤ Github Pages —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó &lt;code>mpostument.github.io&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://i.imgur.com/emHfquj.png" alt="DeployStatus">&lt;/p>
&lt;p>–ß–µ—Ä–µ–∑ –¥–µ–∫—ñ–ª—å–∫–∞ —Ö–≤–∏–ª–∏–Ω –≤–µ–±—Å–∞–π—Ç –±—É–¥–µ –¥–æ—Å—Ç—É–ø–Ω–∏–π –∑–∞ –∞–¥—Ä–µ—Å–æ–º &lt;code>mpostument.github.io&lt;/code>&lt;/p></content></item><item><title>Deploy to ec2 with codedship</title><link>/ua/2020/09/16/deploy-to-ec2-with-codeship/</link><pubDate>Wed, 16 Sep 2020 20:24:40 +0300</pubDate><guid>/ua/2020/09/16/deploy-to-ec2-with-codeship/</guid><description>–ü—Ä–∏–≤—ñ—Ç!
–°—å–æ–≥–æ–¥–Ω—ñ —è —Ö–æ—á—É –ø–æ–∫–∞–∑–∞—Ç–∏ —è–∫ –º–æ–∂–Ω–∞ –∑–∞–¥–µ–ø–ª–æ—ó—Ç–∏ –∫–æ–¥ –Ω–∞ AWS EC2 –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é CodeShip Basic. –î–ª—è —Ü—å–æ–≥–æ —è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—é —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—é Codeship –∑ AWS CodeDeploy.
CodeShip Configuration –°–ø–æ—á–∞—Ç–∫—É –ø–æ—Ç—Ä—ñ–±–æ –¥–æ–±–∞–≤–∏—Ç–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π –≤ CodeShip —ñ –ø–µ—Ä–µ–π—Ç–∏ –≤ –≤–∫–ª–∞–¥—É Deploy. –Ü –¥–æ–±–∞–≤–∏—Ç–∏ branch –∑ —è–∫–æ—ó –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –¥–µ–ø–ª–æ–π –Ω–∞ ec2. –í –º–æ—î–º—É –≤–∏–ø–∞–¥–∫—É branch master –≤–∂–µ —î –¥–æ–±–∞–≤–ª–µ–Ω–∞. –ü—ñ—Å–ª—è —Ç–æ–≥–æ —è–∫ branch –¥–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø—Ä–æ—Å–∫—Ä–æ–ª–∏—Ç–∏ –≤ –Ω–∏–∑ –¥–æ —Å–µ–∫—Ü—ñ—ó Deployment. –Ü –≤–∏–±—Ä–∞—Ç–∏ CodeDeploy –û–¥—Ä–∞–∑—É –∑—è–≤–∏—Ç—å—Å—è –Ω–∞—Å—Ç—É–ø–Ω–∞ —Ñ–æ—Ä–º–∞ –¢—É—Ç –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–≤–µ—Å—Ç–∏ Access and Secret Keys –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —è–∫–∏–π –±—É–¥–µ –∑–¥—ñ–π—Å–Ω—é–≤–∞—Ç–∏ –¥–µ–ø–ª–æ–π.</description><content>&lt;p>–ü—Ä–∏–≤—ñ—Ç!&lt;/p>
&lt;p>–°—å–æ–≥–æ–¥–Ω—ñ —è —Ö–æ—á—É –ø–æ–∫–∞–∑–∞—Ç–∏ —è–∫ –º–æ–∂–Ω–∞ –∑–∞–¥–µ–ø–ª–æ—ó—Ç–∏ –∫–æ–¥ –Ω–∞ AWS EC2 –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é CodeShip Basic.
–î–ª—è —Ü—å–æ–≥–æ —è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—é —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—é Codeship –∑ AWS CodeDeploy.&lt;/p>
&lt;h2 id="codeship-configuration">CodeShip Configuration&lt;/h2>
&lt;p>–°–ø–æ—á–∞—Ç–∫—É –ø–æ—Ç—Ä—ñ–±–æ –¥–æ–±–∞–≤–∏—Ç–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π –≤ CodeShip —ñ –ø–µ—Ä–µ–π—Ç–∏ –≤ –≤–∫–ª–∞–¥—É Deploy.
&lt;img src="https://i.imgur.com/Zz2v8aZ.png" alt="Coeship1">&lt;/p>
&lt;p>–Ü –¥–æ–±–∞–≤–∏—Ç–∏ branch –∑ —è–∫–æ—ó –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –¥–µ–ø–ª–æ–π –Ω–∞ ec2. –í –º–æ—î–º—É –≤–∏–ø–∞–¥–∫—É branch master –≤–∂–µ —î –¥–æ–±–∞–≤–ª–µ–Ω–∞.
–ü—ñ—Å–ª—è —Ç–æ–≥–æ —è–∫ branch –¥–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø—Ä–æ—Å–∫—Ä–æ–ª–∏—Ç–∏ –≤ –Ω–∏–∑ –¥–æ —Å–µ–∫—Ü—ñ—ó Deployment. –Ü –≤–∏–±—Ä–∞—Ç–∏ CodeDeploy
&lt;img src="https://i.imgur.com/KVCmUDn.png" alt="Codeship2">&lt;/p>
&lt;p>–û–¥—Ä–∞–∑—É –∑—è–≤–∏—Ç—å—Å—è –Ω–∞—Å—Ç—É–ø–Ω–∞ —Ñ–æ—Ä–º–∞
&lt;img src="https://i.imgur.com/rfdRxKl.png" alt="CodeshipForm3">
–¢—É—Ç –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–≤–µ—Å—Ç–∏ Access and Secret Keys –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —è–∫–∏–π –±—É–¥–µ –∑–¥—ñ–π—Å–Ω—é–≤–∞—Ç–∏ –¥–µ–ø–ª–æ–π. –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –º–∞—î –º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ s3 —Ç–∞ CodeDeploy.
–í —Ä–µ–≥—ñ–æ–Ω –≤–∫–∞–∑–∞—Ç–∏ –≤–∞—à AWS Region –¥–µ –∑–Ω–∞—Ö–æ–¥–∏—Ç—Å—è –∞–ø–ª—ñ–∫–∞—Ü—ñ—è. –î–ª—è –º–µ–Ω–µ —Ü–µ us-east-1.&lt;br>
&lt;code>Application&lt;/code>, &lt;code>GroupName&lt;/code> –ø–æ—Ç—Ä—ñ–±–Ω–æ –±—É–¥–µ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –≤ AWS. –ó–Ω–∞—á–µ–Ω–Ω—è –≤–∞—Ä—Ç–æ –≤–∏–±–∏—Ä–∞—Ç–∏ —Ç–∞–∫–µ —â–æ–± –±—É–ª–æ –∑—Ä–æ–∑—É–º—ñ–ª–æ —è–∫–∞ –∞–ø–ª—ñ–∫–∞—Ü—è –¥–µ–ø–ª–æ—ó—Ç—å—Å—è. &lt;code>S3 Bucket&lt;/code> –º–æ–∂–µ –±—É—Ç–∏ —è–∫ –∑–∞–≥–∞–ª—å–Ω–∏–π –±–∞–∫–µ—Ç –∫—É–¥–∏ –±—É–¥—É—Ç—å –∑–¥—ñ–π—Å–Ω—é–≤–∞—Ç–∏ —É—Å—ñ –¥–µ–ø–ª–æ–π–º–µ–Ω—Ç–∏ —á–µ—Ä–µ—Ö codeship –∞–±–æ –æ–±—Ä–∞—Ç–∏ —ñ–Ω–¥–∏–≤—ñ–¥—É–∞–ª—å–Ω–µ —ñ–º&amp;rsquo;—è –¥–ª—è –æ–¥–Ω—ñ—î—ó –∞–ø–ª—ñ–∫–∞—Ü—ñ—ó. –í –º–æ—î–º—É –≤–∏–ø–∞–¥–∫—É —Ü–µ CodeShipEc2Deployment.&lt;br>
–Ü –æ—Å—Ç–∞–Ω—î —Ü–µ &lt;code>Config Name&lt;/code> –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∫–∞–∑–∞—Ç–∏ –Ω–∞–∑–≤—É –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó –≤ CodeDeploy. –Ø –≤—ñ–∑—å–º—É —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É &lt;code>CodeDeployDefault.AllAtOnce&lt;/code>. –¶–µ –æ–∑–Ω–∞—á–∞—î —â–æ –¥–µ–ø–ª–æ–π –±—É–¥–µ –≤—ñ–¥–±—É–≤–∞—Ç–∏—Å—å –æ–¥—Ä–∞–∑—É –Ω–∞ –≤—Å—ñ ec2 —ñ–Ω—Å—Ç–∞–Ω—Å–∏&lt;/p>
&lt;p>–¢–µ–ø–µ—Ä –∑ CodeShip –∑–∞–∫—ñ–Ω—á–µ–Ω–æ —ñ –º–æ–∂–Ω–∞ –ø—Ä–∏—Å—Ç—É–ø–∞—Ç–∏ –¥–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è AWS.&lt;/p>
&lt;h2 id="codedeploy-configuration">CodeDeploy Configuration&lt;/h2>
&lt;p>–í—ñ–¥–∫—Ä–∏—Ç–µ CodeDeploy —Å–µ—Ä–≤—ñ—Å –≤ AWS.&lt;br>
&lt;img src="https://i.imgur.com/cTv6l3Y.png" alt="CodeDeploy">
–í —Å–µ–∫—Ü—ñ—ó Deployment –∑–Ω–∞–π–¥—ñ—Ç—å Applications&lt;br>
&lt;img src="https://i.imgur.com/BAZ6E6d.png" alt="Applications">&lt;br>
–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å Create Application. –í–≤–µ–¥—ñ—Ç—å –Ω–∞–∑–≤—É —Ç–∞–∫—É –∂ —è–∫ —ñ –≤ Codeship –≤ —Å–µ–∫—Ü—ñ—ó &lt;code>Application&lt;/code>. –Ø–∫ Compute Platform –æ–±–µ—Ä—ñ—Ç—å EC2
&lt;img src="https://i.imgur.com/zAXUxuF.png" alt="CreateApplication">
–í—ñ–¥–∫—Ä–∏–π—Ç–µ —Ç—ñ–ª—å–∫–∏ —â–æ —Å—Ç–≤–æ—Ä–µ–Ω—É &lt;code>Application&lt;/code> —ñ –≤ &lt;code>Deployment Groups&lt;/code> –æ–±–µ—Ä—ñ—Ç—å &lt;code>Create Deployment Group&lt;/code>&lt;br>
&lt;img src="https://i.imgur.com/5wfA0VU.png" alt="DeploymentGroup">
–í &lt;code>Deployment group name&lt;/code> –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∫–∑–∞—Ç–∏ —Ç–∞–∫—É –∂ –Ω–∞–∑–≤—É —è–∫–∞ –±—É–ª–∞ –≤–∫–∞–∑–∞–Ω–∞ –≤ CodeShip.
–í &lt;code>ServiceRole&lt;/code> –ø–æ—Ç—Ä—ñ–±–Ω–æ –æ–±—Ä–∞—Ç–∏ —Ä–æ–ª—å —è–∫–∞ –¥–æ–∑–≤–æ–ª–∏—Ç—å –∑–¥—ñ–π—Å–Ω—é–≤–∞—Ç–∏ –¥–µ–ø–ª–æ–π –Ω–∞ ec2. –•–æ—Ä–æ—à–∏–π –ø—Ä–∏–∫–ª–∞–¥ —Ä–æ–ª—ñ –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ &lt;a href="https://docs.aws.amazon.com/codedeploy/latest/userguide/getting-started-create-service-role.html">—Ç—É—Ç&lt;/a>.&lt;/p>
&lt;p>–í &lt;code>Environment configuration&lt;/code> –æ–±–µ—Ä—ñ—Ç—å ec2. –î–∞–ª—ñ –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∫–∞–∑–∞—Ç–∏ —è–∫–∏–π tag –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏—Å—å –¥–ª—è —Ñ—ñ–ª—å—Ç—Ä–∞ ec2. –ù–∞–ø—Ä–∏–∫–ª–∞–¥ —Ü–µ –º–æ–∂–µ –±—É–¥–µ Key=Name, Value=ProductionApplication. –¢—É—Ç –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –±—É–¥—å —è–∫—ñ —Ç–µ–≥–∏ —è–∫—ñ —î –Ω–∞ –≤–∞—à–æ–º—É ec2 –Ω–∞ —è–∫–∏–π –º–∞—î –∑–¥—ñ–π—Å–Ω—é–≤–∞—Ç–∏ –¥–µ–ø–ª–æ–π–º–µ–Ω—Ç.&lt;br>
&lt;img src="https://i.imgur.com/ffGKRQV.png" alt="Ec2Filter">&lt;/p>
&lt;h2 id="ec2-configuration">Ec2 Configuration&lt;/h2>
&lt;p>–î–ª—è ec2 –±—É–¥–µ –ø–æ—Ç—Ä—ñ–±–Ω–∞ —â–µ –æ–¥–Ω–∞ —Ä–æ–ª—å. –Ø–∫—ñ –¥–æ—Å—Ç—É–ø–∏ –≤–æ–Ω–∞ –º–∞—î –º–∞—Ç–∏ –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ &lt;a href="https://docs.aws.amazon.com/codedeploy/latest/userguide/instances-ec2-configure.html#instances-ec2-configure-2-verify-instance-profile-permissions">—Ç—É—Ç&lt;/a>&lt;/p>
&lt;p>–ü—ñ—Å–ª—è —Ç–æ–≥–æ —è–∫ —Ä–æ–ª—å —Å—Ç–≤–æ—Ä–µ–Ω–∞ —ó—ó –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–∞–∞—Å–∞–π–Ω–∏—Ç–∏ –Ω–∞ ec2 —ñ–Ω—Å—Ç–∞–Ω—Å. –î–ª—è —Ü—å–æ–≥–æ –æ–±–µ—Ä—ñ—Ç—å –ø–æ—Ç—Ä—ñ–±–Ω–∏–π ec2. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –ø—Ä–∞–≤–æ—é –∫–Ω–æ–ø–∫–æ—é –º–∏—à—ñ —ñ –≤–∏–±–µ—Ä—ñ—Ç—å Attach Role
&lt;img src="https://i.imgur.com/uaIUcyg.png" alt="AttachRole">
–í —Å–ø–∏–∫—É –∑–Ω–∞–π–¥—ñ—Ç—å –≤–∏—â–µ —Å—Ç–≤–æ—Ä–µ–Ω—É —Ä–æ–ª—å.&lt;br>
–¢–µ–ø–µ—Ä –Ω–∞ ec2 —ñ–Ω—Å—Ç–∞–Ω—Å –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø–æ—Å—Ç–∞–≤–∏—Ç–∏ CodeDeploy Agent. –î–ª—è —Ü—å–æ–≥–æ –ø—ñ–¥–∫–ª—é—á—ñ—Ç—å—Å—è –¥–æ —Å–µ—Ä–≤–µ—Ä–∞ –ø–æ ssh
&lt;code>ssh -i private_key ec2-user@IP&lt;/code>. –î–∞–ª—ñ –±—É–¥–µ –ø—Ä–∏–∫–ª–∞–¥ –¥–ª—è AmazonLinux. –Ø–∫—â–æ –≤ –≤–∞—Å —ñ–Ω—à–∞ OS –∫–æ–º–∞–Ω–¥–∏ –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ &lt;a href="https://docs.aws.amazon.com/codedeploy/latest/userguide/codedeploy-agent-operations-install-cli.html">—Ç—É—Ç&lt;/a>.&lt;/p>
&lt;ul>
&lt;li>–°–∫–∞—á–∞—Ç–∏ —ñ–Ω—Å—Ç–∞–ª—è—Ü—ñ—é &lt;code>wget https://aws-codedeploy-us-east-1.s3.us-east-1.amazonaws.com/latest/install&lt;/code>&lt;/li>
&lt;li>–ù–∞–¥–∞—Ç–∏ –ø–µ—Ä–º—ñ—à–∏–Ω–∏ &lt;code>sudo chmod +x install&lt;/code>&lt;/li>
&lt;li>–í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ &lt;code>sudo ./install auto&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —á–∏ –∞–≥–µ–Ω—Ç –∑–∞–ø—É—â–µ–Ω–æ –º–æ–∂–Ω–∞ –∫–æ–º–∞–Ω–¥–æ—é &lt;code>sudo service codedeploy-agent status&lt;/code>. –†–µ–∑—É–ª—å—Ç–∞—Ç –º–∞—î –±—É—Ç–∏ –æ—Ä—ñ—î–Ω—Ç–æ–≤–Ω–æ —Ç–∞–∫–∏–π &lt;code>The AWS CodeDeploy agent is running as PID 32466&lt;/code>.&lt;br>
–¢–∞–∫–æ–∂ –ø–æ—Ç—Ä—ñ–±–Ω–æ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –ø–∞–ø–∫—É –≤ —è–∫—ñ –±—É–¥–µ –∑–Ω–∞—Ö–æ–¥–∏—Ç–∏—Å—å –∞–ø–ª—ñ–∫–∞—Ü—ñ—è &lt;code>mkdir /opt/application&lt;/code> —ñ –¥–∞—Ç–∏ –ø–µ—Ä–º—ñ—à–∏–Ω –¥–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞. –Ø –≤–∏–∫–æ–∏—Å—Ç–æ–≤—É—é ec2-user &lt;code>chown ec2-user:ec2-user /opt/application&lt;/code>&lt;/p>
&lt;h2 id="deployment-script">Deployment Script&lt;/h2>
&lt;p>–í –∫–æ—Ä–µ–Ω—ñ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—è –ø–æ—Ç—Ä—ñ–±–Ω–æ —Å—Ç–≤–æ—Ä–∏—Ç–∏ —Ñ–∞–π–ª —è–∫–∏–π –º–∞—î –Ω–∞–∑–∏–≤–∞—Ç–∏—Å—å &lt;code>appspec.yml&lt;/code>. –¢—É—Ç –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ –≤—Å—ñ –æ–ø—Ü—ñ—ó —è–∫—ñ –ø—ñ–¥—Ç—Ä–∏–º—É—î —Ü–µ–π —Ñ–∞–π–ª - &lt;a href="https://docs.aws.amazon.com/codedeploy/latest/userguide/reference-appspec-file.html">AWS&lt;/a>.&lt;/p>
&lt;p>–û—Å—å –ø—Ä–∏–∫–ª–∞–¥ –º–æ–≥–æ —Ñ–∞–π–ª–∞:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-yml" data-lang="yml">&lt;span style="color:#f92672">version&lt;/span>: &lt;span style="color:#ae81ff">0.0&lt;/span>
&lt;span style="color:#f92672">os&lt;/span>: &lt;span style="color:#ae81ff">linux&lt;/span>
&lt;span style="color:#f92672">files&lt;/span>:
- &lt;span style="color:#f92672">source&lt;/span>: &lt;span style="color:#ae81ff">/&lt;/span>
&lt;span style="color:#f92672">destination&lt;/span>: &lt;span style="color:#ae81ff">/opt/application&lt;/span>
&lt;span style="color:#f92672">permissions&lt;/span>:
- &lt;span style="color:#f92672">object&lt;/span>: &lt;span style="color:#ae81ff">/opt/application&lt;/span>
&lt;span style="color:#f92672">owner&lt;/span>: &lt;span style="color:#ae81ff">ec2-user&lt;/span>
&lt;span style="color:#f92672">group&lt;/span>: &lt;span style="color:#ae81ff">ec2-user&lt;/span>
&lt;span style="color:#f92672">hooks&lt;/span>:
&lt;span style="color:#f92672">AfterInstall&lt;/span>:
- &lt;span style="color:#f92672">location&lt;/span>: &lt;span style="color:#ae81ff">ops/deploybuild.sh&lt;/span>
&lt;span style="color:#f92672">runas&lt;/span>: &lt;span style="color:#ae81ff">ec2-user&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>version&lt;/code> –º–∞—î —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è —ñ –º—ñ–Ω—è—Ç–∏ –π–æ–≥–æ –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ. 0.0 –Ñ–¥–∏–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è —è–∫ –ø—ñ–¥—Ç—Ä–∏–º—É—î—Ç—å—Å—è
&lt;code>os&lt;/code> –º–æ–∂–µ –±—É—Ç–∏ –¥–≤–æ—Ö –∑–Ω–∞—á–µ–Ω–Ω—è windows –∞–±–æ linux, –æ—Å–∫—ñ–ª—å–∫–∏ –≤ –º–µ–Ω–µ OS –Ω–∞ EC2 AmazonLinux —è –æ–±–∏—Ä–∞—é linux
&lt;code>files&lt;/code> –≤–∫–∞–∑—É—î —è–∫—ñ —Ñ–∞–π–ª–∏ –ø–æ—Ç—Ä—ñ–±–Ω–æ –∫–æ–ø—ñ—é–≤–∞—Ç–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä –ø—ñ–¥ —á–∞—Å –¥–µ–ø–ª–æ–π–º–µ–Ω—Ç—É. &lt;code>source: /&lt;/code> –æ–∑–Ω–∞—á–∞—î –∫–æ–ø—ñ—é–≤–∞—Ç–∏ –≤—Å—ñ —Ñ–∞–π–ª–∏. &lt;code>destination&lt;/code> –∫—É–¥–∏ –∫–æ–ø—ñ—é–≤–∞—Ç–∏.&lt;br>
–í &lt;code>permissions&lt;/code> –∑–∞–∑–Ω–∞—á–µ–Ω–æ —è–∫—ñ –ø–µ—Ä–º—ñ—à–∏–Ω–∏ –º–∞—é—Ç—å –º–∞—Ç–∏ —â–æ–π–Ω–æ —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω—ñ —Ñ–∞–π–ª–∏.&lt;br>
–í &lt;code>hooks&lt;/code> —Å–µ–∫—Ü—ñ—ó –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è –∞–ø–ª—ñ–∫–∞—Ü—ñ—ó. –Ø –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é &lt;code>AfterInstall&lt;/code> hook. –¶–µ –æ–∑–Ω–∞—á–∞—î —â–æ —Å–∫—Ä–∏–ø—Ç –±—É–¥–µ –∑–∞–ø—É—â–µ–Ω–æ –ø—ñ—Å–ª—è &lt;code>Install&lt;/code> –∫—Ä–æ–∫—É. –ü—ñ–¥ —á–∞—Å &lt;code>Install&lt;/code> –∫—Ä–æ–∫—É —Ñ–∞–π–ª–∏ –∫–æ–ø—ñ—é—é—Ç—å—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä. –í &lt;code>location&lt;/code> –≤–∫–∞–∑–∞–Ω–æ —è–∫–∏–π —Å–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞—Ç–∏ —Ç–∞ –≤—ñ–¥ –π–æ–≥–æ –∫–æ—Ä–∏—Å—É–≤–∞—á–∞. &lt;code>runas&lt;/code> –æ–∑–Ω–∞—á–∞—î —â–æ —Å–∫—Ä–∏–ø—Ç –±—É–¥–µ –≤–∏–∫–ª–∏–∫–∞—Ç–∏—Å—å –≤—ñ–¥ —ñ–º–µ–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞. –ü–æ –¥–µ—Ñ–æ–ª—Ç—É code-deploy agent –∑–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è –≤—ñ–¥ —Ä—É—Ç–∞ —ñ runas –Ω–∞ —Ü—å–æ–º—É –µ—Ç–∞–ø—ñ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –Ω–∞ ec2-user. –¢–∞–∫–æ–∂ –º–æ–∂–Ω–∞ –ø–æ–º—ñ–Ω—è—Ç–∏ —â–æ–± code-deploy agent –∑–∞–ø—É—Å–∫–∞–≤—Å—è –æ–¥–∞—Ä–∑—É –≤—ñ–¥ ec2-user.&lt;/p>
&lt;p>–î–∞–ª—ñ –Ω–∞–º –ø–æ—Ç—Ä—ñ–±–µ–Ω –¥–µ–ø–ª–æ–π —Å–∫—Ä–∏–ø—Ç. –í —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó —è —Å—Ç–≤–æ—Ä–∏–≤ –ø–∞–ø–∫—É ops –æ—Å–∫—ñ–ª—å–∫–∏ —à–ª—è—Ö –¥–æ –º–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞ &lt;code>- location: ops/deploybuild.sh&lt;/code>. –Ü –≤ —Ü—ñ–π –ø–∞–ø–∫—É —Å—Ç–≤–æ—Ä–∏–≤ —Å–∫—Ä–∏–ø—Ç &lt;code>deploybuild.sh&lt;/code>.
–í –º–µ–Ω–µ node.js –∞–ø–ª—ñ–∫–∞—Ü—ñ—ó –¥–ª—è —è–∫–æ—é –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑—Ä–æ–±–∏—Ç–∏ yarn install —Ç–∞ npm start. –Ø —Ü–µ –¥–æ–±–∞–≤–ª—é –≤ —Å–∫—Ä–∏–ø—Ç&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#75715e">#!/usr/bin/env bash
&lt;/span>&lt;span style="color:#75715e">&lt;/span>cd /opt/application
yarn --ignore-engines
cd examples/demo-app/
&lt;span style="color:#f92672">(&lt;/span>npm run start-prod&lt;span style="color:#f92672">)&lt;/span>&amp;amp;
&lt;/code>&lt;/pre>&lt;/div>&lt;p>–¶–µ –±–∞–∑–æ–≤–∏–π —Å–∫—Ä–∏–ø—Ç —è–∫ –º–æ–∂–Ω–∞ –∑–∞–ø—É—Å—Ç–∏—Ç–∏ node –∞–ø–ª—ñ–∫–∞—Ü—ñ—é. –î–ª—è –ø—Ä–æ–¥–∞–∫—à–∏–Ω–∞ –≤–∞—Ä—Ç–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ pm2 –¥–ª—è —Å—Ç–∞—Ä—Ç—É js –∞–ø–ª—ñ–∫–∞—Ü—ñ–π.
–¢–µ–ø–µ—Ä –∑–∞–ª–∏—à–∏–ª–æ—Å—å –∑—Ä–æ–±–∏—Ç–∏ –∫–æ–º—ñ—Ç –≤ master branch —ñ codedeploy –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ&lt;/p></content></item><item><title>Get Lambdas in Vpc With Go</title><link>/ua/2020/09/01/get-lambdas-in-vpc-with-go/</link><pubDate>Tue, 01 Sep 2020 17:40:16 +0300</pubDate><guid>/ua/2020/09/01/get-lambdas-in-vpc-with-go/</guid><description>–ü—Ä–∏–≤—ñ—Ç!
–°—å–æ–≥–æ–¥–Ω—ñ —è —Ö–æ—á—É —Ä–æ–∑–∫–∞–∑–∞—Ç–∏ —è–∫ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é go –º–æ–∂–Ω–∞ –æ—Ç—Ä–∏–º–∞—Ç–∏ —Å–ø–∏—Å–æ–∫ –≤—Å—ñ—Ö AWS Lambda —è–∫—ñ –∑–Ω–∞—Ö–æ–¥—è—Ç—å—Å—è –≤ VPC. –î–ª—è –ø–æ—á–∞—Ç–∫—É –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ golang. –û—Å—Ç–∞–Ω—é –≤–µ—Ä—Å—ñ—é –º–æ–∂–Ω–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∑ –æ—Ñ—ñ—Ü—ñ–π–Ω–æ–≥–æ —Å–∞–π—Ç—É.
–ü—ñ—Å–ª—è —Ç–æ–≥–æ —è–∫ golang –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ —Å—Ç–≤–æ—Ä—ñ—Ç—å –ø–∞–ø–∫—É –¥–ª—è —Å–∫—Ä–∏–ø—Ç—ñ–≤ mkdir awsscripts
–î–∞–ª—ñ –ø–æ—Ç—Ä—ñ–±–Ω–æ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ go.mod —Ñ–∞–π–ª. –¶–µ–π —Ñ–∞–π–ª –≤ —è–∫–æ–º—É –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –≤—Å—ñ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω—ñ –ø–∞–∫–µ—Ç–∏, —ñ –æ–¥–Ω–æ—á–∞—Å–Ω–æ –∑—Ä–æ–±–∏—Ç—å go –∫–æ–¥ –º–æ–¥—É–ª–µ–º. –Ü –≤ –º–∞–π–±—É—Ç–Ω—å–æ–º—É –π–æ–≥–æ –º–æ–∂–Ω–∞ –±—É–¥–µ –≤—Å—Ç–∞–Ω–æ–≤–ª—é–≤–∞—Ç–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é go get.</description><content>&lt;p>–ü—Ä–∏–≤—ñ—Ç!&lt;/p>
&lt;p>–°—å–æ–≥–æ–¥–Ω—ñ —è —Ö–æ—á—É —Ä–æ–∑–∫–∞–∑–∞—Ç–∏ —è–∫ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é go –º–æ–∂–Ω–∞ –æ—Ç—Ä–∏–º–∞—Ç–∏ —Å–ø–∏—Å–æ–∫ –≤—Å—ñ—Ö AWS Lambda —è–∫—ñ –∑–Ω–∞—Ö–æ–¥—è—Ç—å—Å—è –≤ VPC.
–î–ª—è –ø–æ—á–∞—Ç–∫—É –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ golang. –û—Å—Ç–∞–Ω—é –≤–µ—Ä—Å—ñ—é –º–æ–∂–Ω–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∑ –æ—Ñ—ñ—Ü—ñ–π–Ω–æ–≥–æ &lt;a href="https://golang.org/dl/">—Å–∞–π—Ç—É&lt;/a>.&lt;/p>
&lt;p>–ü—ñ—Å–ª—è —Ç–æ–≥–æ —è–∫ golang –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ —Å—Ç–≤–æ—Ä—ñ—Ç—å –ø–∞–ø–∫—É –¥–ª—è —Å–∫—Ä–∏–ø—Ç—ñ–≤
&lt;code>mkdir awsscripts&lt;/code>&lt;/p>
&lt;p>–î–∞–ª—ñ –ø–æ—Ç—Ä—ñ–±–Ω–æ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ go.mod —Ñ–∞–π–ª. –¶–µ–π —Ñ–∞–π–ª –≤ —è–∫–æ–º—É –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –≤—Å—ñ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω—ñ –ø–∞–∫–µ—Ç–∏, —ñ –æ–¥–Ω–æ—á–∞—Å–Ω–æ –∑—Ä–æ–±–∏—Ç—å go –∫–æ–¥ –º–æ–¥—É–ª–µ–º. –Ü –≤ –º–∞–π–±—É—Ç–Ω—å–æ–º—É –π–æ–≥–æ –º–æ–∂–Ω–∞ –±—É–¥–µ –≤—Å—Ç–∞–Ω–æ–≤–ª—é–≤–∞—Ç–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é &lt;code>go get&lt;/code>. –î–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –º–æ–¥—É–ª—è –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ –∫–æ–º–∞–Ω–¥—É &lt;code>go mod init github.com/mpostument/awsscripts&lt;/code>. –î–µ github&amp;hellip; —Ü–µ —ñ–º—è –º–æ–¥—É–ª—è. –Ø–∫—â–æ –≤–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é —ñ–Ω—à—É —Å–∏—Å—Ç–µ–º—É –∫–æ–Ω—Ç—Ä–æ–ª—é –≤–µ—Ä—Å—ñ–π —Ü–µ –º–æ–∂–µ –±—É—Ç–∏ –≤–æ–Ω–∞, –¥–∞–ª—ñ —ñ–º&amp;rsquo;—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —Ç–∞ –Ω–∞–∑–≤–∞ –º–æ–¥—É–ª—è.&lt;/p>
&lt;p>–ü—ñ—Å–ª—è —Ç–æ–≥–æ —è–∫ –º–æ–¥—É–ª—å —Å—Ç–≤–æ—Ä–µ–Ω–æ –Ω–∞–º –±—É–¥–µ –ø–æ—Ç—Ä—ñ–±–µ–Ω aws-sdk –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ aws. –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –π–æ–≥–æ –º–æ–∂–Ω–∞ –∫–æ–º–∞–Ω–¥–æ—é &lt;code>go get github.com/aws/aws-sdk-go@latest&lt;/code> –∑–Ω–∞—Ö–æ–¥—è—á—å –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó –∑ go.mod. –ü—ñ—Å–ª—è —Ü—å–æ–≥–æ –≤ go mod –¥–æ–±–∞–≤–∏—Ç—Å—è –≤–µ—Ä—Å—ñ—è aws-sdk &lt;code>require github.com/aws/aws-sdk-go v1.34.14&lt;/code>. –ù–∞–¥–∞–ª—ñ —â–æ–± –æ–Ω–æ–≤–∏—Ç–∏ –≤–µ—Ä—Å—ñ—é aws-sdk –º–æ–∂–Ω–∞ –≤—Ä—É—á–Ω—É –ø–æ–º—ñ–Ω—è—Ç–∏ –≤–µ—Ä—Å—ñ—é –≤ —Ü—å–æ–º—É —Ñ–∞–π–ª—ñ —Ç–∞ –∑–∞–ø—É—Å—Ç–∏—Ç–∏ &lt;code>go mod tidy&lt;/code>.&lt;/p>
&lt;p>–ó –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è–º –∑–∞–≤–µ—Ä—à–µ–Ω–æ —ñ –º–æ–∂–Ω–∞ –ø–µ—Ä–µ–π—Ç–∏ –¥–æ –∫–æ–¥—É.&lt;br>
–°—Ç–≤–æ—Ä—ñ—Ç—å –≤ –∫–æ—Ä–µ–Ω—ñ –ø–∞–ø–∫–∏ &lt;code>awsscripts&lt;/code> –∞–±–æ –∂ –≤ –±—É–¥—å —è–∫—ñ–π —ñ–Ω—à—ñ –ø–∞–ø—Ü—ñ –≤ —Å–µ—Ä–µ–¥–∏–Ω—ñ &lt;code>awsscripts&lt;/code> —Ñ–∞–π–ª &lt;code>lambdaInVpc.go&lt;/code> —ñ –≤—ñ–¥–∫—Ä–∏–π—Ç–µ –π–æ–≥–æ.&lt;/p>
&lt;p>–ö–æ–∂–µ–Ω go —Ñ–∞–π–ª –ø–æ—á–∏–Ω–∞—î—Ç—å—Å—è –∑ &lt;code>package&lt;/code>. –û—Å–∫—ñ–ª—å–∫–∏ –Ω–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç–∏ go —Ñ–∞–π–ª –Ω–∞ –ø—Ä—è–º—É –∞ –Ω–µ —ñ–º–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ —Ç–æ &lt;code>package&lt;/code> –º–∞—î –±—É—Ç–∏ &lt;code>main&lt;/code>.&lt;/p>
&lt;p>–¢–∞–∫–æ–∂ –ø–æ—Ç—Ä—ñ–±–Ω–æ –¥–æ–±–∞–≤–∏—Ç–∏ —Å–ø–∏—Å–æ–∫ —Å—Ç–æ—Ä–æ–Ω—ñ—Ö –º–æ–¥—É–ª—ñ–≤ —è–∫—ñ –º–∏ –±—É–¥–µ–º–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-go" data-lang="go">&lt;span style="color:#f92672">import&lt;/span> (
&lt;span style="color:#e6db74">&amp;#34;fmt&amp;#34;&lt;/span>
&lt;span style="color:#e6db74">&amp;#34;log&amp;#34;&lt;/span>
&lt;span style="color:#e6db74">&amp;#34;github.com/aws/aws-sdk-go/aws/session&amp;#34;&lt;/span>
&lt;span style="color:#e6db74">&amp;#34;github.com/aws/aws-sdk-go/service/lambda&amp;#34;&lt;/span>
)
&lt;/code>&lt;/pre>&lt;/div>&lt;p>–ü—ñ—Å–ª—è —Å–ø–∏—Å–∫—É —ñ–º–ø–æ—Ä—Ç—ñ–≤ —ñ–¥–µ –º–µ—Ç–æ–¥ &lt;code>main&lt;/code>, —è–∫–∏–π —î –≤—Ö—ñ–¥–Ω–æ—é —Ç–æ—á–∫–æ—é –≤ –∫–æ–¥. –í &lt;code>main&lt;/code> –º–∏ —Å—Ç–≤–æ—Ä–∏–º–æ aws client.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-go" data-lang="go">&lt;span style="color:#66d9ef">func&lt;/span> &lt;span style="color:#a6e22e">main&lt;/span>() {
&lt;span style="color:#a6e22e">mySession&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">session&lt;/span>.&lt;span style="color:#a6e22e">Must&lt;/span>(&lt;span style="color:#a6e22e">session&lt;/span>.&lt;span style="color:#a6e22e">NewSession&lt;/span>())
&lt;span style="color:#a6e22e">client&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">lambda&lt;/span>.&lt;span style="color:#a6e22e">New&lt;/span>(&lt;span style="color:#a6e22e">mySession&lt;/span>)
&lt;span style="color:#a6e22e">lambdas&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">getLambdaFunctions&lt;/span>(&lt;span style="color:#a6e22e">client&lt;/span>)
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>–¢—É—Ç —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è aws —Å–µ—Å—ñ—è —ñ lambda client, —ñ –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è —Ñ—É–Ω–∫—Ü—ñ —è &lt;code>getLambdaFunctions&lt;/code> –≤ —è–∫—É –ø–µ—Ä–µ–¥–∞—î—Ç—å—Å—è —â–æ–π–Ω–æ —Å—Ç–≤–æ—Ä–µ–Ω–∏–π client. –¢–µ–ø–µ—Ä –ø—Ä–∏—Å—Ç—É–ø–∏–º–æ –¥–æ –Ω–∞–ø–∏—Å–∞–Ω–Ω—è &lt;code>getLambdaFunctions&lt;/code>.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-go" data-lang="go">&lt;span style="color:#66d9ef">func&lt;/span> &lt;span style="color:#a6e22e">getLambdaFunctions&lt;/span>(&lt;span style="color:#a6e22e">client&lt;/span> &lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#a6e22e">lambda&lt;/span>.&lt;span style="color:#a6e22e">Lambda&lt;/span>) []&lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#a6e22e">lambda&lt;/span>.&lt;span style="color:#a6e22e">FunctionConfiguration&lt;/span> {
&lt;span style="color:#a6e22e">input&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#f92672">&amp;amp;&lt;/span>&lt;span style="color:#a6e22e">lambda&lt;/span>.&lt;span style="color:#a6e22e">ListFunctionsInput&lt;/span>{}
&lt;span style="color:#66d9ef">var&lt;/span> &lt;span style="color:#a6e22e">result&lt;/span> []&lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#a6e22e">lambda&lt;/span>.&lt;span style="color:#a6e22e">FunctionConfiguration&lt;/span>
&lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#a6e22e">client&lt;/span>.&lt;span style="color:#a6e22e">ListFunctionsPages&lt;/span>(&lt;span style="color:#a6e22e">input&lt;/span>,
&lt;span style="color:#66d9ef">func&lt;/span>(&lt;span style="color:#a6e22e">page&lt;/span> &lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#a6e22e">lambda&lt;/span>.&lt;span style="color:#a6e22e">ListFunctionsOutput&lt;/span>, &lt;span style="color:#a6e22e">lastPage&lt;/span> &lt;span style="color:#66d9ef">bool&lt;/span>) &lt;span style="color:#66d9ef">bool&lt;/span> {
&lt;span style="color:#a6e22e">result&lt;/span> = append(&lt;span style="color:#a6e22e">result&lt;/span>, &lt;span style="color:#a6e22e">page&lt;/span>.&lt;span style="color:#a6e22e">Functions&lt;/span>&lt;span style="color:#f92672">...&lt;/span>)
&lt;span style="color:#66d9ef">return&lt;/span> !&lt;span style="color:#a6e22e">lastPage&lt;/span>
})
&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">err&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#66d9ef">nil&lt;/span> {
&lt;span style="color:#a6e22e">log&lt;/span>.&lt;span style="color:#a6e22e">Fatal&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;Not able to get lambdas&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">err&lt;/span>)
&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#66d9ef">nil&lt;/span>
}
&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">result&lt;/span>
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>–¢–µ–ø–µ—Ä —Ä–æ–∑–±–µ—Ä–µ–º–æ —â–æ —Ç—É—Ç –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è. –î–ª—è —Ç–æ–≥–æ —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ —Å–ø–∏—Å–æ–∫ –ª—è–º–±–¥ –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—é &lt;code>ListFunctions&lt;/code>. –ê–ª–µ –æ—Å–∫—ñ–ª—å–∫–∏ —Ü—è –º–µ—Ç–æ–¥ –ø–æ–≤–µ—Ä—Ç–∞—î —Ç—ñ–ª—å–∫–∏ 50 –ø–µ—Ä—à–∏—Ö –ª—è–º–±–¥ –≤–æ–Ω–∞ –Ω–∞–º –Ω–∞ –ø—ñ–¥—Ö–æ–¥–∏—Ç—å. –¢–æ–º—É —â–æ —è–∫—â–æ —ó 51 —ñ –±—ñ–ª—å—à–µ –ª—è–º–±–¥ –Ω–∞ aws –∞–∫—É–Ω—Ç—ñ –æ–¥ –≤—Å–µ—Ä—ñ–≤–Ω–æ –ø–æ–≤–µ—Ä–Ω–µ —Ç—ñ–ª—å–∫–∏ –ø–µ—Ä—à—ñ 50. –ê–ª–µ –≤ aws —î –º–µ—Ç–æ–¥ –∑ –ø–∞–≥—ñ–Ω–∞—Ü—ñ—î—é &lt;code>ListFunctionsPages&lt;/code>, —ñ —ó—ó –º–æ–∂–Ω–∞ —Ç—É—Ç –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏. –ú–µ—Ç–æ–¥ –ø—Ä–∏–π–º–∞—î –¥–≤–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –ø–µ—Ä—à–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –ø–æ—à—É–∫—É &lt;code>ListFunctionsInput&lt;/code> –≤ —è–∫—ñ–π –º–æ–∂–Ω–∞ –∑–∞–¥–∞—Ç–∏ —Ä–µ–≥—ñ–æ–Ω, –≤–µ—Ä—Å—ñ—é —Ç–∞ —â–µ –¥–µ–∫—ñ–ª—å–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤. –Ü –¥—Ä—É–≥–∞ —Ü–µ –º–µ—Ç–æ–¥ –ø–∞–≥—ñ–Ω–∞—Ü—ñ—ó.&lt;/p>
&lt;p>–ù–∞ –ø–æ—á–∞—Ç–∫—É –º–∏ —Å—Ç–≤–æ—Ä—é—î–º–æ –¥–≤—ñ –∑–º—ñ–Ω—ñ —Ü–µ &lt;code>input&lt;/code> —Ç–∏–ø—É &lt;code>ListFunctionsInput&lt;/code> —ñ &lt;code>result&lt;/code> —Ç–∏–ø—É &lt;code>[]*lambda.FunctionConfiguration&lt;/code>. &lt;code>Input&lt;/code> –±—É–¥–µ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç–∏—Å—å –≤ —Ñ—É–Ω–∫—Ü—ñ—é &lt;code>ListFunctionsPages&lt;/code> –∞ &lt;code>result&lt;/code> –±—É–¥–µ –≤–∏–∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ç–∏—Å—å –¥–ª—è –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É –≤–∏–∫–æ–Ω–∞–Ω–Ω—è.&lt;/p>
&lt;p>–î–∞–ª—ñ –π–¥–µ —Å–∞–º –≤–∏–∫–ª–∏–∫ &lt;code>ListFunctionsPages&lt;/code>. –¶—è –º–µ—Ç–æ–¥ –≤–µ—Ä—Ç–∞—î —Ç—ñ–ª—å–∫–∏ –ø–æ–º–∏–ª–∫—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ü—ñ—î—ó –º–µ—Ç–æ–¥ –ø—Ä–∏—Å–≤–æ—é—î—Ç—å—Å—è –∑–º—ñ–Ω–Ω—ñ–π err —ñ –¥–∞–ª—ñ –π–¥–µ –ø–µ—Ä–≤—ñ—Ä–∫–∞ —á–∏ —Ü—è –∑–º—ñ–Ω–∞ –Ω–µ —Ä—ñ–≤–Ω–∞ &lt;code>nil&lt;/code>. –Ø–∫—â–æ –∂ –º–µ—Ç–æ–¥ –≤–µ—Ä–Ω—É–ª–∞ &lt;code>nil&lt;/code> —Ç–æ –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è –ø—Ä–æ–≥—Ä–∞–º–∏ —ñ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –ø–æ–º–∏–ª–∫–∏.&lt;/p>
&lt;p>–í —Å–∞–º—ñ–π —Ñ—É–Ω–∫—Ü—ñ—ó &lt;code>ListFunctionsPages&lt;/code> –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –≤–∏–∫–ª–∏–∫ —â–µ –æ–¥–Ω—ñ—î—ó —Ñ—É–Ω–∫—Ü—ñ—ó —è–∫–∞ –¥–æ–±–∞–≤–ª—è—î —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –≤ –∑—Ä—ñ–∑ &lt;code>result&lt;/code>. –í–∏–∫–ª–∏–∫ –≤–Ω—É—Ç—Ä—ñ—à–Ω—å–æ—é —Ñ—É–Ω–∫—Ü—ñ—ó –∑–¥—ñ—é—Å–Ω—é—î—Ç—å—Å—è –¥–µ–∫—ñ–ª—å–∫–∞ —Ä–∞–∑ –¥–æ–∫–∏ –º–∏ –Ω–µ –¥—ñ–π–¥–µ–º–æ –æ—Å—Ç–∞–Ω—å–æ—ó —Å—Ç–æ—Ä—ñ–Ω–∫–∏. –Ü –≤ –∫—ñ–Ω—Ü—ñ –≤–µ—Ä—Ç–∞—î–º–æ –∑—Ä—ñ–∑ &lt;code>result&lt;/code>.&lt;/p>
&lt;p>–¢–µ–ø–µ—Ä –∫–æ–ª–∏ –æ—Ç—Ä–∏–º–∞–ª–∏ —Å–ø–∏—Å–æ–∫ –≤—Å—ñ—Ö –ª—è–º–±–¥ –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑ –Ω–∏—Ö –≤—ñ–¥—Ñ—ñ–ª—å—Ç—Ä—É–≤–∞—Ç–∏ —Ç—ñ —è–∫—ñ –≤ VPC. –î–ª—è —Ü—å–æ–≥–æ –ø–æ–≤–µ—Ä–Ω–µ–º–æ—Å—å –∑–Ω–æ–≤—É –≤ –º–µ—Ç–æ–¥ main —ñ –¥–æ–±–∞–≤–∏—Ç–∏ —Ç–∞–º —ñ—Ç–µ—Ä–∞—Ü—ñ—ó –ø–æ –≤—Å—ñ—Ö –ª—è–º–±–¥–∞—Ö –∑ —É–º–æ–≤–æ—é.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-go" data-lang="go"> &lt;span style="color:#66d9ef">for&lt;/span> &lt;span style="color:#a6e22e">_&lt;/span>, &lt;span style="color:#a6e22e">l&lt;/span> &lt;span style="color:#f92672">:=&lt;/span> &lt;span style="color:#66d9ef">range&lt;/span> &lt;span style="color:#a6e22e">lambdas&lt;/span> {
&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#a6e22e">l&lt;/span>.&lt;span style="color:#a6e22e">VpcConfig&lt;/span> &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#66d9ef">nil&lt;/span> &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> len(&lt;span style="color:#a6e22e">l&lt;/span>.&lt;span style="color:#a6e22e">VpcConfig&lt;/span>.&lt;span style="color:#a6e22e">SubnetIds&lt;/span>) &amp;gt; &lt;span style="color:#ae81ff">0&lt;/span> {
&lt;span style="color:#a6e22e">fmt&lt;/span>.&lt;span style="color:#a6e22e">Println&lt;/span>(&lt;span style="color:#f92672">*&lt;/span>&lt;span style="color:#a6e22e">l&lt;/span>.&lt;span style="color:#a6e22e">FunctionName&lt;/span>)
}
}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>–¢—É—Ç –º–∏ —ñ—Ç–µ—Ä—É—î–º–æ—Å—å –ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É –≤–∏–∫–æ–Ω–∞–Ω–Ω—è &lt;code>getLambdaFunctions&lt;/code> —ñ –ø–µ—Ä–µ–≤—ñ—Ä—î–º–æ —á–∏ &lt;code>VpcConfig&lt;/code> —Ñ—É–Ω–∫—Ü—ñ—ó –Ω–µ —Ä—ñ–≤–Ω–∏–π &lt;code>nil&lt;/code> —ñ —á–∏ —Å–ø–∏—Å–æ–∫ subnet –±—ñ–ª—å—à–µ –∑–∞ –Ω—É–ª—å. –î–≤—ñ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –ø–æ—Ç—Ä—ñ–±–Ω—ñ —Ç–æ–º—É —â–æ –¥–ª—è –¥–µ—è–∫–∏—Ö –ª—è–º–±–¥ &lt;code>VpcConfig&lt;/code> –±—É–¥–µ nil, –∞ –¥–ª—è —ñ–Ω—à–∏—Ö –±—É–¥–µ map –≤ —è–∫–æ–º—É –±—É–¥—É—Ç—å –ø—É—Å—Ç—ñ —Å–ø–∏—Å–∫–∏. –ù–∞–ø—Ä–∏–∫–ª–∞–¥&lt;/p>
&lt;pre>&lt;code>&amp;lt;nil&amp;gt;
&amp;lt;nil&amp;gt;
{
SecurityGroupIds: [],
SubnetIds: [],
VpcId: &amp;quot;&amp;quot;
}
&amp;lt;nil&amp;gt;
&lt;/code>&lt;/pre>&lt;p>–¢–µ–ø–µ—Ä –º–æ–∂–Ω–∞ –∑–∞–ø—É—Å—Ç–∏—Ç–∏ –∫–æ–¥ —ñ –æ—Ç—Ä–∏–º–∞—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç.&lt;br>
&lt;code>go run lambdaInVpc.go&lt;/code>&lt;/p></content></item><item><title>Build Dotnet Core With Travis</title><link>/ua/2020/08/31/build-dotnet-core-with-travis/</link><pubDate>Mon, 31 Aug 2020 13:24:40 +0300</pubDate><guid>/ua/2020/08/31/build-dotnet-core-with-travis/</guid><description>–ü—Ä–∏–≤—ñ—Ç!
–°—å–≥–æ–¥–Ω—ñ —è —Ö–æ—á—É –ø–æ–∫–∞–∑–∞—Ç–∏ —è–∫ –º–æ–∂–Ω–∞ –∑–±—ñ–ª–¥–∏—Ç–∏ —Ç–∞ –∑–∞–¥–µ–ø–ª–æ—ó—Ç–∏ .net core –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é Travis.
–î–ª—è –ø–æ—á–∞—Ç–∫—É –ø–æ—Ç—Ä—ñ–±–Ω–æ —Å—Ç–≤–æ—Ä–∏—Ç–∏ Travis –∞–∫–∞—É–Ω—Ç. –î–ª—è —Ü—å–æ–≥–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–∞–ª–æ–≥—É–≤–∞—Ç–∏—Å—å –≤–∞—à–∏–º GitHub –∞–∫–∞—É–Ω—Ç–æ–º. .travis.yml –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è –ù–∞—Å—Ç—É–ø–Ω–∏–º –∫—Ä–æ–∫–æ–º –ø–æ—Ç—Ä—ñ–±–Ω–æ —Å—Ç–≤–æ—Ä–∏—Ç–∏ .travis.yml —Ñ–∞–π–ª –≤ –∫–æ—Ä–µ–Ω—ñ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—è. –ü—Ä–∏–∫–ª–∞–¥ –º–æ–≥–æ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π–Ω–æ–≥–æ —Ñ–∞–π–ª—É:
language: csharp mono: none dotnet: 3.1.4 solution: awstaghelper.sln install: - dotnet restore script: - dotnet build --configuration Release --runtime win-x64 --output win-x64 - dotnet build --configuration Release --runtime win-x86 --output win-x86 - dotnet build --configuration Release --runtime linux-x64 --output linux-x64 - dotnet build --configuration Release --runtime osx-x64 --output osx-x64 before_deploy: - zip -r9 win-x64.</description><content>&lt;p>–ü—Ä–∏–≤—ñ—Ç!&lt;/p>
&lt;p>–°—å–≥–æ–¥–Ω—ñ —è —Ö–æ—á—É –ø–æ–∫–∞–∑–∞—Ç–∏ —è–∫ –º–æ–∂–Ω–∞ –∑–±—ñ–ª–¥–∏—Ç–∏ —Ç–∞ –∑–∞–¥–µ–ø–ª–æ—ó—Ç–∏ .net core –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é &lt;a href="https://travis-ci.com/">Travis&lt;/a>.&lt;br>
–î–ª—è –ø–æ—á–∞—Ç–∫—É –ø–æ—Ç—Ä—ñ–±–Ω–æ —Å—Ç–≤–æ—Ä–∏—Ç–∏ Travis –∞–∫–∞—É–Ω—Ç. –î–ª—è —Ü—å–æ–≥–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ &lt;a href="https://travis-ci.com/signin">–∑–∞–ª–æ–≥—É–≤–∞—Ç–∏—Å—å&lt;/a> –≤–∞—à–∏–º GitHub –∞–∫–∞—É–Ω—Ç–æ–º.
&lt;img src="https://i.imgur.com/L9lOBo8.png" alt="Login">&lt;/p>
&lt;h2 id="travisyml-–∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è">.travis.yml –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è&lt;/h2>
&lt;p>–ù–∞—Å—Ç—É–ø–Ω–∏–º –∫—Ä–æ–∫–æ–º –ø–æ—Ç—Ä—ñ–±–Ω–æ —Å—Ç–≤–æ—Ä–∏—Ç–∏ .travis.yml —Ñ–∞–π–ª –≤ –∫–æ—Ä–µ–Ω—ñ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—è.
–ü—Ä–∏–∫–ª–∞–¥ –º–æ–≥–æ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π–Ω–æ–≥–æ —Ñ–∞–π–ª—É:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="color:#f92672">language&lt;/span>: &lt;span style="color:#ae81ff">csharp&lt;/span>
&lt;span style="color:#f92672">mono&lt;/span>: &lt;span style="color:#ae81ff">none&lt;/span>
&lt;span style="color:#f92672">dotnet&lt;/span>: &lt;span style="color:#ae81ff">3.1.4&lt;/span>
&lt;span style="color:#f92672">solution&lt;/span>: &lt;span style="color:#ae81ff">awstaghelper.sln&lt;/span>
&lt;span style="color:#f92672">install&lt;/span>:
- &lt;span style="color:#ae81ff">dotnet restore&lt;/span>
&lt;span style="color:#f92672">script&lt;/span>:
- &lt;span style="color:#ae81ff">dotnet build --configuration Release --runtime win-x64 --output win-x64&lt;/span>
- &lt;span style="color:#ae81ff">dotnet build --configuration Release --runtime win-x86 --output win-x86&lt;/span>
- &lt;span style="color:#ae81ff">dotnet build --configuration Release --runtime linux-x64 --output linux-x64&lt;/span>
- &lt;span style="color:#ae81ff">dotnet build --configuration Release --runtime osx-x64 --output osx-x64&lt;/span>
&lt;span style="color:#f92672">before_deploy&lt;/span>:
- &lt;span style="color:#ae81ff">zip -r9 win-x64.zip win-x64&lt;/span>
- &lt;span style="color:#ae81ff">zip -r9 win-x86.zip win-x86&lt;/span>
- &lt;span style="color:#ae81ff">zip -r9 linux-x64.zip linux-x64&lt;/span>
- &lt;span style="color:#ae81ff">zip -r9 osx-x64.zip osx-x64&lt;/span>
&lt;span style="color:#f92672">deploy&lt;/span>:
&lt;span style="color:#f92672">provider&lt;/span>: &lt;span style="color:#ae81ff">releases&lt;/span>
&lt;span style="color:#f92672">api_key&lt;/span>: &lt;span style="color:#ae81ff">$api_key&lt;/span>
&lt;span style="color:#f92672">file&lt;/span>:
- &lt;span style="color:#ae81ff">win-x64.zip&lt;/span>
- &lt;span style="color:#ae81ff">win-x86.zip&lt;/span>
- &lt;span style="color:#ae81ff">linux-x64.zip&lt;/span>
- &lt;span style="color:#ae81ff">osx-x64.zip&lt;/span>
&lt;span style="color:#f92672">skip_cleanup&lt;/span>: &lt;span style="color:#66d9ef">true&lt;/span>
&lt;span style="color:#f92672">on&lt;/span>:
&lt;span style="color:#f92672">tags&lt;/span>: &lt;span style="color:#66d9ef">true&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="net-–∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è">.Net –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è&lt;/h2>
&lt;p>–¢–µ–ø–µ—Ä —Ä–æ–∑–±–µ—Ä–µ–º–æ –∫–æ–Ω—Ñ—ñ–≥.&lt;br>
–ü–æ—á–∏–Ω–∞—î—Ç—å—Å—è yml –∑ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è –º–æ–≤–∏ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è &lt;code>language: csharp&lt;/code>. &lt;code>mono&lt;/code> —Å—Ç–æ—ó—Ç—å none —Ç–æ–º—É —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è .net core. –Ü –æ—Å—Ç–∞–Ω–Ω—î —Ü–µ –≤–µ—Ä—Å—ñ—è .net core. –í –º–æ—î–º—É –≤–∏–ø–∞–¥–∫—É —Ü–µ &lt;code>dotnet: 3.1.4&lt;/code>. –¢–∞–∫–æ–∂ –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∫–∞–∑–∞—Ç–∏ –Ω–∞–∑–≤—É —Å–æ–ª—é—à–∏–Ω—É &lt;code>solution: awstaghelper.sln&lt;/code>.&lt;/p>
&lt;h2 id="build-–∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è">Build –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è&lt;/h2>
&lt;p>–î–∞–ª—ñ –π–¥—É—Ç—å –±—ñ–ª–¥ –∫—Ä–æ–∫–∏. –ö—Ä–æ–∫ &lt;code>install&lt;/code> –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏—Ö –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π. &lt;code>dotnet restore&lt;/code> —î –Ω–µ –æ–±–æ–≤&amp;rsquo;—è–∑–∫–æ–≤–∏–º –æ—Å–∫—ñ–ª—å–∫–∏ –≤ –æ—Å—Ç–∞–Ω—ñ—Ö –≤–µ—Ä—Å—ñ—è—Ö dotnet &lt;code>restore&lt;/code> –∫–æ–º–∞–Ω–¥–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –ø—Ä–∏ &lt;code>build&lt;/code>. –¢–æ–º—É –≤ –¥–∞–Ω–Ω–æ–º—É –≤–∏–ø–∞–¥–∫—É &lt;code>install&lt;/code> –º–æ–∂–Ω–∞ –ø–æ–≤–Ω—ñ—Å—Ç—é –≤–∏–¥–∞–ª–∏—Ç–∏.&lt;/p>
&lt;p>–í &lt;code>script&lt;/code> —Å–µ–∫—Ü—ñ—ó –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –±—ñ–ª–¥ –∞–ø–ª—ñ–∫–∞—Ü—ñ—ó. –ö–æ–º–∞–Ω–¥—É &lt;code>build&lt;/code> —è –≤–∏–∫–ª–∏–∫–∞—é 4 —Ä–∞–∑–∏ –æ—Å–∫—ñ–ª—å–∫–∏ —Ä–æ–±–ª—é –±—ñ–ª–¥ –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö OS: Windows, Linux, Mac. –û–ø–µ—Ä–∞—Ü—ñ–π–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –∑–∞–∑–Ω–∞—á–∞—î—Ç—å—Å—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é &lt;code>--runtime&lt;/code> –∫–ª—é—á–∞. –°–ø–∏—Å–æ–∫ –≤—Å—ñ—Ö runtime –º–æ–∂–Ω–∞ –æ—Ç—Ä–∏–º–∞—Ç–∏ &lt;a href="https://docs.microsoft.com/en-us/dotnet/core/rid-catalog#rid-graph">—Ç—É—Ç&lt;/a>. &lt;code>--output&lt;/code> –∫–ª—é—á –≤–∫–∞–∑—É—é –≤ —è–∫—É –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—é –ø–æ–∫–ª–∞—Å—Ç–∏ –±—ñ–Ω–∞—Ä–Ω—ñ —Ñ–∞–π–ª–∏.&lt;br>
–¢–∞–∫–æ–∂ –º–æ–∂–Ω–∞ –¥–æ–±–∞–≤–∏—Ç–∏ –∫–ª—é—á &lt;code>/p:PublishSingleFile=true&lt;/code> –¥–ª—è —Ç–æ–≥–æ —â–æ–± –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ –æ—Ç—Ä–∏–º–∞—Ç–∏ —Ç—ñ–ª—å–∫–∏ –æ–¥–∏–Ω exe —Ñ–∞–π–ª. –¢–∞–∫–æ–∂ —Ü–µ–π –∫–ª—é—á –º–æ–∂–Ω–∞ –¥–æ–±–∞–≤–∏—Ç–∏ –≤ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è—Ö –ø—Ä–æ–µ–∫—Ç—É –≤ Visual Studio.&lt;/p>
&lt;h2 id="deployment-–∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è">Deployment –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è&lt;/h2>
&lt;p>&lt;code>before_deploy&lt;/code> —Å–µ–∫—Ü—ñ—è –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ—î–º –¥–ª—è –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∏ binary –¥–ª—è —Ä–µ–ª—ñ–∑—É. –ù–∞ —Ü—å–æ–º—É –µ—Ç–∞–ø—ñ —è —Ä–æ–±–ª—é –∞—Ä—Ö—ñ–≤ –∑ –±—ñ–Ω–∞—Ä–Ω–∏–º–∏ —Ñ–∞–π–ª–∞–º–∏ —è–∫—ñ –æ—Ç—Ä–∏–º–∞–≤ –ø—ñ—Å–ª—è –±—ñ–ª–¥ –¥–ª—è –∫–æ–Ω–∂–Ω–æ—ó –æ–ø–µ—Ä–∞—Ü—ñ–π–Ω–æ—ó —Å–∏—Å—Ç–µ–º–∏.&lt;/p>
&lt;p>–í &lt;code>deploy&lt;/code> —Å–µ–∫—Ü—ñ—ó —è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é –ø—Ä–æ–≤–∞–π–¥–µ—Ä &lt;code>releases&lt;/code> —è–∫–∏–π —Ä–æ–±–∏—Ç—å —Ä–µ–ª—ñ–∑ –Ω–∞ github. –°–ø–∏—Å–æ–∫ –≤—Å—ñ—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ñ–≤ - &lt;a href="https://docs.travis-ci.com/user/deployment/">docs.travis-ci.com&lt;/a>. –î–ª—è –¥–µ–ø–ª–æ—é –ø–æ—Ç—Ä—ñ–±–µ–Ω github token. –ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –π–æ–≥–æ –º–æ–∂–Ω–∞ –Ω–∞ &lt;a href="https://github.com/settings/tokens">GitHub&lt;/a>. –î–∞–ª—ñ –∫–ª—é—á –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–±–µ—Ä–µ–≥—Ç–∏ –≤ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó travis –ø—Ä–æ–µ–∫—Ç–∞. –î–ª—è —Ü—å–æ–≥–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø–µ—Ä–µ–π—Ç–∏ –≤ –ø—Ä–æ–µ–∫—Ç –Ω–∞ &lt;a href="https://travis-ci.com/">Travis&lt;/a>. –í—ñ–¥–∫—Ä–∏—Ç–∏ –ø—Ä–æ–µ–∫—Ç/–Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è:
&lt;img src="https://i.imgur.com/nHrz23b.png" alt="Config">.&lt;/p>
&lt;p>–í Environment Variables –ø–æ—Ç—Ä—ñ–±–Ω–æ –¥–æ–±–∞–≤–∏—Ç–∏ –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∏–π –∫–ª—é—á:
&lt;img src="https://i.imgur.com/wfnfkzi.png" alt="Token">
–í &lt;code>file&lt;/code> –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∫–∞–∑–∞—Ç–∏ —è–∫—ñ —Ñ–∞–π–ª–∏ –º–∞—é—Ç—å –±—É—Ç–∏ –∑–∞–¥–µ–ø–ª–æ—ó–Ω—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä. &lt;code>skip_cleanup: true&lt;/code> –º–∞—î –±—É—Ç–∏ –≤ &lt;code>true&lt;/code> –¥–ª—è —Ç–æ–≥–æ —â–æ–± travis –Ω–µ –æ—á–∏—â–∞–≤ –∑–±—ñ–ª–¥–∂–µ–Ω—ñ —Ñ–∞–π–ª–∏ –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ—î–º. &lt;code>on.tags: true&lt;/code> –æ–∑–Ω–∞—á–∞—î —â–æ –¥–µ–ø–ª–æ–π –∑–∞–ø—É—Å–∫–∞—Ç–∏ —Ç—ñ–ª—å–∫–∏ –Ω–∞ github —Ç–µ–≥–∏.&lt;/p>
&lt;p>–ü—ñ—Å–ª—è —Ç–æ–≥–æ —è–∫ —Ñ–∞–π–ª –≥–æ—Ç–æ–≤–∏–π –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑—Ä–æ–±–∏—Ç–∏ –∑–∞–ø—É—à–∏—Ç–∏ –∑–º—ñ–Ω–∏ –≤ –º–∞—Å—Ç–µ—Ä —ñ –±—ñ–ª–¥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è. –ê–ª–µ –¥–µ–ø–ª–æ–π –Ω–µ –∑–¥—ñ–π—Å–Ω–∏—Ç—å—Å—è. –î–∞–ª—ñ –Ω–∞ &lt;a href="https://github.com/">GitHub&lt;/a> –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑—Ä–æ–±–∏—Ç–∏ —Ä–µ–ª—ñ–∑ –¥–ª—è –ø–æ—Ç—Ä—ñ–±–Ω–æ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—è. –Ø–∫ —Ç—ñ–ª—å–∫–∏ —Ä–µ–ª—ñ–∑ –±—É–¥–µ –∑—Ä–æ–±–ª–µ–Ω–æ –±—ñ–ª–¥ –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è –∑–Ω–æ–≤—É, –∞–ª–µ —Ü—å–æ–≥–æ —Ä–∞–∑—É –∑ –¥–µ–ø–ª–æ—î–º.&lt;/p>
&lt;p>–í &lt;a href="https://travis-ci.com/">Travis&lt;/a> –º–æ–∂–Ω–∞ –±—É–¥–µ –ø–æ–±–∞—á–∏—Ç–∏ —Ç–∞–∫–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
&lt;img src="https://i.imgur.com/02OKZ1R.png" alt="Build">&lt;/p></content></item></channel></rss>