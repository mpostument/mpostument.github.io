<!doctype html><html lang=ua><head><title>Manage Ansible Versions With pyenv :: Maksym Postument</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="First article in series about ansible. In this article i will show install pyenv, create virtualenv and install required ansible version"><meta name=keywords content="VSCode,Devops,Ansible,pyenv,RedHat,Beginner,virtualenv"><meta name=robots content="noodp"><link rel=canonical href=https://mpostument.com/ua/programming/ansible/manage-ansible-versions-with-pyenv/><script async src="https://www.googletagmanager.com/gtag/js?id=G-SBRJXS94DC"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-SBRJXS94DC",{anonymize_ip:!1})}</script><link rel=stylesheet href=https://mpostument.com/styles.css><link rel="shortcut icon" href=https://mpostument.com/img/theme-colors/blue.png><link rel=apple-touch-icon href=https://mpostument.com/img/theme-colors/blue.png><meta name=twitter:card content="summary"><meta name=twitter:site content="mpostument.com"><meta name=twitter:creator content="Maks_Postument"><meta property="og:locale" content="ua"><meta property="og:type" content="article"><meta property="og:title" content="Manage Ansible Versions With pyenv"><meta property="og:description" content="First article in series about ansible. In this article i will show install pyenv, create virtualenv and install required ansible version"><meta property="og:url" content="https://mpostument.com/ua/programming/ansible/manage-ansible-versions-with-pyenv/"><meta property="og:site_name" content="Maksym Postument"><meta property="og:image" content="https://mpostument.com/ansible/manage-ansible-versions-with-pyenv.jpg"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><meta property="article:section" content="Devops"><meta property="article:section" content="Ansible"><meta property="article:section" content="Beginner"><meta property="article:published_time" content="2022-09-19 10:54:18 +0300 +0300"><p align=center style=background-color:#23b0ff>Sign up for my <a href=https://tinyletter.com/mpostument>email
newsletter</a> or use this <a href=/index.xml>RSS feed</a>. This is the best way to stay up-to-date with my latest content. Thank you for your continued support!</p><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8633398301520801" crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/algoliasearch@4.14.2/dist/algoliasearch-lite.umd.js></script>
<script src=https://cdn.jsdelivr.net/npm/@algolia/autocomplete-js></script>
<script src=https://cdn.jsdelivr.net/npm/@algolia/autocomplete-preset-algolia></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@algolia/autocomplete-theme-classic><div id=autocomplete></div><script>var searchClient=algoliasearch("8HJOK7X4MI","a882cdf8954678175d442905d08d8926");const{autocomplete}=window["@algolia/autocomplete-js"],{getAlgoliaResults}=window["@algolia/autocomplete-preset-algolia"];autocomplete({container:"#autocomplete",placeholder:"Search",getSources({query:e}){return[{sourceId:"title",getItems(){return getAlgoliaResults({searchClient,queries:[{indexName:"mpostument",query:e,params:{hitsPerPage:5,attributesToSnippet:["title:15","description:35"],snippetEllipsisText:"…"}}]})},templates:{item({item:e,components:t,html:n}){return n`<div class="aa-ItemWrapper">
                            <div class="aa-ItemContent">
                              <div class="aa-ItemContentBody">
                                <div class="aa-ItemContentTitle">
                                  ${t.Highlight({hit:e,attribute:"title"})}
                                </div>
                                <div class="aa-ItemContentDescription">
                                  ${t.Snippet({hit:e,attribute:"description"})}
                                </div>
                              </div>
                            </div>
                          </div>`}},getItemUrl({item:e}){return e.href},onSelect({item:e}){window.location.href=e.href}}]}})</script></head><body class=blue><div class="container center headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/ua><div class=logo>mpostument.com</div></a></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=/ua>Home</a></li><li><a href=/ua/programming/>Programming</a></li><li><a href=/ua/tags/>Tags</a></li><li><a href=/ua/categories/>Categories</a></li><hr><li><a href=https://mpostument.com/>English</a></li><li><a href=https://mpostument.com/ua/>Ukraine</a></li></ul></li></ul><ul class="menu menu--desktop menu--language-selector"><li class=menu__trigger>Ukraine&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=https://mpostument.com/>English</a></li><li><a href=https://mpostument.com/ua/>Ukraine</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><a href=/ua>Home</a></li><li><a href=/ua/programming/>Programming</a></li><li><a href=/ua/tags/>Tags</a></li><li><a href=/ua/categories/>Categories</a></li></ul></nav></header><div class=content><article class=post><h1 class=post-title><a href=https://mpostument.com/ua/programming/ansible/manage-ansible-versions-with-pyenv/>Manage Ansible Versions With pyenv</a></h1><div class=post-meta><time class=post-date>2022-09-19 ::</time>
<span class=post-author>Maksym Postument</span>
<span class=post-reading-time>:: 3 min read (599 words)</span></div><span class=post-tags>#<a href=https://mpostument.com/ua/tags/vscode/>VSCode</a>&nbsp;
#<a href=https://mpostument.com/ua/tags/devops/>Devops</a>&nbsp;
#<a href=https://mpostument.com/ua/tags/ansible/>Ansible</a>&nbsp;
#<a href=https://mpostument.com/ua/tags/pyenv/>pyenv</a>&nbsp;
#<a href=https://mpostument.com/ua/tags/redhat/>RedHat</a>&nbsp;
#<a href=https://mpostument.com/ua/tags/beginner/>Beginner</a>&nbsp;</span>
<img src=https://mpostument.com/ansible/manage-ansible-versions-with-pyenv.jpg class=post-cover alt="Manage Ansible Versions With pyenv" title="Cover Image"><div class=post-content><div><p>Привіт!</p><p>Це перший пост з циклу про ansible, в якому я покажу як можна управляти версіями ansible та python за допомогою pyenv.</p><h2 id=pyenv>Pyenv<a href=#pyenv class=hanchor arialabel=Anchor>&#8983;</a></h2><p><a href=https://github.com/pyenv/pyenv>pyenv</a> дозволяє встановлювати різні версії python і також створювати virtual env в яких буде встановлено ansible.</p><p>Для того щоб встановити pyenv потрібно виконати команду</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>git clone https://github.com/pyenv/pyenv.git ~/.pyenv
</span></span></code></pre></div><p>та добавити pyenv в PATH</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>echo <span style=color:#e6db74>&#39;export PYENV_ROOT=&#34;$HOME/.pyenv&#34;&#39;</span> &gt;&gt; ~/.bashrc
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#39;command -v pyenv &gt;/dev/null || export PATH=&#34;$PYENV_ROOT/bin:$PATH&#34;&#39;</span> &gt;&gt; ~/.bashrc
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#39;eval &#34;$(pyenv init -)&#34;&#39;</span> &gt;&gt; ~/.bashrc
</span></span></code></pre></div><p>Після того як shell буде перезапущено команда <code>pyenv</code> стане доступною. Але для того щоб створювати virtual env потрібен додатковий <a href=https://github.com/pyenv/pyenv-virtualenv>плагін</a> який можна встановити за допомогою команди</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>git clone https://github.com/pyenv/pyenv-virtualenv.git <span style=color:#66d9ef>$(</span>pyenv root<span style=color:#66d9ef>)</span>/plugins/pyenv-virtualenv
</span></span></code></pre></div><p>Також потрібно встановити певні <a href=https://github.com/pyenv/pyenv/wiki#suggested-build-environment>пакети</a> для того щоб python міг скомпілюватись. Для ubuntu це буде:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>sudo apt-get update; sudo apt-get install make build-essential libssl-dev zlib1g-dev <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>libbz2-dev libreadline-dev libsqlite3-dev wget curl llvm <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>libncursesw5-dev xz-utils tk-dev libxml2-dev libxmlsec1-dev libffi-dev liblzma-dev
</span></span></code></pre></div><p>Тепер коли все готово можна встановити версію python та ansible. До ansible 2.5 була підтримка python 2, з версії більше 2.5 можна використовувати python 3. Я встановлю python 3 та ansible версії 2.10.</p><h2 id=install-python>Install python<a href=#install-python class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Щоб переглянути доступі версії python можна виконати команду <code>pyenv install --list</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ pyenv install --list
</span></span><span style=display:flex><span>Available versions:
</span></span><span style=display:flex><span>  2.1.3
</span></span><span style=display:flex><span>  2.2.3
</span></span><span style=display:flex><span>  2.3.7
</span></span><span style=display:flex><span>  2.4.0
</span></span><span style=display:flex><span>  2.4.1
</span></span><span style=display:flex><span>  2.4.2
</span></span><span style=display:flex><span>  2.4.3
</span></span><span style=display:flex><span>  2.4.4
</span></span><span style=display:flex><span>  2.4.5
</span></span><span style=display:flex><span>  2.4.6
</span></span><span style=display:flex><span>  2.5.0
</span></span><span style=display:flex><span>  2.5.1
</span></span><span style=display:flex><span>  2.5.2
</span></span><span style=display:flex><span>  2.5.3
</span></span><span style=display:flex><span>  2.5.4
</span></span><span style=display:flex><span>  2.5.5
</span></span><span style=display:flex><span>  2.5.6
</span></span><span style=display:flex><span>  ...
</span></span></code></pre></div><p>Після того як потрібна версія python обрана її можна встановити за допомогою <code>pyenv install version</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ pyenv install 3.10.7
</span></span><span style=display:flex><span>Downloading Python-3.10.7.tar.xz...
</span></span><span style=display:flex><span>-&gt; https://www.python.org/ftp/python/3.10.7/Python-3.10.7.tar.xz
</span></span><span style=display:flex><span>Installing Python-3.10.7...
</span></span><span style=display:flex><span>Installed Python-3.10.7 to /home/maksym/.pyenv/versions/3.10.7
</span></span></code></pre></div><p>Ansible можна встановити і зараз, але якщо буде потрібно декілька версії то зробити це буде складно. Так як версії будуть перетирати одна одну. Для цього краще використати virtual env. Створити його теж можна за допомогою <code>pyenv virtualenv PYTHON_VERSION VIRTUALENV_NAME</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>pyenv virtualenv 3.10.7 ansible-2.10
</span></span></code></pre></div><p>Коли virtualenv створено його потрібно активувати, і саме таким чином можна мати встановлено багато версій ansible, маючи virtualenv під кожну з них.</p><p>Активувати virtualenv можна за допомогою команди <code>pyenv activate VIRTUALENV_NAME</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>pyenv activate ansible-2.10
</span></span></code></pre></div><p>Тепер все готово для встановлення ansible. Це можна зробити за допомогою команди <code>pip install PACKAGE_NAME</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ pip install ansible<span style=color:#f92672>==</span>2.10.7
</span></span><span style=display:flex><span>Collecting ansible<span style=color:#f92672>==</span>2.10.7
</span></span><span style=display:flex><span>  Downloading ansible-2.10.7.tar.gz <span style=color:#f92672>(</span>29.9 MB<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 29.9/29.9 MB 8.3 MB/s eta 0:00:00
</span></span><span style=display:flex><span>  Preparing metadata <span style=color:#f92672>(</span>setup.py<span style=color:#f92672>)</span> ... <span style=color:#66d9ef>done</span>
</span></span><span style=display:flex><span>Collecting ansible-base&lt;2.11,&gt;<span style=color:#f92672>=</span>2.10.5
</span></span><span style=display:flex><span>  Downloading ansible-base-2.10.17.tar.gz <span style=color:#f92672>(</span>6.1 MB<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 6.1/6.1 MB 9.5 MB/s eta 0:00:00
</span></span><span style=display:flex><span>  Preparing metadata <span style=color:#f92672>(</span>setup.py<span style=color:#f92672>)</span> ... <span style=color:#66d9ef>done</span>
</span></span><span style=display:flex><span>Collecting jinja2
</span></span><span style=display:flex><span>  Using cached Jinja2-3.1.2-py3-none-any.whl <span style=color:#f92672>(</span><span style=color:#ae81ff>133</span> kB<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Collecting PyYAML
</span></span><span style=display:flex><span>  Downloading PyYAML-6.0-cp310-cp310-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_12_x86_64.manylinux2010_x86_64.whl <span style=color:#f92672>(</span><span style=color:#ae81ff>682</span> kB<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 682.2/682.2 kB 8.6 MB/s eta 0:00:00
</span></span><span style=display:flex><span>Collecting cryptography
</span></span><span style=display:flex><span>  Downloading cryptography-38.0.1-cp36-abi3-manylinux_2_28_x86_64.whl <span style=color:#f92672>(</span>4.2 MB<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4.2/4.2 MB 9.9 MB/s eta 0:00:00
</span></span><span style=display:flex><span>Collecting packaging
</span></span><span style=display:flex><span>  Downloading packaging-21.3-py3-none-any.whl <span style=color:#f92672>(</span><span style=color:#ae81ff>40</span> kB<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 40.8/40.8 kB 3.0 MB/s eta 0:00:00
</span></span><span style=display:flex><span>Collecting cffi&gt;<span style=color:#f92672>=</span>1.12
</span></span><span style=display:flex><span>  Downloading cffi-1.15.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl <span style=color:#f92672>(</span><span style=color:#ae81ff>441</span> kB<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 441.8/441.8 kB 8.9 MB/s eta 0:00:00
</span></span><span style=display:flex><span>Collecting MarkupSafe&gt;<span style=color:#f92672>=</span>2.0
</span></span><span style=display:flex><span>  Downloading MarkupSafe-2.1.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl <span style=color:#f92672>(</span><span style=color:#ae81ff>25</span> kB<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Collecting pyparsing!<span style=color:#f92672>=</span>3.0.5,&gt;<span style=color:#f92672>=</span>2.0.2
</span></span><span style=display:flex><span>  Downloading pyparsing-3.0.9-py3-none-any.whl <span style=color:#f92672>(</span><span style=color:#ae81ff>98</span> kB<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 98.3/98.3 kB 6.2 MB/s eta 0:00:00
</span></span><span style=display:flex><span>Collecting pycparser
</span></span><span style=display:flex><span>  Using cached pycparser-2.21-py2.py3-none-any.whl <span style=color:#f92672>(</span><span style=color:#ae81ff>118</span> kB<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Using legacy <span style=color:#e6db74>&#39;setup.py install&#39;</span> <span style=color:#66d9ef>for</span> ansible, since package <span style=color:#e6db74>&#39;wheel&#39;</span> is not installed.
</span></span><span style=display:flex><span>Using legacy <span style=color:#e6db74>&#39;setup.py install&#39;</span> <span style=color:#66d9ef>for</span> ansible-base, since package <span style=color:#e6db74>&#39;wheel&#39;</span> is not installed.
</span></span><span style=display:flex><span>Installing collected packages: PyYAML, pyparsing, pycparser, MarkupSafe, packaging, jinja2, cffi, cryptography, ansible-base, ansible
</span></span><span style=display:flex><span>  Running setup.py install <span style=color:#66d9ef>for</span> ansible-base ... <span style=color:#66d9ef>done</span>
</span></span><span style=display:flex><span>  Running setup.py install <span style=color:#66d9ef>for</span> ansible ... <span style=color:#66d9ef>done</span>
</span></span><span style=display:flex><span>Successfully installed MarkupSafe-2.1.1 PyYAML-6.0 ansible-2.10.7 ansible-base-2.10.17 cffi-1.15.1 cryptography-38.0.1 jinja2-3.1.2 packaging-21.3 pycparser-2.21 pyparsing-3.0.9
</span></span></code></pre></div><p>Тепер ansible готовий до використання</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ ansible --version
</span></span><span style=display:flex><span>ansible 2.10.17
</span></span><span style=display:flex><span>  config file <span style=color:#f92672>=</span> None
</span></span><span style=display:flex><span>  configured module search path <span style=color:#f92672>=</span> <span style=color:#f92672>[</span><span style=color:#e6db74>&#39;/home/maksym/.ansible/plugins/modules&#39;</span>, <span style=color:#e6db74>&#39;/usr/share/ansible/plugins/modules&#39;</span><span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>  ansible python module location <span style=color:#f92672>=</span> /home/maksym/.pyenv/versions/3.10.7/envs/ansible-2.10/lib/python3.10/site-packages/ansible
</span></span><span style=display:flex><span>  executable location <span style=color:#f92672>=</span> /home/maksym/.pyenv/versions/ansible-2.10/bin/ansible
</span></span><span style=display:flex><span>  python version <span style=color:#f92672>=</span> 3.10.7 <span style=color:#f92672>(</span>main, Sep <span style=color:#ae81ff>19</span> 2022, 11:11:49<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>GCC 9.4.0<span style=color:#f92672>]</span>
</span></span></code></pre></div><p>Якщо ж потрібно встановити ще одну версію ansible virtualenv можна деактивувати і створити новий та встановити ansible</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ pyenv deactivate
</span></span><span style=display:flex><span>$ pyenv virtualenv 3.10.7 ansible-2.9
</span></span><span style=display:flex><span>$ pip install ansible<span style=color:#f92672>==</span>2.9.27
</span></span></code></pre></div><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/pBobhqJrKZg style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div></div></div><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//mpostument-com.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></article></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2023 Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>:: <a href=https://github.com/panr/hugo-theme-terminal target=_blank>Theme</a> made by <a href=https://github.com/panr target=_blank>panr</a></span></div></div></footer><script type=text/javascript src=/bundle.min.js></script></div></body></html>