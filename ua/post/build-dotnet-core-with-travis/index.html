<!doctype html><html prefix="og: http://ogp.me/ns#"><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Build Dotnet Core With Travis &#183; Maksym Postument</title><meta name=description content="Привіт!
Сьгодні я хочу показати як можна збілдити та задеплоїти .net core за допомогою Travis.
Для початку потрібно створити Travis акаунт. Для цього потрібно залогуватись вашим GitHub акаунтом. .travis.yml Конфігурація Наступним кроком потрібно створити .travis.yml файл в корені репозиторія. Приклад мого конфігураційного файлу:
language: csharp mono: none dotnet: 3.1.4 solution: awstaghelper.sln install: - dotnet restore script: - dotnet build --configuration Release --runtime win-x64 --output win-x64 - dotnet build --configuration Release --runtime win-x86 --output win-x86 - dotnet build --configuration Release --runtime linux-x64 --output linux-x64 - dotnet build --configuration Release --runtime osx-x64 --output osx-x64 before_deploy: - zip -r9 win-x64."><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=generator content="Hugo 0.74.3"><meta name=robots content="index,follow"><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:title" content="Build Dotnet Core With Travis"><meta property="og:description" content="Привіт!
Сьгодні я хочу показати як можна збілдити та задеплоїти .net core за допомогою Travis.
Для початку потрібно створити Travis акаунт. Для цього потрібно залогуватись вашим GitHub акаунтом. .travis.yml Конфігурація Наступним кроком потрібно створити .travis.yml файл в корені репозиторія. Приклад мого конфігураційного файлу:
language: csharp mono: none dotnet: 3.1.4 solution: awstaghelper.sln install: - dotnet restore script: - dotnet build --configuration Release --runtime win-x64 --output win-x64 - dotnet build --configuration Release --runtime win-x86 --output win-x86 - dotnet build --configuration Release --runtime linux-x64 --output linux-x64 - dotnet build --configuration Release --runtime osx-x64 --output osx-x64 before_deploy: - zip -r9 win-x64."><meta property="og:type" content="article"><meta property="og:url" content="/ua/post/build-dotnet-core-with-travis/"><link rel=stylesheet href=/dist/site.css><link rel=stylesheet href=/dist/syntax.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,400,600,700,300&subset=latin,cyrillic-ext,latin-ext,cyrillic"><link rel=stylesheet href=https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css integrity=sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN crossorigin=anonymous></head><body><div id=wrapper><header class=site-header><div class=container><div class=site-title-wrapper><h1 class=site-title><a title=mpostument.com href=/>mpostument.com</a></h1><a class=button-square href=/index.xml><i class="fa fa-rss"></i></a><a class="button-square button-social hint--top" data-hint=Twitter title=Twitter href=https://twitter.com/Maks_Postument rel=me><i class="fa fa-twitter"></i></a><a class="button-square button-social hint--top" data-hint=Github title=Github href=https://github.com/mpostument rel=me><i class="fa fa-github-alt"></i></a><a class="button-square button-social hint--top" data-hint=Email title=Email href=mailto:777rip777@gmail.com><i class="fa fa-envelope"></i></a></div><ul class=site-nav><li class=site-nav-item><a title=About href=/about/>About</a></li><li class=site-nav-item><a title=Home href=/>Home</a></li><li class=site-nav-item><a title=Projects href=/projects/>Projects</a></li></ul></div></header><div id=container><div class=container><article class=post-container itemscope itemtype=http://schema.org/BlogPosting><header class=post-header><h1 class=post-title itemprop="name headline">Build Dotnet Core With Travis</h1><p class=post-date><span>Published <time datetime=2020-08-31 itemprop=datePublished>Mon, Aug 31, 2020</time></span>
<span>by</span>
<span itemscope itemprop=author itemtype=https://schema.org/Person><span itemprop=name><a href=https://github.com/mpostument itemprop=url rel=author>Maksym Postument</a></span></span></p><p class="post-reading post-line"><span>3 min</span></p></header><div class="post-content clearfix" itemprop=articleBody><nav class=LangNav><a href=/post/build-dotnet-core-with-travis/>English</a>
<a href=/ru/post/build-dotnet-core-with-travis/>Russian</a></nav><p><img src=https://i.imgur.com/MfGG4k8.png alt=Travis><br>Привіт!</p><p>Сьгодні я хочу показати як можна збілдити та задеплоїти .net core за допомогою <a href=https://travis-ci.com/>Travis</a>.<br>Для початку потрібно створити Travis акаунт. Для цього потрібно <a href=https://travis-ci.com/signin>залогуватись</a> вашим GitHub акаунтом.
<img src=https://i.imgur.com/L9lOBo8.png alt=Login></p><h2 id=travisyml-конфігурація>.travis.yml Конфігурація</h2><p>Наступним кроком потрібно створити .travis.yml файл в корені репозиторія.
Приклад мого конфігураційного файлу:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#66d9ef>language</span>: csharp
<span style=color:#66d9ef>mono</span>: none
<span style=color:#66d9ef>dotnet</span>: <span style=color:#ae81ff>3.1.4</span>

<span style=color:#66d9ef>solution</span>: awstaghelper.sln

<span style=color:#66d9ef>install</span>:
  - dotnet restore

<span style=color:#66d9ef>script</span>:
  - dotnet build --configuration Release --runtime win-x64 --output win-x64
  - dotnet build --configuration Release --runtime win-x86 --output win-x86
  - dotnet build --configuration Release --runtime linux-x64 --output linux-x64
  - dotnet build --configuration Release --runtime osx-x64 --output osx-x64

<span style=color:#66d9ef>before_deploy</span>: 
  - zip -r9 win-x64.zip win-x64
  - zip -r9 win-x86.zip win-x86
  - zip -r9 linux-x64.zip linux-x64
  - zip -r9 osx-x64.zip osx-x64

<span style=color:#66d9ef>deploy</span>:
  <span style=color:#66d9ef>provider</span>: releases
  <span style=color:#66d9ef>api_key</span>: $api_key
  <span style=color:#66d9ef>file</span>: 
    - win-x64.zip
    - win-x86.zip
    - linux-x64.zip
    - osx-x64.zip
  <span style=color:#66d9ef>skip_cleanup</span>: <span style=color:#66d9ef>true</span>
  <span style=color:#66d9ef>on</span>:
    <span style=color:#66d9ef>tags</span>: <span style=color:#66d9ef>true</span>
</code></pre></div><h2 id=net-конфігурація>.Net конфігурація</h2><p>Тепер розберемо конфіг.<br>Починається yml з оголошення мови програмування <code>language: csharp</code>. <code>mono</code> стоїть none тому що використовується .net core. І останнє це версія .net core. В моєму випадку це <code>dotnet: 3.1.4</code>. Також потрібно вказати назву солюшину <code>solution: awstaghelper.sln</code>.</p><h2 id=build-конфігурація>Build Конфігурація</h2><p>Далі йдуть білд кроки. Крок <code>install</code> використовується для встановлення необхідних залежностей. <code>dotnet restore</code> є не обов&rsquo;язковим оскільки в останіх версіях dotnet <code>restore</code> команда автоматично викликається при <code>build</code>. Тому в данному випадку <code>install</code> можна повністю видалити.</p><p>В <code>script</code> секції відбувається білд аплікації. Команду <code>build</code> я викликаю 4 рази оскільки роблю білд для різних OS: Windows, Linux, Mac. Операційна система зазначається за допомогою <code>--runtime</code> ключа. Список всіх runtime можна отримати <a href=https://docs.microsoft.com/en-us/dotnet/core/rid-catalog#rid-graph>тут</a>. <code>--output</code> ключ вказую в яку директорію покласти бінарні файли.<br>Також можна добавити ключ <code>/p:PublishSingleFile=true</code> для того щоб в результаті отримати тільки один exe файл. Також цей ключ можна добавити в налаштуваннях проекту в Visual Studio.</p><h2 id=deployment-конфігурація>Deployment Конфігурація</h2><p><code>before_deploy</code> секція викликається перед деплоєм для підготовки binary для релізу. На цьому етапі я роблю архів з бінарними файлами які отримав після білд для конжної операційної системи.</p><p>В <code>deploy</code> секції я використовую провайдер <code>releases</code> який робить реліз на github. Список всіх провайдерів - <a href=https://docs.travis-ci.com/user/deployment/>docs.travis-ci.com</a>. Для деплою потрібен github token. Згенерувати його можна на <a href=https://github.com/settings/tokens>GitHub</a>. Далі ключ потрібно зберегти в конфігурації travis проекта. Для цього потрібно перейти в проект на <a href=https://travis-ci.com/>Travis</a>. Відкрити проект/налаштування:
<img src=https://i.imgur.com/nHrz23b.png alt=Config>.</p><p>В Environment Variables потрібно добавити згенерований ключ:
<img src=https://i.imgur.com/wfnfkzi.png alt=Token>
В <code>file</code> потрібно вказати які файли мають бути задеплоїні використовуючи провайдер. <code>skip_cleanup: true</code> має бути в <code>true</code> для того щоб travis не очищав збілджені файли перед деплоєм. <code>on.tags: true</code> означає що деплой запускати тільки на github теги.</p><p>Після того як файл готовий потрібно зробити запушити зміни в мастер і білд автоматично запуститься. Але деплой не здійсниться. Далі на <a href=https://github.com/>GitHub</a> потрібно зробити реліз для потрібного репозиторія. Як тільки реліз буде зроблено білд запуститься знову, але цього разу з деплоєм.</p><p>В <a href=https://travis-ci.com/>Travis</a> можна буде побачити такий результат:
<img src=https://i.imgur.com/02OKZ1R.png alt=Build></p></div><footer class="post-footer clearfix"><div class=share><a class=icon-twitter href="https://twitter.com/share?text=Build%20Dotnet%20Core%20With%20Travis&url=%2fua%2fpost%2fbuild-dotnet-core-with-travis%2f" onclick="window.open(this.href,'twitter-share','width=550,height=235');return false;"><i class="fa fa-twitter"></i><span class=hidden>Twitter</span></a>
<a class=icon-facebook href="https://www.facebook.com/sharer/sharer.php?u=%2fua%2fpost%2fbuild-dotnet-core-with-travis%2f" onclick="window.open(this.href,'facebook-share','width=580,height=296');return false;"><i class="fa fa-facebook"></i><span class=hidden>Facebook</span></a>
<a class=icon-google-plus href="https://plus.google.com/share?url=%2fua%2fpost%2fbuild-dotnet-core-with-travis%2f" onclick="window.open(this.href,'google-plus-share','width=490,height=530');return false;"><i class="fa fa-google-plus"></i><span class=hidden>Google+</span></a></div></footer></article></div></div></div><footer class=footer><div class=container><div class=site-title-wrapper><h1 class=site-title><a title=mpostument.com href=/>mpostument.com</a></h1><a class="button-square button-jump-top js-jump-top" href=#><i class="fa fa-angle-up"></i></a></div><p class=footer-copyright><span>&copy; 2020 / Powered by <a href=https://gohugo.io/>Hugo</a></span></p><p class=footer-copyright><span><a href=https://github.com/roryg/ghostwriter>Ghostwriter theme</a> By <a href=http://jollygoodthemes.com>JollyGoodThemes</a></span>
<span>/ <a href=https://github.com/jbub/ghostwriter>Ported</a> to Hugo By <a href=https://github.com/jbub>jbub</a></span></p></div></footer><script src=/js/jquery-1.11.3.min.js></script><script src=/js/jquery.fitvids.js></script><script src=/js/scripts.js></script></body></html>