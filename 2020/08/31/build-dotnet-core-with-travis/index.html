<!doctype html><html prefix="og: http://ogp.me/ns#"><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Build Dotnet Core With Travis &#183; Maksym Postument</title><meta name=description content="Hello!
Today I want to show how you can build and deploy .net core with Travis.
To get started, you need to create a Travis account. This requires you to login with your GitHub account. .travis.yml Configuration The next step is to create a .travis.yml file in the root of the repository.
Example of my configuration file:
language:csharpmono:nonedotnet:3.1.4solution:awstaghelper.slninstall:- dotnetrestorescript:- dotnetbuild--configurationRelease--runtimewin-x64--outputwin-x64- dotnetbuild--configurationRelease--runtimewin-x86--outputwin-x86- dotnetbuild--configurationRelease--runtimelinux-x64--outputlinux-x64- dotnetbuild--configurationRelease--runtimeosx-x64--outputosx-x64before_deploy:- zip-r9win-x64.zipwin-x64- zip-r9win-x86.zipwin-x86- zip-r9linux-x64.ziplinux-x64- zip-r9osx-x64.ziposx-x64deploy:provider:releasesapi_key:$api_keyfile:- win-x64.zip- win-x86.zip- linux-x64.zip- osx-x64."><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=generator content="Hugo 0.74.3"><meta name=robots content="index,follow"><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:title" content="Build Dotnet Core With Travis"><meta property="og:description" content="Hello!
Today I want to show how you can build and deploy .net core with Travis.
To get started, you need to create a Travis account. This requires you to login with your GitHub account. .travis.yml Configuration The next step is to create a .travis.yml file in the root of the repository.
Example of my configuration file:
language:csharpmono:nonedotnet:3.1.4solution:awstaghelper.slninstall:- dotnetrestorescript:- dotnetbuild--configurationRelease--runtimewin-x64--outputwin-x64- dotnetbuild--configurationRelease--runtimewin-x86--outputwin-x86- dotnetbuild--configurationRelease--runtimelinux-x64--outputlinux-x64- dotnetbuild--configurationRelease--runtimeosx-x64--outputosx-x64before_deploy:- zip-r9win-x64.zipwin-x64- zip-r9win-x86.zipwin-x86- zip-r9linux-x64.ziplinux-x64- zip-r9osx-x64.ziposx-x64deploy:provider:releasesapi_key:$api_keyfile:- win-x64.zip- win-x86.zip- linux-x64.zip- osx-x64."><meta property="og:type" content="article"><meta property="og:url" content="/2020/08/31/build-dotnet-core-with-travis/"><link rel=stylesheet href=/dist/site.css><link rel=stylesheet href=/dist/syntax.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,400,600,700,300&subset=latin,cyrillic-ext,latin-ext,cyrillic"><link rel=stylesheet href=https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css integrity=sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN crossorigin=anonymous></head><body><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-176839804-1','auto');ga('send','pageview');}</script><div id=wrapper><header class=site-header><div class=container><div class=site-title-wrapper><h1 class=site-title><a title=mpostument.com href=/>mpostument.com</a></h1><a class=button-square href=/index.xml><i class="fa fa-rss"></i></a><a class="button-square button-social hint--top" data-hint=Twitter title=Twitter href=https://twitter.com/Maks_Postument rel=me><i class="fa fa-twitter"></i></a><a class="button-square button-social hint--top" data-hint=Github title=Github href=https://github.com/mpostument rel=me><i class="fa fa-github-alt"></i></a><a class="button-square button-social hint--top" data-hint=Email title=Email href=mailto:777rip777@gmail.com><i class="fa fa-envelope"></i></a></div><ul class=site-nav><li class=site-nav-item><a title=About href=/about/>About</a></li><li class=site-nav-item><a title=Home href=/>Home</a></li><li class=site-nav-item><a title=Projects href=/projects/>Projects</a></li></ul></div></header><div id=container><div class=container><article class=post-container itemscope itemtype=http://schema.org/BlogPosting><header class=post-header><h1 class=post-title itemprop="name headline">Build Dotnet Core With Travis</h1><p class=post-date><span>Published <time datetime=2020-08-31 itemprop=datePublished>Mon, Aug 31, 2020</time></span>
<span>by</span>
<span itemscope itemprop=author itemtype=https://schema.org/Person><span itemprop=name><a href=https://github.com/mpostument itemprop=url rel=author>Maksym Postument</a></span></span></p><p class="post-reading post-line"><span>3 min</span></p><nav class=LangNav>Language:
<a href=/ua/2020/08/31/build-dotnet-core-with-travis/>Ukrainian</a>
<a href=/ru/2020/08/31/build-dotnet-core-with-travis/>Russian</a></nav></header><div class="post-content clearfix" itemprop=articleBody><img class=post-featured-image src=https://i.imgur.com/MfGG4k8.png><p>Hello!</p><p>Today I want to show how you can build and deploy .net core with <a href=https://travis-ci.com/>Travis</a>.<br>To get started, you need to create a Travis account. This requires you to <a href=https://travis-ci.com/signin>login</a> with your GitHub account.
<img src=https://i.imgur.com/L9lOBo8.png alt=Login></p><h2 id=travisyml-configuration>.travis.yml Configuration</h2><p>The next step is to create a .travis.yml file in the root of the repository.<br>Example of my configuration file:</p><div class=highlight><pre class=chroma><code class=language-yaml data-lang=yaml><span class=k>language</span><span class=p>:</span><span class=w> </span>csharp<span class=w>
</span><span class=w></span><span class=k>mono</span><span class=p>:</span><span class=w> </span>none<span class=w>
</span><span class=w></span><span class=k>dotnet</span><span class=p>:</span><span class=w> </span><span class=m>3.1.4</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=k>solution</span><span class=p>:</span><span class=w> </span>awstaghelper.sln<span class=w>
</span><span class=w>
</span><span class=w></span><span class=k>install</span><span class=p>:</span><span class=w>
</span><span class=w>  </span>- dotnet<span class=w> </span>restore<span class=w>
</span><span class=w>
</span><span class=w></span><span class=k>script</span><span class=p>:</span><span class=w>
</span><span class=w>  </span>- dotnet<span class=w> </span>build<span class=w> </span>--configuration<span class=w> </span>Release<span class=w> </span>--runtime<span class=w> </span>win-x64<span class=w> </span>--output<span class=w> </span>win-x64<span class=w>
</span><span class=w>  </span>- dotnet<span class=w> </span>build<span class=w> </span>--configuration<span class=w> </span>Release<span class=w> </span>--runtime<span class=w> </span>win-x86<span class=w> </span>--output<span class=w> </span>win-x86<span class=w>
</span><span class=w>  </span>- dotnet<span class=w> </span>build<span class=w> </span>--configuration<span class=w> </span>Release<span class=w> </span>--runtime<span class=w> </span>linux-x64<span class=w> </span>--output<span class=w> </span>linux-x64<span class=w>
</span><span class=w>  </span>- dotnet<span class=w> </span>build<span class=w> </span>--configuration<span class=w> </span>Release<span class=w> </span>--runtime<span class=w> </span>osx-x64<span class=w> </span>--output<span class=w> </span>osx-x64<span class=w>
</span><span class=w>
</span><span class=w></span><span class=k>before_deploy</span><span class=p>:</span><span class=w> 
</span><span class=w>  </span>- zip<span class=w> </span>-r9<span class=w> </span>win-x64.zip<span class=w> </span>win-x64<span class=w>
</span><span class=w>  </span>- zip<span class=w> </span>-r9<span class=w> </span>win-x86.zip<span class=w> </span>win-x86<span class=w>
</span><span class=w>  </span>- zip<span class=w> </span>-r9<span class=w> </span>linux-x64.zip<span class=w> </span>linux-x64<span class=w>
</span><span class=w>  </span>- zip<span class=w> </span>-r9<span class=w> </span>osx-x64.zip<span class=w> </span>osx-x64<span class=w>
</span><span class=w>
</span><span class=w></span><span class=k>deploy</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=k>provider</span><span class=p>:</span><span class=w> </span>releases<span class=w>
</span><span class=w>  </span><span class=k>api_key</span><span class=p>:</span><span class=w> </span>$api_key<span class=w>
</span><span class=w>  </span><span class=k>file</span><span class=p>:</span><span class=w> 
</span><span class=w>    </span>- win-x64.zip<span class=w>
</span><span class=w>    </span>- win-x86.zip<span class=w>
</span><span class=w>    </span>- linux-x64.zip<span class=w>
</span><span class=w>    </span>- osx-x64.zip<span class=w>
</span><span class=w>  </span><span class=k>skip_cleanup</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span><span class=w>  </span><span class=k>on</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=k>tags</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></code></pre></div><h2 id=net-configuration>.Net configuration</h2><p>Now let&rsquo;s review the config.<br>Yml begins with the declaration of the programming language <code>language: csharp</code>. <code>mono</code>
is none because the .net core is used. And the last is the .net core version. In my case it is <code>dotnet: 3.1.4</code>. You also need to specify the name of the solution <code>solution: awstaghelper.sln</code>.</p><h2 id=build-configuration>Build configuration</h2><p>Next are the build steps. Step <code>install</code> used to install the necessary dependencies. <code>dotnet restore</code> is optional as in the latest versions of dotnet <code>restore</code> the command is automatically called when <code>build</code>. Because of this, <code>install</code> can be completely removed.</p><p>In the <code>script</code> section there is a build of application. I call the <code>build</code> command 4 times because I build for different OS: Windows, Linux, Mac. The operating system is indicated by the <code>--runtime</code> key. A list of all runtime is available <a href=https://docs.microsoft.com/en-us/dotnet/core/rid-catalog#rid-graph>here</a>. <code>--output</code> key specifies in which directory to put binaries.
You can also add the <code>/p:PublishSingleFile=true</code> key to get only one exe file as a result per OS. You can also add this key in the project settings in Visual Studio.</p><h2 id=deployment-configuration>Deployment configuration</h2><p>The <code>before_deploy</code> section is called before the deployment to prepare the binary for release. At this stage, I make an archive with the binaries that I received after the builds for the each operating system.</p><p>In the <code>deploy</code> section I use the <code>releases</code> provider which releases on github. List of all providers - <a href=https://docs.travis-ci.com/user/deployment/>docs.travis-ci.com</a>. A github token is required for deployment. You can generate it on <a href=https://github.com/settings/tokens>GitHub</a>.
The key must be saved in the travis configuration of the project. To do this, go to the project on <a href=https://travis-ci.com/>Travis</a>. Open project/settings:
<img src=https://i.imgur.com/nHrz23b.png alt=Config>.</p><p>In Environment Variables you need to add the generated key:
<img src=https://i.imgur.com/wfnfkzi.png alt=Token>
In <code>file</code> you need to specify which files should be deployed using the provider. <code>skip_cleanup: true</code> must be <code>true</code> so that travis does not clear whipped files before deployment. <code>on.tags: true</code> means that the deployment run only on github tags.</p><p>Once the file is ready you need to make run changes to the master and the build will start automatically. But the deployment will not take place, because it trigger only on tags. On <a href=https://github.com/>GitHub</a> you need to create release for the desired repository. Once the release is done the build will run again, but this time with a deployment.</p><p>In <a href=https://travis-ci.com/>Travis</a> you can see the following result:
<img src=https://i.imgur.com/02OKZ1R.png alt=Build></p></div><footer class="post-footer clearfix"><p class=post-tags><span>Tagged:</span>
<a href=/tags/travis/>Travis</a>,
<a href=/tags/.net/>.Net</a>,
<a href=/tags/devops/>Devops</a></p><div class=share><a class=icon-twitter href="https://twitter.com/share?text=Build%20Dotnet%20Core%20With%20Travis&url=%2f2020%2f08%2f31%2fbuild-dotnet-core-with-travis%2f" onclick="window.open(this.href,'twitter-share','width=550,height=235');return false;"><i class="fa fa-twitter"></i><span class=hidden>Twitter</span></a>
<a class=icon-facebook href="https://www.facebook.com/sharer/sharer.php?u=%2f2020%2f08%2f31%2fbuild-dotnet-core-with-travis%2f" onclick="window.open(this.href,'facebook-share','width=580,height=296');return false;"><i class="fa fa-facebook"></i><span class=hidden>Facebook</span></a>
<a class=icon-google-plus href="https://plus.google.com/share?url=%2f2020%2f08%2f31%2fbuild-dotnet-core-with-travis%2f" onclick="window.open(this.href,'google-plus-share','width=490,height=530');return false;"><i class="fa fa-google-plus"></i><span class=hidden>Google+</span></a></div></footer></article></div></div></div><footer class=footer><div class=container><div class=site-title-wrapper><h1 class=site-title><a title=mpostument.com href=/>mpostument.com</a></h1><a class="button-square button-jump-top js-jump-top" href=#><i class="fa fa-angle-up"></i></a></div><p class=footer-copyright><span>&copy; 2020 / Powered by <a href=https://gohugo.io/>Hugo</a></span></p><p class=footer-copyright><span><a href=https://github.com/roryg/ghostwriter>Ghostwriter theme</a> By <a href=http://jollygoodthemes.com>JollyGoodThemes</a></span>
<span>/ <a href=https://github.com/jbub/ghostwriter>Ported</a> to Hugo By <a href=https://github.com/jbub>jbub</a></span></p></div></footer><script src=/js/jquery-1.11.3.min.js></script><script src=/js/jquery.fitvids.js></script><script src=/js/scripts.js></script></body></html>