<!doctype html><html lang=en><head><title>Build Dotnet Core With Travis :: Maksym Postument</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Build and deploy .Net Core code with Travis CI"><meta name=keywords content="Travis,.Net,.Net Core,CI/CD,Devops"><meta name=robots content="noodp"><link rel=canonical href=https://mpostument.com/programming/dotnet/build-dotnet-core-with-travis/><script async src="https://www.googletagmanager.com/gtag/js?id=G-SBRJXS94DC"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-SBRJXS94DC",{anonymize_ip:!1})}</script><link rel=stylesheet href=https://mpostument.com/styles.css><link rel="shortcut icon" href=https://mpostument.com/img/theme-colors/blue.png><link rel=apple-touch-icon href=https://mpostument.com/img/theme-colors/blue.png><meta name=twitter:card content="summary"><meta name=twitter:site content="mpostument.com"><meta name=twitter:creator content="Maks_Postument"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="Build Dotnet Core With Travis"><meta property="og:description" content="Build and deploy .Net Core code with Travis CI"><meta property="og:url" content="https://mpostument.com/programming/dotnet/build-dotnet-core-with-travis/"><meta property="og:site_name" content="Maksym Postument"><meta property="og:image" content="https://i.imgur.com/MfGG4k8.png"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><meta property="article:section" content="Devops"><meta property="article:section" content="CI/CD"><meta property="article:published_time" content="2020-08-31 13:24:40 +0300 +0300"><p align=center style=background-color:#23b0ff>Sign up for my <a href=https://tinyletter.com/mpostument>email
newsletter</a> or use this <a href=/index.xml>RSS feed</a>. This is the best way to stay up-to-date with my latest content. Thank you for your continued support!</p><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8633398301520801" crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/algoliasearch@4.14.2/dist/algoliasearch-lite.umd.js></script>
<script src=https://cdn.jsdelivr.net/npm/@algolia/autocomplete-js></script>
<script src=https://cdn.jsdelivr.net/npm/@algolia/autocomplete-preset-algolia></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@algolia/autocomplete-theme-classic><div id=autocomplete></div><script>var searchClient=algoliasearch("8HJOK7X4MI","a882cdf8954678175d442905d08d8926");const{autocomplete}=window["@algolia/autocomplete-js"],{getAlgoliaResults}=window["@algolia/autocomplete-preset-algolia"];autocomplete({container:"#autocomplete",placeholder:"Search",getSources({query:e}){return[{sourceId:"title",getItems(){return getAlgoliaResults({searchClient,queries:[{indexName:"mpostument",query:e,params:{hitsPerPage:5,attributesToSnippet:["title:15","description:35"],snippetEllipsisText:"…"}}]})},templates:{item({item:e,components:t,html:n}){return n`<div class="aa-ItemWrapper">
                            <div class="aa-ItemContent">
                              <div class="aa-ItemContentBody">
                                <div class="aa-ItemContentTitle">
                                  ${t.Highlight({hit:e,attribute:"title"})}
                                </div>
                                <div class="aa-ItemContentDescription">
                                  ${t.Snippet({hit:e,attribute:"description"})}
                                </div>
                              </div>
                            </div>
                          </div>`}},getItemUrl({item:e}){return e.href},onSelect({item:e}){window.location.href=e.href}}]}})</script></head><body class=blue><div class="container center headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>mpostument.com</div></a></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=/>Home</a></li><li><a href=/programming/>Programming</a></li><li><a href=/drawing/>Drawing</a></li><li><a href=/projects/>Projects</a></li><li><a href=/tags/>Tags</a></li><li><a href=/categories/>Categories</a></li><hr><li><a href=https://mpostument.com/>English</a></li><li><a href=https://mpostument.com/ua/>Ukraine</a></li></ul></li></ul><ul class="menu menu--desktop menu--language-selector"><li class=menu__trigger>English&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=https://mpostument.com/>English</a></li><li><a href=https://mpostument.com/ua/>Ukraine</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><a href=/>Home</a></li><li><a href=/programming/>Programming</a></li><li><a href=/drawing/>Drawing</a></li><li><a href=/projects/>Projects</a></li><li><a href=/tags/>Tags</a></li><li><a href=/categories/>Categories</a></li></ul></nav></header><div class=content><article class=post><h1 class=post-title><a href=https://mpostument.com/programming/dotnet/build-dotnet-core-with-travis/>Build Dotnet Core With Travis</a></h1><div class=post-meta><time class=post-date>2020-08-31</time><span class=post-author>Maksym Postument</span><span class=post-reading-time>3 min read (536 words)</span></div><span class=post-tags>#<a href=https://mpostument.com/tags/travis/>Travis</a>&nbsp;
#<a href=https://mpostument.com/tags/.net-core/>.Net Core</a>&nbsp;
#<a href=https://mpostument.com/tags/devops/>Devops</a>&nbsp;</span>
<img src=https://i.imgur.com/MfGG4k8.png class=post-cover alt="Build Dotnet Core With Travis" title="Cover Image"><div class=post-content><div><p>Hello!</p><p>Today I want to show how you can build and deploy .net core with <a href=https://travis-ci.com/>Travis</a>.<br>To get started, you need to create a Travis account. This requires you to <a href=https://travis-ci.com/signin>login</a> with your GitHub account.
<img src=https://i.imgur.com/L9lOBo8.png alt=Login></p><h2 id=travisyml-configuration>.travis.yml Configuration<a href=#travisyml-configuration class=hanchor arialabel=Anchor>&#8983;</a></h2><p>The next step is to create a .travis.yml file in the root of the repository.<br>Example of my configuration file:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>language</span>: <span style=color:#ae81ff>csharp</span>
</span></span><span style=display:flex><span><span style=color:#f92672>mono</span>: <span style=color:#ae81ff>none</span>
</span></span><span style=display:flex><span><span style=color:#f92672>dotnet</span>: <span style=color:#ae81ff>3.1.4</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>solution</span>: <span style=color:#ae81ff>awstaghelper.sln</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>install</span>:
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>dotnet restore</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>script</span>:
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>dotnet build --configuration Release --runtime win-x64 --output win-x64</span>
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>dotnet build --configuration Release --runtime win-x86 --output win-x86</span>
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>dotnet build --configuration Release --runtime linux-x64 --output linux-x64</span>
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>dotnet build --configuration Release --runtime osx-x64 --output osx-x64</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>before_deploy</span>:
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>zip -r9 win-x64.zip win-x64</span>
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>zip -r9 win-x86.zip win-x86</span>
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>zip -r9 linux-x64.zip linux-x64</span>
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>zip -r9 osx-x64.zip osx-x64</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>deploy</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>provider</span>: <span style=color:#ae81ff>releases</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>api_key</span>: <span style=color:#ae81ff>$api_key</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>file</span>:
</span></span><span style=display:flex><span>    - <span style=color:#ae81ff>win-x64.zip</span>
</span></span><span style=display:flex><span>    - <span style=color:#ae81ff>win-x86.zip</span>
</span></span><span style=display:flex><span>    - <span style=color:#ae81ff>linux-x64.zip</span>
</span></span><span style=display:flex><span>    - <span style=color:#ae81ff>osx-x64.zip</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>skip_cleanup</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>on</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>tags</span>: <span style=color:#66d9ef>true</span>
</span></span></code></pre></div><h2 id=net-configuration>.Net configuration<a href=#net-configuration class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Now let&rsquo;s review the config.<br>Yml begins with the declaration of the programming language <code>language: csharp</code>. <code>mono</code>
is none because the .net core is used. And the last is the .net core version. In my case it is <code>dotnet: 3.1.4</code>. You also need to specify the name of the solution <code>solution: awstaghelper.sln</code>.</p><h2 id=build-configuration>Build configuration<a href=#build-configuration class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Next are the build steps. Step <code>install</code> used to install the necessary dependencies. <code>dotnet restore</code> is optional as in the latest versions of dotnet <code>restore</code> the command is automatically called when <code>build</code>. Because of this, <code>install</code> can be completely removed.</p><p>In the <code>script</code> section there is a build of application. I call the <code>build</code> command 4 times because I build for different OS: Windows, Linux, Mac. The operating system is indicated by the <code>--runtime</code> key. A list of all runtime is available <a href=https://docs.microsoft.com/en-us/dotnet/core/rid-catalog#rid-graph>here</a>. <code>--output</code> key specifies in which directory to put binaries.
You can also add the <code>/p:PublishSingleFile=true</code> key to get only one exe file as a result per OS. You can also add this key in the project settings in Visual Studio.</p><h2 id=deployment-configuration>Deployment configuration<a href=#deployment-configuration class=hanchor arialabel=Anchor>&#8983;</a></h2><p>The <code>before_deploy</code> section is called before the deployment to prepare the binary for release. At this stage, I make an archive with the binaries that I received after the builds for the each operating system.</p><p>In the <code>deploy</code> section I use the <code>releases</code> provider which releases on github. List of all providers - <a href=https://docs.travis-ci.com/user/deployment/>docs.travis-ci.com</a>. A github token is required for deployment. You can generate it on <a href=https://github.com/settings/tokens>GitHub</a>.
The key must be saved in the travis configuration of the project. To do this, go to the project on <a href=https://travis-ci.com/>Travis</a>. Open project/settings:
<img src=https://i.imgur.com/nHrz23b.png alt=Config>.</p><p>In Environment Variables you need to add the generated key:
<img src=https://i.imgur.com/wfnfkzi.png alt=Token>
In <code>file</code> you need to specify which files should be deployed using the provider. <code>skip_cleanup: true</code> must be <code>true</code> so that travis does not clear whipped files before deployment. <code>on.tags: true</code> means that the deployment run only on github tags.</p><p>Once the file is ready you need to make run changes to the master and the build will start automatically. But the deployment will not take place, because it trigger only on tags. On <a href=https://github.com/>GitHub</a> you need to create release for the desired repository. Once the release is done the build will run again, but this time with a deployment.</p><p>In <a href=https://travis-ci.com/>Travis</a> you can see the following result:
<img src=https://i.imgur.com/02OKZ1R.png alt=Build></p></div></div><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//mpostument-com.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></article></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2023 Powered by <a href=https://gohugo.io>Hugo</a></span>
<span>:: <a href=https://github.com/panr/hugo-theme-terminal target=_blank>Theme</a> made by <a href=https://github.com/panr target=_blank>panr</a></span></div></div></footer><script type=text/javascript src=/bundle.min.js></script></div></body></html>