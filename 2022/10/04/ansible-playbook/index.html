<!doctype html><html lang=en><head><title>Ansible Playbook :: Maksym Postument</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Third article in series about ansible. In this article, I will show how to use a playbook to create reusable code"><meta name=keywords content="VSCode,Devops,Ansible,pyenv,RedHat,Beginner,virtualenv,boto3"><meta name=robots content="noodp"><link rel=canonical href=https://mpostument.com/2022/10/04/ansible-playbook/><script async src="https://www.googletagmanager.com/gtag/js?id=G-SBRJXS94DC"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-SBRJXS94DC",{anonymize_ip:!1})}</script><link rel=stylesheet href=/style.css><link rel="shortcut icon" href=https://mpostument.com/img/theme-colors/blue.png><link rel=apple-touch-icon href=https://mpostument.com/img/theme-colors/blue.png><meta name=twitter:card content="summary"><meta name=twitter:site content="mpostument.com"><meta name=twitter:creator content="Maks_Postument"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="Ansible Playbook"><meta property="og:description" content="Third article in series about ansible. In this article, I will show how to use a playbook to create reusable code"><meta property="og:url" content="https://mpostument.com/2022/10/04/ansible-playbook/"><meta property="og:site_name" content="Maksym Postument"><meta property="og:image" content="https://mpostument.com/ansible/ansible-playbook.jpg"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><meta property="article:section" content="Devops"><meta property="article:section" content="Ansible"><meta property="article:section" content="Beginner"><meta property="article:published_time" content="2022-10-04 22:51:59 +0300 +0300"><p align=center style=background-color:#23b0ff>Sign up for my <a href=https://tinyletter.com/mpostument>email
newsletter</a> or use this <a href=/index.xml>RSS feed</a> to get notified of new blog posts.</p><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8633398301520801" crossorigin=anonymous></script></head><body class=blue><div class="container center headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>mpostument.com</div></a></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=/>Home</a></li><li><a href=/categories/>Categories</a></li><li><a href=/tags/>Tags</a></li><li><a href=/projects/>Projects</a></li><hr><li><a href=https://mpostument.com/>English</a></li><li><a href=https://mpostument.com/ua/>Ukraine</a></li></ul></li></ul><ul class="menu menu--desktop menu--language-selector"><li class=menu__trigger>English&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=https://mpostument.com/>English</a></li><li><a href=https://mpostument.com/ua/>Ukraine</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><a href=/>Home</a></li><li><a href=/categories/>Categories</a></li><li><a href=/tags/>Tags</a></li><li><a href=/projects/>Projects</a></li></ul></nav></header><div class=content><article class=post><h1 class=post-title><a href=https://mpostument.com/2022/10/04/ansible-playbook/>Ansible Playbook</a></h1><div class=post-meta><time class=post-date>2022-10-04 ::</time>
<span class=post-author>Maksym Postument</span>
<span class=post-reading-time>:: 10 min read (2097 words)</span></div><span class=post-tags>#<a href=https://mpostument.com/tags/vscode/>VSCode</a>&nbsp;
#<a href=https://mpostument.com/tags/devops/>Devops</a>&nbsp;
#<a href=https://mpostument.com/tags/ansible/>Ansible</a>&nbsp;
#<a href=https://mpostument.com/tags/pyenv/>pyenv</a>&nbsp;
#<a href=https://mpostument.com/tags/redhat/>RedHat</a>&nbsp;
#<a href=https://mpostument.com/tags/beginner/>Beginner</a>&nbsp;</span>
<img src=https://mpostument.com/ansible/ansible-playbook.jpg class=post-cover alt="Ansible Playbook" title="Cover Image"><div class=table-of-contents><h2>Table of Contents</h2><nav id=TableOfContents><ul><li><a href=#playbook>Playbook</a></li><li><a href=#ansible-host-variables>Ansible host variables</a></li><li><a href=#debug>Debug</a></li><li><a href=#register-and-set-facts>Register and Set Facts</a></li><li><a href=#condition>Condition</a></li><li><a href=#block>Block</a></li><li><a href=#loop>Loop</a><ul><li><a href=#simple-list>Simple list</a></li><li><a href=#list-of-hashes>List of hashes</a></li><li><a href=#register-var-in-loop>Register var in loop</a></li></ul></li><li><a href=#delegate-to>Delegate To</a></li><li><a href=#failed-when>Failed when</a></li><li><a href=#ignore-errors>Ignore Errors</a></li><li><a href=#video>Video</a></li></ul></nav></div><div class=post-content><div><p><a href=https://mpostument.com/2022/09/19/manage-ansible-versions-with-pyenv/ title="Part 1 - Manage Ansible Versions With pyenv">Part 1 - Manage Ansible Versions With pyenv</a><br><a href=https://mpostument.com/2022/09/27/ansible-inventory/ title="Part 2 - Ansible Inventory">Part 2 - Ansible Inventory</a></p><p>Hello!</p><p>Today I will show what ansible-playbook is and how to create it.</p><h2 id=playbook>Playbook<a href=#playbook class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Ansible Playbooks is an iterative, reusable, configuration management and deployment framework that is well-suited for deploying complex applications. If you need to run a task with Ansible more than once, you can do it with a playbook.</p><p>Let&rsquo;s create the simplest playbook. In the playbook, you need to specify its name, the group of servers on which it will be executed, and the tasks themselves.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>---
</span></span><span style=display:flex><span>- <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Update web servers</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>hosts</span>: <span style=color:#ae81ff>webapp</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>tasks</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Ensure apache is at the latest version</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>ansible.builtin.yum</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>name</span>: <span style=color:#ae81ff>httpd</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>state</span>: <span style=color:#ae81ff>latest</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>become</span>: <span style=color:#66d9ef>true</span>
</span></span></code></pre></div><p>In this example, the playbook is executed on the <code>webapp</code> server group. On all servers from this group, ansible installs the latest version of the <code>httpd</code> package using the <a href=https://docs.ansible.com/ansible/latest/collections/ansible/builtin/yum_module.html>yum</a> module. Before executing the task, ansible checks whether the package is installed, if it is installed, nothing will happen.</p><p>The playbook is started using the <code>ansible-playbook</code> command. Let&rsquo;s save our playbook under the name <code>main.yml</code> and run it</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ ansible-playbook -i inventory main.yml
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PLAY <span style=color:#f92672>[</span>Update web servers<span style=color:#f92672>]</span> ******************************************************************************************************
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TASK <span style=color:#f92672>[</span>Gathering Facts<span style=color:#f92672>]</span> *********************************************************************************************************
</span></span><span style=display:flex><span>ok: <span style=color:#f92672>[</span>3.92.61.18<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TASK <span style=color:#f92672>[</span>Ensure apache is at the latest version<span style=color:#f92672>]</span> **********************************************************************************
</span></span><span style=display:flex><span>changed: <span style=color:#f92672>[</span>3.92.61.18<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PLAY RECAP *********************************************************************************************************************
</span></span><span style=display:flex><span>3.92.61.18                 : ok<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span>    changed<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>    unreachable<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    failed<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    skipped<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    rescued<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    ignored<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>  
</span></span></code></pre></div><h2 id=ansible-host-variables>Ansible host variables<a href=#ansible-host-variables class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Before the playbook starts executing, ansible collects information about the server. This option can be disabled by specifying <code>gather_facts: false</code> in the playbook. Ansible collects a lot of information about the operating system, network settings, and more in this way</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;ansible_all_ipv4_addresses&#34;</span>: [
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;REDACTED IP ADDRESS&#34;</span>
</span></span><span style=display:flex><span>    ],
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;ansible_all_ipv6_addresses&#34;</span>: [
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;REDACTED IPV6 ADDRESS&#34;</span>
</span></span><span style=display:flex><span>    ],
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;ansible_apparmor&#34;</span>: {
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;status&#34;</span>: <span style=color:#e6db74>&#34;disabled&#34;</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;ansible_architecture&#34;</span>: <span style=color:#e6db74>&#34;x86_64&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;ansible_bios_date&#34;</span>: <span style=color:#e6db74>&#34;10/02/2022&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;ansible_bios_version&#34;</span>: <span style=color:#e6db74>&#34;4.1.5&#34;</span>,
</span></span></code></pre></div><p>To see all information, you can call the run command ansible command setup, and all parameters will be printed.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>ansible -i inventory all -m ansible.builtin.setup
</span></span></code></pre></div><h2 id=debug>Debug<a href=#debug class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Sometimes you need to debug the execution of the playbook or look at the values of some parameters, all this can be done using the <a href=https://docs.ansible.com/ansible/latest/collections/ansible/builtin/debug_module.html>debug</a> module.</p><p>For example, I need to see the value of the <code>ansible_bios_version</code> parameter, obtained using gather_facts in the playbook startup process. This can be done like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>- <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Print bios version</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>ansible.builtin.debug</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>msg</span>: <span style=color:#ae81ff>Bios version is {{ ansible_bios_version }}</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ ansible-playbook -i inventory main.yml                              ✘ INT  ansible-210 3.9.13 17:29:55
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PLAY <span style=color:#f92672>[</span>Update web servers<span style=color:#f92672>]</span> ******************************************************************************************************
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TASK <span style=color:#f92672>[</span>Gathering Facts<span style=color:#f92672>]</span> *********************************************************************************************************
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ok: <span style=color:#f92672>[</span>3.92.61.18<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TASK <span style=color:#f92672>[</span>Print bios version<span style=color:#f92672>]</span> ******************************************************************************************************
</span></span><span style=display:flex><span>ok: <span style=color:#f92672>[</span>3.92.61.18<span style=color:#f92672>]</span> <span style=color:#f92672>=</span>&gt; <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;msg&#34;</span>: <span style=color:#e6db74>&#34;Bios version is 4.11.amazon&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PLAY RECAP *********************************************************************************************************************
</span></span><span style=display:flex><span>3.92.61.18                 : ok<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span>    changed<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    unreachable<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    failed<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    skipped<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    rescued<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    ignored<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span></code></pre></div><h2 id=register-and-set-facts>Register and Set Facts<a href=#register-and-set-facts class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Also, in Ansible, you can create parameters based on the result of the task. For example, I want to get how long the system has been running. This can be done by calling the Linux <code>uptime</code> command. But if I do it like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>- <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Get uptime information</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>ansible.builtin.shell</span>: <span style=color:#ae81ff>/usr/bin/uptime</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ ansible-playbook -i inventory main.yml
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PLAY <span style=color:#f92672>[</span>Update web servers<span style=color:#f92672>]</span> ******************************************************************************************************
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TASK <span style=color:#f92672>[</span>Gathering Facts<span style=color:#f92672>]</span> *********************************************************************************************************
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ok: <span style=color:#f92672>[</span>3.92.61.18<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TASK <span style=color:#f92672>[</span>Get uptime information<span style=color:#f92672>]</span> **************************************************************************************************
</span></span><span style=display:flex><span>changed: <span style=color:#f92672>[</span>3.92.61.18<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PLAY RECAP *********************************************************************************************************************
</span></span><span style=display:flex><span>3.92.61.18                 : ok<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span>    changed<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>    unreachable<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    failed<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    skipped<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    rescued<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    ignored<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span> 
</span></span></code></pre></div><p>As a result, I get nothing. To get a response from the <code>uptime</code> command, I need to save the result in a variable. This is done using <code>register: VAR_NAME</code> and then the value of this variable can be output to the terminal.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>- <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Get uptime information</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>ansible.builtin.shell</span>: <span style=color:#ae81ff>/usr/bin/uptime</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>register</span>: <span style=color:#ae81ff>sys_uptime</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Print system uptime</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>ansible.builtin.debug</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>msg</span>: <span style=color:#e6db74>&#34;{{ sys_uptime }}&#34;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ ansible-playbook -i inventory main.yml
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PLAY <span style=color:#f92672>[</span>Update web servers<span style=color:#f92672>]</span> ******************************************************************************************************
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TASK <span style=color:#f92672>[</span>Gathering Facts<span style=color:#f92672>]</span> *********************************************************************************************************
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ok: <span style=color:#f92672>[</span>3.92.61.18<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TASK <span style=color:#f92672>[</span>Get uptime information<span style=color:#f92672>]</span> **************************************************************************************************
</span></span><span style=display:flex><span>changed: <span style=color:#f92672>[</span>3.92.61.18<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TASK <span style=color:#f92672>[</span>Print system uptime<span style=color:#f92672>]</span> *****************************************************************************************************
</span></span><span style=display:flex><span>ok: <span style=color:#f92672>[</span>3.92.61.18<span style=color:#f92672>]</span> <span style=color:#f92672>=</span>&gt; <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;msg&#34;</span>: <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;changed&#34;</span>: true,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;cmd&#34;</span>: <span style=color:#e6db74>&#34;/usr/bin/uptime&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;delta&#34;</span>: <span style=color:#e6db74>&#34;0:00:00.005060&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;end&#34;</span>: <span style=color:#e6db74>&#34;2022-10-07 14:31:50.846284&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;failed&#34;</span>: false,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;msg&#34;</span>: <span style=color:#e6db74>&#34;&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;rc&#34;</span>: 0,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;start&#34;</span>: <span style=color:#e6db74>&#34;2022-10-07 14:31:50.841224&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;stderr&#34;</span>: <span style=color:#e6db74>&#34;&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;stderr_lines&#34;</span>: <span style=color:#f92672>[]</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;stdout&#34;</span>: <span style=color:#e6db74>&#34; 14:31:50 up 15 min,  1 user,  load average: 0,01, 0,05, 0,02&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;stdout_lines&#34;</span>: <span style=color:#f92672>[</span>
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34; 14:31:50 up 15 min,  1 user,  load average: 0,01, 0,05, 0,02&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PLAY RECAP *********************************************************************************************************************
</span></span><span style=display:flex><span>3.92.61.18                 : ok<span style=color:#f92672>=</span><span style=color:#ae81ff>3</span>    changed<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>    unreachable<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    failed<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    skipped<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    rescued<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    ignored<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span></code></pre></div><p>If during execution you need to create a parameter, this can be done using the [set_fact] (<a href=https://docs.ansible.com/ansible/latest/collections/ansible/builtin/set_fact_module.html>https://docs.ansible.com/ansible/latest/collections/ansible/builtin/set_fact_module.html</a>) module</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>- <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Setting host facts using complex arguments</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>ansible.builtin.set_fact</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>important_var</span>: <span style=color:#ae81ff>important_value</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Print important value</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>ansible.builtin.debug</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>msg</span>: <span style=color:#e6db74>&#34;{{ important_var }}&#34;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ ansible-playbook -i inventory main.yml
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PLAY <span style=color:#f92672>[</span>Update web servers<span style=color:#f92672>]</span> ******************************************************************************************************
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TASK <span style=color:#f92672>[</span>Gathering Facts<span style=color:#f92672>]</span> *********************************************************************************************************
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ok: <span style=color:#f92672>[</span>3.92.61.18<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TASK <span style=color:#f92672>[</span>Setting host facts using complex arguments<span style=color:#f92672>]</span> ******************************************************************************
</span></span><span style=display:flex><span>ok: <span style=color:#f92672>[</span>3.92.61.18<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TASK <span style=color:#f92672>[</span>Print important value<span style=color:#f92672>]</span> ***************************************************************************************************
</span></span><span style=display:flex><span>ok: <span style=color:#f92672>[</span>3.92.61.18<span style=color:#f92672>]</span> <span style=color:#f92672>=</span>&gt; <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;msg&#34;</span>: <span style=color:#e6db74>&#34;important_value&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PLAY RECAP *********************************************************************************************************************
</span></span><span style=display:flex><span>3.92.61.18                 : ok<span style=color:#f92672>=</span><span style=color:#ae81ff>3</span>    changed<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    unreachable<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    failed<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    skipped<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    rescued<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    ignored<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span> 
</span></span></code></pre></div><h2 id=condition>Condition<a href=#condition class=hanchor arialabel=Anchor>&#8983;</a></h2><p>It is good when the playbook is universal and can work on different operating systems. But what if we have specific tasks that should be performed in Ubuntu but not in RedHat. This can be done using conditions. Let&rsquo;s try to create a universal playbook that will install apache http regardless of the OS version. For RedHat we need to use the <a href=https://docs.ansible.com/ansible/latest/collections/ansible/builtin/yum_module.html>yum</a> module and for Ubuntu <a href=https://docs.ansible.com/ansible/latest/collections/ansible/builtin/apt_module.html>apt</a>. Let&rsquo;s use the condition <a href=https://docs.ansible.com/ansible/latest/user_guide/playbooks_conditionals.html#id2>when</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>- <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Install apache on Redhat</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>ansible.builtin.yum</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>name</span>: <span style=color:#ae81ff>httpd</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>state</span>: <span style=color:#ae81ff>latest</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>when</span>: <span style=color:#ae81ff>ansible_facts[&#39;os_family&#39;] == &#34;RedHat&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Install apache on Debian</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>ansible.builtin.apt</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>name</span>: <span style=color:#ae81ff>apache2</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>state</span>: <span style=color:#ae81ff>latest</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>when</span>: <span style=color:#ae81ff>ansible_facts[&#39;os_family&#39;] == &#34;Debian&#34;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ ansible-playbook -i inventory main.yml
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PLAY <span style=color:#f92672>[</span>Update web servers<span style=color:#f92672>]</span> ******************************************************************************************************
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TASK <span style=color:#f92672>[</span>Gathering Facts<span style=color:#f92672>]</span> *********************************************************************************************************
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ok: <span style=color:#f92672>[</span>3.92.61.18<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TASK <span style=color:#f92672>[</span>Install apache on Redhat<span style=color:#f92672>]</span> ************************************************************************************************
</span></span><span style=display:flex><span>ok: <span style=color:#f92672>[</span>3.92.61.18<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TASK <span style=color:#f92672>[</span>Install apache on Debian<span style=color:#f92672>]</span> ************************************************************************************************
</span></span><span style=display:flex><span>skipping: <span style=color:#f92672>[</span>3.92.61.18<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PLAY RECAP *********************************************************************************************************************
</span></span><span style=display:flex><span>3.92.61.18                 : ok<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span>    changed<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    unreachable<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    failed<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    skipped<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>    rescued<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    ignored<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span> 
</span></span></code></pre></div><p>Thus, the task is executed only if the condition returns `True&rsquo;, otherwise not.</p><h2 id=block>Block<a href=#block class=hanchor arialabel=Anchor>&#8983;</a></h2><p><a href=https://docs.ansible.com/ansible/latest/user_guide/playbooks_blocks.html>Block</a> is used to logically combine tasks in Ansible. For example, you can organize all tasks for Ubuntu and apply a condition at the block level. For example, sometimes not.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span>- <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Debian block</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>block</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Install apache on Ubuntu</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>ansible.builtin.apt</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>name</span>: <span style=color:#ae81ff>apache2</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>state</span>: <span style=color:#ae81ff>latest</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Start service apache2, if not started</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>ansible.builtin.service</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>name</span>: <span style=color:#ae81ff>apache2</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>state</span>: <span style=color:#ae81ff>started</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>when</span>: <span style=color:#ae81ff>ansible_facts[&#39;os_family&#39;] == &#34;Debian&#34;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ ansible-playbook -i inventory main.yml
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PLAY <span style=color:#f92672>[</span>Update web servers<span style=color:#f92672>]</span> ******************************************************************************************************
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TASK <span style=color:#f92672>[</span>Gathering Facts<span style=color:#f92672>]</span> *********************************************************************************************************
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ok: <span style=color:#f92672>[</span>3.92.61.18<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TASK <span style=color:#f92672>[</span>Install apache on Ubuntu<span style=color:#f92672>]</span> ************************************************************************************************
</span></span><span style=display:flex><span>skipping: <span style=color:#f92672>[</span>3.92.61.18<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TASK <span style=color:#f92672>[</span>Start service apache2, <span style=color:#66d9ef>if</span> not started<span style=color:#f92672>]</span> ***********************************************************************************
</span></span><span style=display:flex><span>skipping: <span style=color:#f92672>[</span>3.92.61.18<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PLAY RECAP *********************************************************************************************************************
</span></span><span style=display:flex><span>3.92.61.18                 : ok<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>    changed<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    unreachable<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    failed<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    skipped<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span>    rescued<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    ignored<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span></code></pre></div><p>You can also handle errors using rescue and always. The rescue block is executed only if an error occurs in the main block. Always is always launched, regardless of what happened in the previous block.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span>- <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Error block</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>block</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Print a message</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>ansible.builtin.debug</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>msg</span>: <span style=color:#e6db74>&#39;I execute normally&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Force a failure</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>ansible.builtin.command</span>: <span style=color:#ae81ff>/bin/false</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Never print this</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>ansible.builtin.debug</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>msg</span>: <span style=color:#e6db74>&#39;I never execute, due to the above task failing, :-(&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>rescue</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Print when errors</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>ansible.builtin.debug</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>msg</span>: <span style=color:#e6db74>&#39;I caught an error&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Force a failure in middle of recovery! &gt;:-)</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>ansible.builtin.command</span>: <span style=color:#ae81ff>/bin/false</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Never print this</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>ansible.builtin.debug</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>msg</span>: <span style=color:#e6db74>&#39;I also never execute :-(&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>always</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Always do this</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>ansible.builtin.debug</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>msg</span>: <span style=color:#e6db74>&#34;This always executes&#34;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ ansible-playbook -i inventory main.yml
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PLAY <span style=color:#f92672>[</span>Update web servers<span style=color:#f92672>]</span> ******************************************************************************************************
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TASK <span style=color:#f92672>[</span>Gathering Facts<span style=color:#f92672>]</span> *********************************************************************************************************
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ok: <span style=color:#f92672>[</span>3.92.61.18<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TASK <span style=color:#f92672>[</span>Print a message<span style=color:#f92672>]</span> *********************************************************************************************************
</span></span><span style=display:flex><span>ok: <span style=color:#f92672>[</span>3.92.61.18<span style=color:#f92672>]</span> <span style=color:#f92672>=</span>&gt; <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;msg&#34;</span>: <span style=color:#e6db74>&#34;I execute normally&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TASK <span style=color:#f92672>[</span>Force a failure<span style=color:#f92672>]</span> *********************************************************************************************************
</span></span><span style=display:flex><span>fatal: <span style=color:#f92672>[</span>3.92.61.18<span style=color:#f92672>]</span>: FAILED! <span style=color:#f92672>=</span>&gt; <span style=color:#f92672>{</span><span style=color:#e6db74>&#34;changed&#34;</span>: true, <span style=color:#e6db74>&#34;cmd&#34;</span>: <span style=color:#f92672>[</span><span style=color:#e6db74>&#34;/bin/false&#34;</span><span style=color:#f92672>]</span>, <span style=color:#e6db74>&#34;delta&#34;</span>: <span style=color:#e6db74>&#34;0:00:00.003974&#34;</span>, <span style=color:#e6db74>&#34;end&#34;</span>: <span style=color:#e6db74>&#34;2022-10-07 14:37:27.522485&#34;</span>, <span style=color:#e6db74>&#34;msg&#34;</span>: <span style=color:#e6db74>&#34;non-zero return code&#34;</span>, <span style=color:#e6db74>&#34;rc&#34;</span>: 1, <span style=color:#e6db74>&#34;start&#34;</span>: <span style=color:#e6db74>&#34;2022-10-07 14:37:27.518511&#34;</span>, <span style=color:#e6db74>&#34;stderr&#34;</span>: <span style=color:#e6db74>&#34;&#34;</span>, <span style=color:#e6db74>&#34;stderr_lines&#34;</span>: <span style=color:#f92672>[]</span>, <span style=color:#e6db74>&#34;stdout&#34;</span>: <span style=color:#e6db74>&#34;&#34;</span>, <span style=color:#e6db74>&#34;stdout_lines&#34;</span>: <span style=color:#f92672>[]}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TASK <span style=color:#f92672>[</span>Print when errors<span style=color:#f92672>]</span> *******************************************************************************************************
</span></span><span style=display:flex><span>ok: <span style=color:#f92672>[</span>3.92.61.18<span style=color:#f92672>]</span> <span style=color:#f92672>=</span>&gt; <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;msg&#34;</span>: <span style=color:#e6db74>&#34;I caught an error&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TASK <span style=color:#f92672>[</span>Force a failure in middle of recovery! &gt;:-<span style=color:#f92672>)]</span> *****************************************************************************
</span></span><span style=display:flex><span>fatal: <span style=color:#f92672>[</span>3.92.61.18<span style=color:#f92672>]</span>: FAILED! <span style=color:#f92672>=</span>&gt; <span style=color:#f92672>{</span><span style=color:#e6db74>&#34;changed&#34;</span>: true, <span style=color:#e6db74>&#34;cmd&#34;</span>: <span style=color:#f92672>[</span><span style=color:#e6db74>&#34;/bin/false&#34;</span><span style=color:#f92672>]</span>, <span style=color:#e6db74>&#34;delta&#34;</span>: <span style=color:#e6db74>&#34;0:00:00.002841&#34;</span>, <span style=color:#e6db74>&#34;end&#34;</span>: <span style=color:#e6db74>&#34;2022-10-07 14:37:30.324774&#34;</span>, <span style=color:#e6db74>&#34;msg&#34;</span>: <span style=color:#e6db74>&#34;non-zero return code&#34;</span>, <span style=color:#e6db74>&#34;rc&#34;</span>: 1, <span style=color:#e6db74>&#34;start&#34;</span>: <span style=color:#e6db74>&#34;2022-10-07 14:37:30.321933&#34;</span>, <span style=color:#e6db74>&#34;stderr&#34;</span>: <span style=color:#e6db74>&#34;&#34;</span>, <span style=color:#e6db74>&#34;stderr_lines&#34;</span>: <span style=color:#f92672>[]</span>, <span style=color:#e6db74>&#34;stdout&#34;</span>: <span style=color:#e6db74>&#34;&#34;</span>, <span style=color:#e6db74>&#34;stdout_lines&#34;</span>: <span style=color:#f92672>[]}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TASK <span style=color:#f92672>[</span>Always <span style=color:#66d9ef>do</span> this<span style=color:#f92672>]</span> **********************************************************************************************************
</span></span><span style=display:flex><span>ok: <span style=color:#f92672>[</span>3.92.61.18<span style=color:#f92672>]</span> <span style=color:#f92672>=</span>&gt; <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;msg&#34;</span>: <span style=color:#e6db74>&#34;This always executes&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PLAY RECAP *********************************************************************************************************************
</span></span><span style=display:flex><span>3.92.61.18                 : ok<span style=color:#f92672>=</span><span style=color:#ae81ff>4</span>    changed<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    unreachable<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    failed<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>    skipped<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    rescued<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>    ignored<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span></code></pre></div><h2 id=loop>Loop<a href=#loop class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Ansible has several types of <a href=https://docs.ansible.com/ansible/latest/user_guide/playbooks_loops.html>loops</a>. Let&rsquo;s start with the simplest loop through the list. In this post, we will check only the simplest one</p><h3 id=simple-list>Simple list<a href=#simple-list class=hanchor arialabel=Anchor>&#8983;</a></h3><p>In this case, several users (testuser1 and testuser2) are created, which are specified in the loop block, and <code>{{ item }}</code> is specified instead of the user name, which will be replaced by the user name when executed</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>- <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Add several users</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>ansible.builtin.user</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;{{ item }}&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>state</span>: <span style=color:#ae81ff>present</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>groups</span>: <span style=color:#e6db74>&#34;wheel&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>loop</span>:
</span></span><span style=display:flex><span>    - <span style=color:#ae81ff>testuser1</span>
</span></span><span style=display:flex><span>    - <span style=color:#ae81ff>testuser2</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>become</span>: <span style=color:#66d9ef>true</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ ansible-playbook -i inventory main.yml
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PLAY <span style=color:#f92672>[</span>Update web servers<span style=color:#f92672>]</span> ******************************************************************************************************
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TASK <span style=color:#f92672>[</span>Gathering Facts<span style=color:#f92672>]</span> *********************************************************************************************************
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ok: <span style=color:#f92672>[</span>3.92.61.18<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TASK <span style=color:#f92672>[</span>Add several users<span style=color:#f92672>]</span> *******************************************************************************************************
</span></span><span style=display:flex><span>changed: <span style=color:#f92672>[</span>3.92.61.18<span style=color:#f92672>]</span> <span style=color:#f92672>=</span>&gt; <span style=color:#f92672>(</span>item<span style=color:#f92672>=</span>testuser1<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>changed: <span style=color:#f92672>[</span>3.92.61.18<span style=color:#f92672>]</span> <span style=color:#f92672>=</span>&gt; <span style=color:#f92672>(</span>item<span style=color:#f92672>=</span>testuser2<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PLAY RECAP *********************************************************************************************************************
</span></span><span style=display:flex><span>3.92.61.18                 : ok<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span>    changed<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>    unreachable<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    failed<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    skipped<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    rescued<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    ignored<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span></code></pre></div><h3 id=list-of-hashes>List of hashes<a href=#list-of-hashes class=hanchor arialabel=Anchor>&#8983;</a></h3><p>This is how the cycle looks like through the list of hash maps. The cycle looks the same as the previous one but with one difference in the task block the name of the key from the map is added to <code>{{ item }}</code> and then the value of the name field will look like <code>"{{ item.name }}"</code> and the group <code>"{ { item.groups }}"</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span>- <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Add several users</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>ansible.builtin.user</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;{{ item.name }}&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>state</span>: <span style=color:#ae81ff>present</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>groups</span>: <span style=color:#e6db74>&#34;{{ item.groups }}&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>loop</span>:
</span></span><span style=display:flex><span>    - { <span style=color:#f92672>name: &#39;testuser3&#39;, groups</span>: <span style=color:#e6db74>&#39;wheel&#39;</span> }
</span></span><span style=display:flex><span>    - { <span style=color:#f92672>name: &#39;testuser4&#39;, groups</span>: <span style=color:#e6db74>&#39;root&#39;</span> }
</span></span><span style=display:flex><span>  <span style=color:#f92672>become</span>: <span style=color:#66d9ef>true</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ ansible-playbook -i inventory main.yml
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PLAY <span style=color:#f92672>[</span>Update web servers<span style=color:#f92672>]</span> ******************************************************************************************************
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TASK <span style=color:#f92672>[</span>Gathering Facts<span style=color:#f92672>]</span> *********************************************************************************************************
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ok: <span style=color:#f92672>[</span>3.92.61.18<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TASK <span style=color:#f92672>[</span>Add several users<span style=color:#f92672>]</span> *******************************************************************************************************
</span></span><span style=display:flex><span>changed: <span style=color:#f92672>[</span>3.92.61.18<span style=color:#f92672>]</span> <span style=color:#f92672>=</span>&gt; <span style=color:#f92672>(</span>item<span style=color:#f92672>={</span><span style=color:#e6db74>&#39;name&#39;</span>: <span style=color:#e6db74>&#39;testuser3&#39;</span>, <span style=color:#e6db74>&#39;groups&#39;</span>: <span style=color:#e6db74>&#39;wheel&#39;</span><span style=color:#f92672>})</span>
</span></span><span style=display:flex><span>changed: <span style=color:#f92672>[</span>3.92.61.18<span style=color:#f92672>]</span> <span style=color:#f92672>=</span>&gt; <span style=color:#f92672>(</span>item<span style=color:#f92672>={</span><span style=color:#e6db74>&#39;name&#39;</span>: <span style=color:#e6db74>&#39;testuser4&#39;</span>, <span style=color:#e6db74>&#39;groups&#39;</span>: <span style=color:#e6db74>&#39;root&#39;</span><span style=color:#f92672>})</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PLAY RECAP *********************************************************************************************************************
</span></span><span style=display:flex><span>3.92.61.18                 : ok<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span>    changed<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>    unreachable<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    failed<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    skipped<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    rescued<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    ignored<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span></code></pre></div><h3 id=register-var-in-loop>Register var in loop<a href=#register-var-in-loop class=hanchor arialabel=Anchor>&#8983;</a></h3><p>If we use a loop and want to use <code>register</code> to save the output of the task, then the result in this case will be saved in a list.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>  - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Register loop output as a variable</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>ansible.builtin.shell</span>: <span style=color:#e6db74>&#34;echo {{ item }}&#34;</span><span style=color:#e6db74>2022-10-02</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>loop</span>:
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#34;one&#34;</span>
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#34;two&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>register</span>: <span style=color:#ae81ff>echo</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Print variable</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>ansible.builtin.debug</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>msg</span>: <span style=color:#e6db74>&#34;{{ echo }}&#34;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;changed&#34;</span>: true,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;msg&#34;</span>: <span style=color:#e6db74>&#34;All items completed&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;results&#34;</span>: <span style=color:#f92672>[</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;changed&#34;</span>: true,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;cmd&#34;</span>: <span style=color:#e6db74>&#34;echo \&#34;one\&#34; &#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;delta&#34;</span>: <span style=color:#e6db74>&#34;0:00:00.003110&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;end&#34;</span>: <span style=color:#e6db74>&#34;2022-10-02 12:00:05.187153&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;invocation&#34;</span>: <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;module_args&#34;</span>: <span style=color:#e6db74>&#34;echo \&#34;one\&#34;&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;module_name&#34;</span>: <span style=color:#e6db74>&#34;shell&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;item&#34;</span>: <span style=color:#e6db74>&#34;one&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;rc&#34;</span>: 0,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;start&#34;</span>: <span style=color:#e6db74>&#34;2022-10-02 12:00:05.184043&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;stderr&#34;</span>: <span style=color:#e6db74>&#34;&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;stdout&#34;</span>: <span style=color:#e6db74>&#34;one&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;changed&#34;</span>: true,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;cmd&#34;</span>: <span style=color:#e6db74>&#34;echo \&#34;two\&#34; &#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;delta&#34;</span>: <span style=color:#e6db74>&#34;0:00:00.002920&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;end&#34;</span>: <span style=color:#e6db74>&#34;2022-10-02 12:00:05.245502&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;invocation&#34;</span>: <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;module_args&#34;</span>: <span style=color:#e6db74>&#34;echo \&#34;two\&#34;&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;module_name&#34;</span>: <span style=color:#e6db74>&#34;shell&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;item&#34;</span>: <span style=color:#e6db74>&#34;two&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;rc&#34;</span>: 0,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;start&#34;</span>: <span style=color:#e6db74>&#34;2022-10-02 12:00:05.242582&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;stderr&#34;</span>: <span style=color:#e6db74>&#34;&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;stdout&#34;</span>: <span style=color:#e6db74>&#34;two&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>]</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h2 id=delegate-to>Delegate To<a href=#delegate-to class=hanchor arialabel=Anchor>&#8983;</a></h2><p><code>delegate_to</code> is used if you need to transfer the execution of tasks to another server or locally. For example, the server is configured, and when finished, it must be added to the load balancer. But the server itself may not have such rights, so the execution of this task can be transferred to a local server that has such rights.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>    - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Add server to load balancer</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>ansible.builtin.command</span>: <span style=color:#ae81ff>echo &#34;Adding to loadbalancer&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>delegate_to</span>: <span style=color:#ae81ff>127.0.0.1</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ ansible-playbook -i inventory main.yml
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PLAY <span style=color:#f92672>[</span>Update web servers<span style=color:#f92672>]</span> ******************************************************************************************************
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TASK <span style=color:#f92672>[</span>Gathering Facts<span style=color:#f92672>]</span> *********************************************************************************************************
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ok: <span style=color:#f92672>[</span>3.92.61.18<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TASK <span style=color:#f92672>[</span>Add server to load balancer<span style=color:#f92672>]</span> *********************************************************************************************
</span></span><span style=display:flex><span>changed: <span style=color:#f92672>[</span>3.92.61.18 -&gt; 127.0.0.1<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PLAY RECAP *********************************************************************************************************************
</span></span><span style=display:flex><span>3.92.61.18                 : ok<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span>    changed<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>    unreachable<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    failed<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    skipped<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    rescued<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    ignored<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span></code></pre></div><h2 id=failed-when>Failed when<a href=#failed-when class=hanchor arialabel=Anchor>&#8983;</a></h2><p>If ansible executes a shell script, it cannot always correctly determine whether the task was completed successfully or not, in such cases, you can use the parameter <code>failed_when</code>, which will describe in which cases the task is considered not completed successfully</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>  - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Making sure the Physical Memory more than 2gb</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>ansible.builtin.shell</span>: <span style=color:#e6db74>&#34;cat /proc/meminfo|grep -i memtotal|awk &#39;{print $2/1024/1024}&#39;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>register</span>: <span style=color:#ae81ff>memory</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>failed_when</span>: <span style=color:#e6db74>&#34;memory.stdout|float &lt; 2&#34;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ ansible-playbook -i inventory main.yml
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PLAY <span style=color:#f92672>[</span>Update web servers<span style=color:#f92672>]</span> ******************************************************************************************************
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TASK <span style=color:#f92672>[</span>Gathering Facts<span style=color:#f92672>]</span> *********************************************************************************************************
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ok: <span style=color:#f92672>[</span>3.92.61.18<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TASK <span style=color:#f92672>[</span>Making sure the Physical Memory more than 2gb<span style=color:#f92672>]</span> ***************************************************************************
</span></span><span style=display:flex><span>fatal: <span style=color:#f92672>[</span>3.92.61.18<span style=color:#f92672>]</span>: FAILED! <span style=color:#f92672>=</span>&gt; <span style=color:#f92672>{</span><span style=color:#e6db74>&#34;changed&#34;</span>: true, <span style=color:#e6db74>&#34;cmd&#34;</span>: <span style=color:#e6db74>&#34;cat /proc/meminfo|grep -i memtotal|awk &#39;{print </span>$2<span style=color:#e6db74>/1024/1024}&#39;&#34;</span>, <span style=color:#e6db74>&#34;delta&#34;</span>: <span style=color:#e6db74>&#34;0:00:00.006063&#34;</span>, <span style=color:#e6db74>&#34;end&#34;</span>: <span style=color:#e6db74>&#34;2022-10-07 14:46:37.761174&#34;</span>, <span style=color:#e6db74>&#34;failed_when_result&#34;</span>: true, <span style=color:#e6db74>&#34;msg&#34;</span>: <span style=color:#e6db74>&#34;&#34;</span>, <span style=color:#e6db74>&#34;rc&#34;</span>: 0, <span style=color:#e6db74>&#34;start&#34;</span>: <span style=color:#e6db74>&#34;2022-10-07 14:46:37.755111&#34;</span>, <span style=color:#e6db74>&#34;stderr&#34;</span>: <span style=color:#e6db74>&#34;&#34;</span>, <span style=color:#e6db74>&#34;stderr_lines&#34;</span>: <span style=color:#f92672>[]</span>, <span style=color:#e6db74>&#34;stdout&#34;</span>: <span style=color:#e6db74>&#34;0.943119&#34;</span>, <span style=color:#e6db74>&#34;stdout_lines&#34;</span>: <span style=color:#f92672>[</span><span style=color:#e6db74>&#34;0.943119&#34;</span><span style=color:#f92672>]}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PLAY RECAP *********************************************************************************************************************
</span></span><span style=display:flex><span>3.92.61.18                 : ok<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>    changed<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    unreachable<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    failed<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>    skipped<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    rescued<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    ignored<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span></code></pre></div><h2 id=ignore-errors>Ignore Errors<a href=#ignore-errors class=hanchor arialabel=Anchor>&#8983;</a></h2><p>If we have tasks in which we expect that there may be an error, but we still want to continue the execution, then we can add the parameter <code>ignore_errors: yes</code> and the execution of the playbook will continue.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>- <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Do not count this as a failure</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>ansible.builtin.command</span>: <span style=color:#ae81ff>/bin/false</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>ignore_errors</span>: <span style=color:#66d9ef>yes</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ ansible-playbook -i inventory main.yml
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PLAY <span style=color:#f92672>[</span>Update web servers<span style=color:#f92672>]</span> ******************************************************************************************************
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TASK <span style=color:#f92672>[</span>Gathering Facts<span style=color:#f92672>]</span> *********************************************************************************************************
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ok: <span style=color:#f92672>[</span>3.92.61.18<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>TASK <span style=color:#f92672>[</span>Do not count this as a failure<span style=color:#f92672>]</span> ******************************************************************************************
</span></span><span style=display:flex><span>fatal: <span style=color:#f92672>[</span>3.92.61.18<span style=color:#f92672>]</span>: FAILED! <span style=color:#f92672>=</span>&gt; <span style=color:#f92672>{</span><span style=color:#e6db74>&#34;changed&#34;</span>: true, <span style=color:#e6db74>&#34;cmd&#34;</span>: <span style=color:#f92672>[</span><span style=color:#e6db74>&#34;/bin/false&#34;</span><span style=color:#f92672>]</span>, <span style=color:#e6db74>&#34;delta&#34;</span>: <span style=color:#e6db74>&#34;0:00:00.002920&#34;</span>, <span style=color:#e6db74>&#34;end&#34;</span>: <span style=color:#e6db74>&#34;2022-10-07 14:43:48.380284&#34;</span>, <span style=color:#e6db74>&#34;msg&#34;</span>: <span style=color:#e6db74>&#34;non-zero return code&#34;</span>, <span style=color:#e6db74>&#34;rc&#34;</span>: 1, <span style=color:#e6db74>&#34;start&#34;</span>: <span style=color:#e6db74>&#34;2022-10-07 14:43:48.377364&#34;</span>, <span style=color:#e6db74>&#34;stderr&#34;</span>: <span style=color:#e6db74>&#34;&#34;</span>, <span style=color:#e6db74>&#34;stderr_lines&#34;</span>: <span style=color:#f92672>[]</span>, <span style=color:#e6db74>&#34;stdout&#34;</span>: <span style=color:#e6db74>&#34;&#34;</span>, <span style=color:#e6db74>&#34;stdout_lines&#34;</span>: <span style=color:#f92672>[]}</span>
</span></span><span style=display:flex><span>...ignoring
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PLAY RECAP *********************************************************************************************************************
</span></span><span style=display:flex><span>3.92.61.18                 : ok<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span>    changed<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>    unreachable<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    failed<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    skipped<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    rescued<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>    ignored<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>
</span></span></code></pre></div><h2 id=video>Video<a href=#video class=hanchor arialabel=Anchor>&#8983;</a></h2><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/k74GIVucO_Y style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div></div></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=https://mpostument.com/2022/10/15/ansible-role/><span class=button__icon>←</span>
<span class=button__text>Ansible Role</span></a></span>
<span class="button next"><a href=https://mpostument.com/2022/09/27/ansible-inventory/><span class=button__text>Ansible Inventory</span>
<span class=button__icon>→</span></a></span></div></div><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//mpostument-com.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></article></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2022 Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script type=text/javascript src=/bundle.min.js></script></div></body></html>